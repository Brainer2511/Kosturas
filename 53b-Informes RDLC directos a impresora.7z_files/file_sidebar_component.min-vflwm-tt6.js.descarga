define(["require","exports","tslib","react","modules/core/i18n","modules/clean/react/css","modules/clean/react/comments2/data/sidebar_watcher","modules/clean/react/file_sidebar/file_sidebar_base","modules/clean/react/file_sidebar/store/sidebar/helpers","modules/clean/react/file_sidebar/store/sidebar/actions","modules/clean/react/file_sidebar/store/sidebar/selectors","modules/clean/react/file_sidebar/store/file_activity/actions","modules/clean/react/file_sidebar/store/file_activity/selectors","modules/clean/react/file_sidebar/file_sidebar_connect","modules/clean/react/file_sidebar/comments_tab","modules/clean/react/file_activity_stream/file_activity_stream","modules/clean/react/file_metadata/metadata_tab","modules/clean/react/file_sidebar/file_sidebar_logger","modules/clean/sticker_util"],function(e,t,i,r,n,a,s,o,l,c,d,u,m,p,b,f,_,h,y){"use strict";function v(e){return{activityContext:e.activityContext,commentsDisabledOnFile:e.commentsDisabledOnFile,shouldInitiallyFocusInput:e.shouldInitiallyFocusInput,currentFile:e.currentFile,previewType:e.previewType,sharedLinkInfo:e.sharedLinkInfo,user:e.user}}function S(e){return i.__assign({},d.getSidebarState(e),{fileActivityCount:m.getVisibleActivityCount(e),tabs:d.getTabsState(e)})}Object.defineProperty(t,"__esModule",{value:!0}),r=i.__importDefault(r),l=i.__importStar(l),c=i.__importStar(c),d=i.__importStar(d),u=i.__importStar(u),m=i.__importStar(m);var C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.notifyStore=function(e){t.props.dispatch(c.openFile({file:e.currentFile,isVersionHistoryMode:e.isVersionHistoryMode,user:e.user})),e.user&&t.props.dispatch(u.getActivityStream(e.user.id,e.currentFile))},t.onSelectTab=function(e){var i=t.props,r=i.dispatch,n=i.fileActivityCount,a=i.tabs.comments,s=i.user;r(c.selectTab(e)),h.logSidebarTabSelected({selected_tab:e,num_comments:a.extra.commentCount,num_events:n,viewing_user_id:s?s.id:null})},t}return i.__extends(t,e),t.prototype.componentWillMount=function(){y.fetchStickersAndCreateStickerUtil()},t.prototype.componentDidMount=function(){this.notifyStore(this.props)},t.prototype.componentWillReceiveProps=function(e){var t={file:this.props.currentFile,isVersionHistoryMode:this.props.isVersionHistoryMode,user:this.props.user},i={file:e.currentFile,isVersionHistoryMode:e.isVersionHistoryMode,user:e.user};l.isContextChanged(t,i)&&this.notifyStore(e)},t.prototype.componentDidUpdate=function(e){var t=e.ready,i=e.activeTab,r=e.open,n=e.openReason,a=this.props,o=a.ready,l=a.activeTab,c=a.open,d=a.openReason;!t&&o&&s.sideChannelEventEmitter.emit("comments"===l?s.COMMENTS_VISIBLE_SIGNAL:s.COMMENTS_HIDDEN_SIGNAL),!c||"comments"!==l||"toggle_button"===d||r&&"toggle_button"!==n&&"comments"===i?!r||"comments"!==i||c&&"comments"===l||s.sideChannelEventEmitter.emit(s.COMMENTS_HIDDEN_SIGNAL):s.sideChannelEventEmitter.emit(s.COMMENTS_VISIBLE_SIGNAL)},t.prototype.componentWillUnmount=function(){this.props.dispatch(u.reset()),this.props.dispatch(c.reset())},t.prototype.renderCommentsTab=function(){var e=this.props.tabs.comments,t=e.extra&&2===e.extra.version?"comments2-sidebar-tab-content":void 0;return r.default.createElement(o.FileSidebarBase.Tab,{key:"comments",name:n._("Comments"),count:e.count,contentClassName:t},r.default.createElement(b.CommentsTab,i.__assign({},v(this.props))))},t.prototype.renderFileActivityTab=function(){var e=this.props,t=e.currentFile,i=e.user;return r.default.createElement(o.FileSidebarBase.Tab,{key:"activity",name:n._("Activity")},r.default.createElement(f.FileActivityStream,{file:t,user:i}))},t.prototype.renderFileMetadataTab=function(){var e=this.props,t=e.currentFile,i=e.user,a=e.sharedLinkInfo;return r.default.createElement(o.FileSidebarBase.Tab,{key:"metadata",name:n._("About",{comment:"Tab name on the sidebar"})},r.default.createElement(_.MetadataTab,{file:t,user:i,sharedLinkInfo:a}))},t.prototype.render=function(){var e=this.props,t=e.activeTab,i=e.open,n=e.ready,a=e.tabs,s=a.comments,l=a.activity,c=a.metadata,d=[s.show?this.renderCommentsTab():null,l.show?this.renderFileActivityTab():null,c.show?this.renderFileMetadataTab():null].filter(function(e){return e});return 0===d.length?r.default.createElement("div",{className:"file-sidebar"}):r.default.createElement(o.FileSidebarBase,{activeTabKey:t,isOpen:n&&i,onSelectTab:this.onSelectTab,headerComponent:this.props.headerComponent},d)},t})(r.default.Component);t.FileSidebarComponent=C;var T=p.fileSidebarConnect(S)(C);t.FileSidebar=a.requireCssWithComponent(T,["/static/css/file-sidebar-vflQ8l8iP.css"])});
//# sourceMappingURL=file_sidebar_component.min.js-vflbn_0Sf.map