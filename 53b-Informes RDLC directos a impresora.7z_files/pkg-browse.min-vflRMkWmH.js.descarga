define("modules/clean/browse/browse_bolt_client",["require","exports","tslib","modules/clean/ajax","modules/clean/bolt","modules/clean/react/browse/constants"],function(e,t,r,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var a=(function(){function e(e){var t=this;this.startLiveUpdate=function(e){void 0===e&&(e=null),e&&(t.handleUpdate=e),t.updateBoltClient(),t.status=n.BrowseBoltClientStatus.Live},this.onBoltRefresh=function(){t.updateBoltClient(),t.status=n.BrowseBoltClientStatus.Live},this.onBoltUpdate=function(){t.handleUpdate&&t.handleUpdate()},this.updateBoltClient=function(){var e=t.boltData.map(function(e){return new s.SignedChannelState("sfj",e.bolt_unique_id,e.latest_sjid.toString(),e.bolt_token)});t.boltClient?t.boltClient.update_states(e):(t.boltClient=new s.BoltClient(e,t.onBoltUpdate,t.onBoltRefresh),t.boltClient.start())},this.userId=e,this.status=n.BrowseBoltClientStatus.NotReady,this.boltData=[]}return e.prototype.isReady=function(){return this.status!==n.BrowseBoltClientStatus.NotReady},e.prototype.setInitialBoltData=function(e){this.boltData=e,this.status=n.BrowseBoltClientStatus.NotLive},e.prototype.fetchInitialBoltData=function(e){var t=this;this.initialBoltDataRequest&&this.initialBoltDataRequest.abort(),this.initialBoltDataRequest=o.WebRequest({url:"/get_browse_bolt_data",dataType:"json",subject_user:this.userId,success:function(r,o,s){t.setInitialBoltData(r),e()},error:function(e,r,o){t.status=n.BrowseBoltClientStatus.NotReady},complete:function(){delete t.initialBoltDataRequest}})},e.prototype.handleUpdateBoltClient=function(e){this.boltData=e,this.updateBoltClient()},e.prototype.getNsMap=function(){var e={};return this.boltData.forEach(function(t){e[t.bolt_unique_id]=parseInt(t.latest_sjid,10)}),e},e.prototype.stopLiveUpdate=function(){this.status=n.BrowseBoltClientStatus.NotLive,this.boltClient&&this.boltClient.unsubscribe()},e})();t.BrowseBoltClient=a}),define("modules/clean/cloud_docs/constants",["require","exports","tslib","external/lodash"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);(function(e){e.PAPER="paper"})(t.PaperFileTypes||(t.PaperFileTypes={}));(function(e){e.GOOGLE_DSS_DOC="gdoc",e.GOOGLE_DSS_SHEET="gsheet",e.GOOGLE_DSS_SLIDES="gslides"})(t.GoogleFileTypes||(t.GoogleFileTypes={}));var s;(function(e){e.WORD="docx",e.EXCEL="xlsx",e.POWERPOINT="pptx"})(s=t.MicrosoftFileTypes||(t.MicrosoftFileTypes={}));(function(e){e.HOME="new_file_menu_home",e.BROWSE="new_file_menu_browse"})(t.NewFileMenuFromType||(t.NewFileMenuFromType={})),t.isMicrosoftFileType=function(e){return o.values(s).includes(e)},t.LOADING_PAGE_URL="/cloud_docs/loading",t.QueryParamBlackList={platform:!0}}),define("modules/clean/cloud_docs/create_api",["require","exports","tslib","modules/clean/cloud_docs/constants","modules/clean/react/async_file_modal_controller","modules/clean/react/async_folder_selector_modal","modules/clean/react/snackbar","modules/clean/react/browse/api","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events","modules/core/browser","modules/core/cookies","modules/core/i18n"],function(e,t,r,o,s,n,a,i,l,c,d,u,p){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),n=r.__importStar(n),i=r.__importStar(i),d=r.__importStar(d),t.getDepthFromPath=function(e){return(e.replace(/\/$/,"").match(/\//g)||[]).length},t.showAsyncFolderSelectorModal=function(e){var r=e.user,o=e.source,s=e.documentType;n.show({primaryAction:p._("Create"),secondaryAction:p._("Cancel"),title:p._("Create file in..."),ariaLabel:p._("Create file in..."),user:r,forceRootSelectable:!1,onFolderSelected:function(e){l.logFileCreateClick({uid:r.id,source:o,action:c.WebUserActionLogEvent.FILE_CREATE_HOME_FOLDER_SELECTED,depth_folder_selected:t.getDepthFromPath(e)}),t.createNewFile({user:r,path:e,documentType:s})}})},t.createNewFile=function(s){var n=s.user,a=s.path,i=s.documentType;return r.__awaiter(h,void 0,void 0,function(){return r.__generator(this,function(s){return[2,Promise.all([new Promise(function(t,r){e(["modules/clean/account/email"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/account/email_verify_reasons"],t,r)}).then(r.__importStar)]).then(function(e){var r=e[0].EmailVerification,s=e[1].CLOUD_DOCS;r.get_for_user(n).verified_or_show(s)&&(o.isMicrosoftFileType(i)?f({userId:n.id,path:a,documentType:i}):t.createNewCloudOnlyDoc({userId:n.id,pathName:a,title:p._("Untitled",{comment:"The default name for a new Cloud Doc, e.g. Untitled.gdoc"}),documentType:i}))})]})})};var f=function(e){var r=e.userId,o=e.path,s=e.documentType,n={fq_path:o,extension:s,_subject_uid:String(r),t:u.Cookies.read("__Host-js_csrf")},a=t.constructFormForCreateNewMicrosoftFile(n);document.body.appendChild(a),a.submit()};t.constructFormForCreateNewMicrosoftFile=function(e){var t=document.createElement("form");t.action="/ow/msft/create_new_file",t.method="POST",t.target="_blank";for(var r=0,o=Object.keys(e);r<o.length;r++){var s=o[r],n=document.createElement("input");n.type="hidden",n.name=s,n.value=e[s],t.appendChild(n)}return t},t.createNewCloudOnlyDoc=function(e){var t=e.userId,r=e.pathName,n=e.title,l=e.documentType,c=p._("Creating new file…"),u=p._("File created!"),h=o.LOADING_PAGE_URL+r,f=d.unsafe_open_tab(h),m=function(e){a.Snackbar.sync(c,!0),i.createCloudDoc({pathName:r,title:n,documentType:l,userId:t,onSuccess:function(e){var t=(e.changesets,e.createdFile),r=e.failureDetails;if(r){var o=function(){f=d.unsafe_open_tab(h),m(!1)};f.close(),a.Snackbar.close(),s.showFileSystemWarningsModal({fsws:r,confirmText:p._("Create"),onFinalAccept:o})}else a.Snackbar.complete(u),null!==t&&d.redirect(t.preview_url,f)},onError:function(e){a.Snackbar.fail(e)},checkFSWs:e})};m(!0)}}),define("modules/clean/cloud_docs/new_file_menu",["require","exports","tslib","external/classnames","react","spectrum/icon_partners","spectrum/popover","spectrum/button","spectrum/tertiary_link","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_api","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events","modules/clean/react/css","modules/core/i18n"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),s=r.__importDefault(s),t.NewFileCreateLabel=f._("Create new file");var m=f._("Google Docs"),_=f._("Google Sheets"),S=f._("Google Slides"),g=f._("Excel workbook"),E=f._("PowerPoint presentation"),v=f._("Word document"),w=f._("Paper doc");t.handleNewFileSelection=function(e){e.handleClick()};var F=function(e){switch(e){case c.MicrosoftFileTypes.WORD:return p.WebUserActionLogEvent.FILE_CREATE_WORD;case c.MicrosoftFileTypes.EXCEL:return p.WebUserActionLogEvent.FILE_CREATE_EXCEL;case c.MicrosoftFileTypes.POWERPOINT:return p.WebUserActionLogEvent.FILE_CREATE_POWERPOINT;case c.GoogleFileTypes.GOOGLE_DSS_DOC:return p.WebUserActionLogEvent.FILE_CREATE_GOOGLE_DOC;case c.GoogleFileTypes.GOOGLE_DSS_SHEET:return p.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SHEET;case c.GoogleFileTypes.GOOGLE_DSS_SLIDES:return p.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SLIDES;case c.PaperFileTypes.PAPER:return p.WebUserActionLogEvent.FILE_CREATE_PAPER}},T=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.renderIcon=function(){return s.default.createElement(n.IconPartners,{name:this.props.item.iconName,width:"24px",height:"24px"})},t.prototype.render=function(){return s.default.createElement(a.PopoverContentItem,{key:this.props.item.displayName,value:this.props.item,className:this.props.item.className},s.default.createElement("div",{className:"newfile-popover--item"},this.renderIcon(),s.default.createElement("div",{className:"newfile-popover--item-text"},this.props.item.displayName)))},t})(s.default.Component);t.NewFileTypeRow=T;var b=(function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCreateNewFile=function(e){return function(){u.logFileCreateClick({uid:t.props.user.id,source:t.props.source,action:F(e),depth_folder_selected:t.props.path?d.getDepthFromPath(t.props.path):void 0}),t.props.path?d.createNewFile({user:t.props.user,path:t.props.path,documentType:e}):d.showAsyncFolderSelectorModal({user:t.props.user,source:t.props.source,documentType:e})}},t.logTriggerClick=function(){u.logFileCreateClick({uid:t.props.user.id,source:t.props.source,action:p.WebUserActionLogEvent.FILE_CREATE_OPEN_MENU,depth_folder_selected:t.props.path?d.getDepthFromPath(t.props.path):void 0})},t}return r.__extends(n,e),n.prototype.getNewFileTypeSections=function(){var e=[];this.props.showPaper&&e.push([{displayName:w,iconName:"dropbox_paper",className:"action-create-file-paper-doc",handleClick:this.handleCreateNewFile(c.PaperFileTypes.PAPER)}]);var t=[];if(t.push({displayName:v,iconName:"microsoft_docx",className:"action-create-file-word",handleClick:this.handleCreateNewFile(c.MicrosoftFileTypes.WORD)}),t.push({displayName:g,iconName:"microsoft_xlsx",className:"action-create-file-excel",handleClick:this.handleCreateNewFile(c.MicrosoftFileTypes.EXCEL)}),t.push({displayName:E,iconName:"microsoft_pptx",className:"action-create-file-powerpoint",handleClick:this.handleCreateNewFile(c.MicrosoftFileTypes.POWERPOINT)}),e.push(t),this.props.showGdd){var r=[];r.push({displayName:m,iconName:"google_gdoc",className:"action-create-file-google-doc",handleClick:this.handleCreateNewFile(c.GoogleFileTypes.GOOGLE_DSS_DOC)}),r.push({displayName:_,iconName:"google_gsheet",className:"action-create-file-google-sheet",handleClick:this.handleCreateNewFile(c.GoogleFileTypes.GOOGLE_DSS_SHEET)}),r.push({displayName:S,iconName:"google_gslides",className:"action-create-file-google-slides",handleClick:this.handleCreateNewFile(c.GoogleFileTypes.GOOGLE_DSS_SLIDES)}),e.push(r)}return e},n.prototype.renderTrigger=function(){return this.props.primaryButton?s.default.createElement(i.Button,{key:t.NewFileCreateLabel,onClick:this.logTriggerClick,disabled:this.props.disabled,className:o.default("primary-action-menu__button","action-create-file"),tagName:"span"},t.NewFileCreateLabel):s.default.createElement(l.TertiaryLink,{key:t.NewFileCreateLabel,icon:"create",onClick:this.logTriggerClick,disabled:this.props.disabled,className:o.default("secondary-action-menu__button","action-create-file")},t.NewFileCreateLabel)},n.prototype.renderSection=function(e,t){return s.default.createElement("div",{className:"newfile-popover--section",key:t},e.map(function(e){return s.default.createElement(T,{item:e,key:e.displayName})}))},n.prototype.render=function(){return s.default.createElement(a.Popover,{onSelection:t.handleNewFileSelection},s.default.createElement(a.PopoverTrigger,{disabled:this.props.disabled,className:"newfile-popover--trigger"},this.renderTrigger()),s.default.createElement(a.PopoverContent,{attachment:"right",isRevealed:!this.props.disabled&&void 0},s.default.createElement("div",{className:"newfile-popover"},this.getNewFileTypeSections().map(this.renderSection))))},n})(s.default.Component),y=h.requireCssWithComponent(b,["/static/css/spectrum/index.web-vfliiTfMy.css","/static/css/cloud_docs/new_file_menu-vflzcLNNt.css"]);t.NewFileMenu=y}),define("modules/clean/file_operations/notifications",["require","exports","tslib","external/lodash","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/undo","modules/core/html","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,n,a,i,l,c,d,u){"use strict";function p(e,t,r,o){var s=function(){return i.rollbackChangeSets({changesets:r,userId:t.id,progressText:d._("Undoing…"),onSuccess:function(){u.Notify.success(d._("Undo complete.")),o&&o()}})};l.notifyWithUndo(e,r,s)}function h(e,t){var r=s.browse_uri_for_fq_path(t,e),i=n.Emstring.em_snippet(a.filename(e),40);return{href:r,text:o.escape(i)}}function f(e,t,r,o,s){var n;if(o){var a=h(o,t);n=d.ungettext('Copied %(num_items)d item to <a href="%(dest_href)s">%(dest_name)s</a>.','Copied %(num_items)d items to <a href="%(dest_href)s">%(dest_name)s</a>.',e).format({num_items:e,dest_href:a.href,dest_name:a.text}),n=new c.HTML(n)}else n=d.ungettext("Copied %(num_items)d item.","Copied %(num_items)d items.",e).format({num_items:e});p(n,t,r,s)}function m(e,t,r,o,s){var n;if(o){var a=h(o,t);n=d.ungettext('Moved %(num_items)d item to <a href="%(dest_href)s">%(dest_name)s</a>.','Moved %(num_items)d items to <a href="%(dest_href)s">%(dest_name)s</a>.',e).format({num_items:e,dest_href:a.href,dest_name:a.text}),n=new c.HTML(n)}else n=d.ungettext("Moved %(num_items)d item.","Moved %(num_items)d items.",e).format({num_items:e});p(n,t,r,s)}function _(e,t,r,o){p(d.ungettext("Deleted %(num_items)d item.","Deleted %(num_items)d items.",e).format({num_items:e}),t,r,o)}function S(e,t,r){p(d._("Rename complete."),e,t,r)}function g(e,t,r){p(d._("Created folder %(folder_name)s.").format({folder_name:e}),t,r)}function E(e){var t=d.ungettext("Permanently deleted %(num)s item.","Permanently deleted %(num)s items.",e).format({num:e});u.Notify.success(t)}function v(e){var t,r=e.length;if(1===r){var s=o.escape(a.filename(e[0].fq_path));t=d._("Restored <strong>%(filename)s</strong>.").format({filename:s}),t=new c.HTML(t)}else t=d.ungettext("Restored %(num)s file.","Restored %(num)s files.",r).format({num:r});u.Notify.success(t)}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),a=r.__importStar(a),i=r.__importStar(i),l=r.__importStar(l),t.notifyCopySuccess=f,t.notifyMoveSuccess=m,t.notifyDeleteSuccess=_,t.notifyRenameSuccess=S,t.notifyFolderCreationSuccess=g,t.notifyPurgeSuccess=E,t.notifyRestoreSuccess=v}),define("modules/clean/logging/hive/schemas/web-modal-activity",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.MOVE="move",e.COPY="copy",e.NEW_FOLDER="new_folder",e.UPLOAD="upload",e.SEARCH_FILTER="search_filter"})(t.ModalName||(t.ModalName={}));(function(e){e.SHOW="show",e.ERROR="error",e.SUCCESS="success",e.DATA_LOADED="data-loaded",e.BREADCRUMB_CLICKED="breadcrumb-clicked",e.ROW_CLICKED="row-clicked",e.READY="ready",e.CLOSE="close",e.PRIMARY_CLICK="primary-click",e.SECONDARY_CLICK="secondary-click",e.CHANGE_FOLDER_AUDIENCE="change-folder-audience",e.FOLDER_SUGGESTION_API_RESPONSE="folder-suggestion-api-response",e.FOLDER_SUGGESTION_CLICKED="folder-suggestion-clicked",e.FOLDER_SUGGESTION_LOCATION_CLICKED="folder-suggestion-location-clicked"})(t.ModalEventName||(t.ModalEventName={}));(function(e){e.CONFIDENTIAL="confidential",e.NON_CONFIDENTIAL="non-confidential"})(t.FolderType||(t.FolderType={}));var r=(function(){function e(e){this.category="web-modal-activity",this.user_id=null,this.team_id=null,this.modal_name=e.modal_name,this.modal_session_id=e.modal_session_id,this.event_name=e.event_name.toString(),e.hasOwnProperty("timestamp")&&void 0!==e.timestamp?this.timestamp=e.timestamp:this.timestamp=Date.now(),e.hasOwnProperty("user_id")&&void 0!==e.user_id&&(this.user_id=e.user_id),e.hasOwnProperty("team_id")&&void 0!==e.team_id&&(this.team_id=e.team_id),e.hasOwnProperty("session_id")&&void 0!==e.session_id&&(this.session_id=e.session_id),e.hasOwnProperty("path")&&void 0!==e.path&&(this.path=e.path),e.hasOwnProperty("index")&&void 0!==e.index&&(this.index=e.index),e.hasOwnProperty("is_keyboard")&&void 0!==e.is_keyboard&&(this.is_keyboard=e.is_keyboard),e.hasOwnProperty("error")&&void 0!==e.error&&(this.error=e.error),e.hasOwnProperty("folder_type")&&void 0!==e.folder_type&&(this.folder_type=e.folder_type),e.hasOwnProperty("folder_suggestion_path")&&void 0!==e.folder_suggestion_path&&(this.folder_suggestion_path=e.folder_suggestion_path),Object.seal(this)}return e})();t.WebModalActivityRow=r}),define("modules/clean/pagination_manager",["require","exports","tslib","modules/clean/ajax","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var a=(function(){function e(e){this.hasMoreItems=e}return e.prototype.areAllItemsReady=function(){return!this.hasMoreItems},e.prototype.invalidateHasMore=function(){this.hasMoreItems=!0},e.prototype.addDataToAjax=function(e){},e})(),i=(function(){function e(e){this.ajaxURL=e.ajaxURL,this.newDataCallback=e.newDataAvailableCallback,this.autoFetching=!1,this.mode=e.mode,this.keyName=e.keyName,this.items={},this.pages=[],this.nextRequestVoucher=e.firstPage.next_request_voucher,this.userID=e.userID,this.fqPathPrefix=e.fqPathPrefix?"/"+e.fqPathPrefix:"",this.addPage(e.firstPage.items)}return e.prototype.areAllItemsReady=function(){return this.mode.areAllItemsReady()},e.prototype.addPage=function(e){for(var t=[],r=[],o=0,a=e;o<a.length;o++){var i=a[o],l=i[this.keyName];if(null==l)return void n.Notify.warning(s._("Invalid server response"));null==this.items[l]&&(this.items[l]=i,r.push(i),t.push(l))}this.pages.push(t),this.newDataCallback(this,r)},e.prototype.startAutoFetching=function(){this.autoFetching=!0,this.fetchNext()},e.prototype.stopAutoFetching=function(){this.autoFetching=!1},e.prototype.reSync=function(e){void 0===e&&(e=!1),e&&(this.nextRequestVoucher=null,this.items={},this.pages=[]);var t=this.autoFetching&&this.mode.areAllItemsReady();this.mode.invalidateHasMore(),t&&this.startAutoFetching()},e.prototype.fetchNext=function(){var e=this;if(!this.mode.areAllItemsReady()){var t={};this.nextRequestVoucher&&(t.voucher=this.nextRequestVoucher),this.mode.addDataToAjax(t),o.WebRequest({url:this.ajaxURL,data:t,subject_user:this.userID,success:function(t){var r=JSON.parse(t);e.nextRequestVoucher=r.next_request_voucher,e.mode.hasMoreItems=r.has_more_items,e.autoFetching&&e.fetchNext();for(var o=0,s=r.items;o<s.length;o++){var n=s[o];n.fq_path=e.fqPathPrefix+n.fq_path}e.addPage(r.items)},error:function(){n.Notify.error(s._("There was a problem completing this request."))}})}},e.prototype.loadedPageCount=function(){return this.pages.length},e.prototype.getLoadedPage=function(e){var t=this,r=this.pages[e];return null==r?null:r.map(function(e){return t.items[e]})},e.prototype.getLastLoadedPage=function(){return this.getLoadedPage(this.loadedPageCount()-1)},e})();t.BasePaginationManager=i;var l=(function(e){function t(t){return e.call(this,r.__assign({},t,{mode:new a(t.firstPage.has_more_items)}))||this}return r.__extends(t,e),t.create=function(e){return new t(e)},t})(i);t.PaginationManager=l});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/app_actions/app_actions_menu",["require","exports","modules/clean/react/async/loadable"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppActionsMenu=r.Loadable({loader:function(){return new Promise(function(t,r){e(["modules/clean/react/app_actions/app_actions_menu_component"],t,r)}).then(__importStar).then(function(e){return e.AppActionsMenu})}}),t.UnconnectedAppActionsMenu=r.Loadable({loader:function(){return new Promise(function(t,r){e(["modules/clean/react/app_actions/app_actions_menu_component"],t,r)}).then(__importStar).then(function(e){return e.UnconnectedAppActionsMenu})}})}),define("modules/clean/react/app_actions/education/async_extensions_edu_modal",["require","exports","tslib","react","modules/clean/react/modal"],function(e,t,r,o,s){"use strict";function n(){var t=this;return new Promise(function(n){return r.__awaiter(t,void 0,void 0,function(){var t;return r.__generator(this,function(a){switch(a.label){case 0:return[4,new Promise(function(t,r){e(["modules/clean/react/app_actions/education/edu_modal_component"],t,r)}).then(r.__importStar)];case 1:return t=a.sent().AppActionsEduModal,n(s.Modal.showInstance(o.default.createElement(t,null))),[2]}})})})}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.asyncShowExtensionsEduModal=n});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/async_fileops_modals",["require","exports"],function(e,t){"use strict";function r(t){new Promise(function(t,r){e(["modules/clean/react/fileops_modals"],t,r)}).then(__importStar).then(t)}function o(e){r(function(t){return(0,t.showCopy)(e)})}function s(e){r(function(t){return(0,t.showMove)(e)})}function n(e){r(function(t){return(0,t.showUpload)(e)})}function a(e){r(function(t){return(0,t.showAdminUpload)(e)})}function i(t){new Promise(function(t,r){e(["modules/clean/react/folder_dialog/move_dialog_modal"],t,r)}).then(__importStar).then(function(e){return e.MoveDialogModal.show(t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.showCopy=o,t.showMove=s,t.showUpload=n,t.showAdminUpload=a,t.showMoveDialog=i});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/async_folder_selector_modal",["require","exports"],function(e,t){"use strict";function r(t){new Promise(function(t,r){e(["modules/clean/react/folder_selector_modal"],t,r)}).then(__importStar).then(function(e){e.FolderSelectorModal.show(t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.show=r});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/async_onboarding_move_modal",["require","exports"],function(e,t){"use strict";function r(t){new Promise(function(t,r){e(["modules/clean/react/onboarding_folder_dialog/onboarding_move_dialog"],t,r)}).then(__importStar).then(t)}function o(e){r(function(t){return(0,t.showMove)(e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.showOnboardingMoveDialog=o}),define("modules/clean/react/browse/actions",["require","exports","tslib","external/immutable","modules/clean/downloads","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/history","modules/clean/react/fileops_actions","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/helpers","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/browse/models","modules/clean/react/browse/nav_actions","modules/constants/python","modules/core/browser","modules/core/i18n","modules/clean/search/constants","modules/clean/react/file_viewer/async_controller","modules/clean/search/search_results/dispatcher","modules/clean/react/files_view/types","modules/clean/user_education/user_education_client","modules/clean/sharing/browse_exports","modules/clean/cloud_docs/constants","modules/clean/flux/dispatcher","modules/clean/react/file_uploader/constants"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S,g,E,v,w,F,T,b,y,C,I,R,D,N){"use strict";function P(){return e("modules/clean/react/file_viewer/controller")}function A(){return e.defined("modules/clean/react/file_viewer/controller")}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),n=r.__importStar(n),a=r.__importStar(a),i=r.__importDefault(i),l=r.__importStar(l),c=r.__importStar(c),u=r.__importStar(u),h=r.__importStar(h),m=r.__importStar(m),v=r.__importStar(v),F=r.__importStar(F);var O=(function(){function e(e){var s=this;this.initializeEverything=function(e){var t=e.path,r=e.files,n=e.paginatedTotalNumFiles,a=e.context,i=e.mountPoints,l=e.fqPathsToSelect,c=e.loadingState,d=e.teamFolders;s.reduxStore.dispatch(h.setPath({path:t})),s.reduxStore.dispatch(h.appendFiles({path:t,files:r.concat(d).map(function(e){return e instanceof S.File?e:S.File.fromServerObject(e)})})),s.reduxStore.dispatch(h.setPaginatedTotalNumFiles({paginatedTotalNumFiles:n})),s.reduxStore.dispatch(h.setMountPoints({mountPoints:i})),s.reduxStore.dispatch(h.setLoadingState({loadingState:c,path:t})),c===y.LoadingState.LOADED?s.reduxStore.dispatch(h.selectFilesByFqPath({fqPathsToSelect:l})):s.reduxStore.dispatch(h.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(l)})),s.reduxStore.dispatch(h.setContext({context:a})),D.Dispatcher.dispatch({type:N.UploaderActionType.SET_PATH,data:{path:t,hasPermissionToUploadToFolder:a.isCurrentPathWriteable()}}),D.Dispatcher.dispatch({type:p.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:r}})},this.addFilesAndSetLoadingState=function(e){var t=e.path,r=e.loadingState,o=e.files,n=e.paginatedTotalNumFiles;s.reduxStore.dispatch(h.appendFiles({path:t,files:o})),s.reduxStore.dispatch(h.setPaginatedTotalNumFiles({paginatedTotalNumFiles:n})),s.reduxStore.dispatch(h.setLoadingState({loadingState:r,path:t})),D.Dispatcher.dispatch({type:p.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:o}})},this.nameNewFolder=function(){s.reduxStore.dispatch(h.setNewFolderCreationState({newFolderCreationState:y.NewFolderCreationState.PENDING_INPUT}))},this.createFolderPending=function(){d.logCreateFolderPending(),s.reduxStore.dispatch(h.setNewFolderCreationState({newFolderCreationState:y.NewFolderCreationState.SAVING_INPUT}))},this.cancelCreateFolder=function(){d.logCreateFolderCancel(),s.reduxStore.dispatch(h.setNewFolderCreationState({newFolderCreationState:y.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),window.setTimeout(function(){C.UEClient.sendEvent("CdmNewFolderModal","maybeFinished")},2500)},this.createFolderComplete=function(e){var t=e.folderName,r=e.user,o=e.changesets;d.logCreateFolderSuccess(),s.reduxStore.dispatch(h.setNewFolderCreationState({newFolderCreationState:y.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),n.notifyFolderCreationSuccess(t,r,o),window.setTimeout(function(){C.UEClient.sendEvent("CdmNewFolderModal","maybeFinished")},2500)},this.createFolder=function(e){var t=e.folderName,o=e.pathName,n=e.nsId,i=void 0===n?null:n,l=e.checkFSWs,u=e.showShareModalOnSuccess,p=e.redirectOnSuccess,h=e.redirectOnCancel,f=e.selectCreatedFolder,_=void 0===f||f,S=m.user(s.reduxStore.getState());s.createFolderPending(),s.dataApi.createNewFolder({pathName:o,folderName:t,nsId:i,checkFSWs:l,userId:S.id,onSuccess:function(o){var n=o.changesets,i=o.createdFolder,l=o.failureDetails;if(l){var d=function(){s.createFolder(r.__assign({},e,{checkFSWs:!1}))};c.showFileSystemWarningsModal({fsws:l,onFinalAccept:d,confirmText:w._("Create folder"),onAbortAction:s.cancelCreateFolder})}else{var h=i?a.filename(i.fq_path):t;s.createFolderComplete({user:S,folderName:h,changesets:n}),i&&(_&&s.selectRowsFromBoltClient([i]),p&&p(i.fq_path),u&&s.handleShowShareModal(i,"browse_new_folder_modal"))}},onError:function(){d.logCreateFolderError(),s.cancelCreateFolder(),h&&h()}})},this.createFolderInNewFolderModal=function(e){var r=e.folderName,o=e.isConfidential,s=e.user,n=e.context,a=e.redirectOnSuccess,i=e.redirectOnCancel,l=e.fqPath,c=e.selectCreatedFolder,d=n?n.currentFQPath:l,u=n?n.rootNSID:s.root_ns_id;o&&n&&!n.isInsideTeamFolderTree?I.asyncShowNewFolderShareModal(s,null,d,r,!1,!1,null,g.browseNavActions.setPath,g.browseNavActions.setUrl):t.browseActions.createFolder({pathName:d,folderName:r,nsId:u,checkFSWs:!1,showShareModalOnSuccess:(s.is_cdm_member||o)&&!!n&&n.isInsideTeamFolderTree,redirectOnSuccess:a,redirectOnCancel:i,selectCreatedFolder:c})},this.handleNewFolderRedirectOnSuccess=function(e){g.browseNavActions.setUrl({path:e})},this.doDeleteFilesWithModal=function(e){var t=e.files,r=m.user(s.reduxStore.getState()),o=m.context(s.reduxStore.getState());c.showDelete(r,t,o,a.filename(o.currentFQPath),function(){s.dataApi.deleteFiles({files:t,userId:r.id,onSuccess:function(e){var o=e.changesets,a=e.fileDeltas;b.SearchResultsDispatcher.dispatch({type:F.CHANGE_FILES_ACTION,data:{fileDeltas:a.filter(function(e){return!!e.before}).map(function(e){return{before:e.before.fq_path,after:null}})}}),n.notifyDeleteSuccess(t.length,r,o,function(){s.selectRowsFromBoltClient(t),b.SearchResultsDispatcher.dispatch({type:F.CHANGE_FILES_ACTION,data:{fileDeltas:a.filter(function(e){return!!e.before}).map(function(e){return{before:null,after:e.before}})}})})}})})},this.onPurgeSuccessCallback=function(e){n.notifyPurgeSuccess(e.length),t.browseActions.reloadCurrentPath(),b.SearchResultsDispatcher.dispatch({type:F.CHANGE_FILES_ACTION,data:{fileDeltas:e.map(function(e){return{before:e.fq_path,after:null}})}})},this.onPurge=function(e,t){s.dataApi.purgeFiles({files:t,userId:e,onSuccess:s.onPurgeSuccessCallback})},this.doPermanentDeleteWithModal=function(e){var t=e.files,r=m.user(s.reduxStore.getState()),o=m.context(s.reduxStore.getState());c.showPurgeModal({userId:r.id,context:o,files:t,onPurge:s.onPurge})},this.onRestore=function(e,t,r){s.dataApi.restoreFiles({files:t,userId:e,onSuccess:function(){n.notifyRestoreSuccess(t)},isSearchMode:r})},this.doRestoreFilesWithUnifiedTrashModal=function(e){var t=e.files,r=m.user(s.reduxStore.getState()),o=m.context(s.reduxStore.getState());c.showUnifiedTrashModal({userId:r.id,context:o,files:t,onRestore:function(e,t){s.onRestore(e,t,!1)}})},this.fetchFolderSizes=function(e){var t=e.file;return r.__awaiter(s,void 0,void 0,function(){var e,o,s,n,a,i,l,c,d;return r.__generator(this,function(r){switch(r.label){case 0:e=m.user(this.reduxStore.getState()),o=p.MAX_FOLDER_SIZE_ITERATIONS,r.label=1;case 1:return r.trys.push([1,7,,8]),this.reduxStore.dispatch(h.requestFolderSizes({fqPath:t.fq_path})),[4,this.dataApi.fetchSharedFolderSizes(e.id,{fq_path:t.fq_path})];case 2:return s=r.sent(),this.reduxStore.dispatch(h.setFolderSizesPending({fetchFolderSizesResp:s})),n=[],[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:p.MAX_FOLDERS_PER_CALL})];case 3:a=r.sent(),a.queue&&(n=n.concat(a.queue)),r.label=4;case 4:return n.length>0&&o>0?(o--,i=Math.min(p.MAX_FOLDER_SIZE_QUEUE_SIZE,n.length),l=n.splice(0,i),[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:p.MAX_FOLDERS_PER_CALL,queue:l})]):[3,6];case 5:return a=r.sent(),a.queue&&n&&(n=n.concat(a.queue)),[3,4];case 6:return c=0!==o&&a.queue&&0===a.queue.length?y.FetchFolderSizeState.COMPLETE:y.FetchFolderSizeState.ERROR,this.reduxStore.dispatch(h.completeFolderSizes({fetchFolderSizeState:c})),[3,8];case 7:return d=r.sent(),this.reduxStore.dispatch(h.setFolderSizesPending({fetchFolderSizesResp:{sizes_dict:[{fq_path:t.fq_path,size:0}],queue:[]}})),this.reduxStore.dispatch(h.completeFolderSizes({fetchFolderSizeState:y.FetchFolderSizeState.ERROR})),[3,8];case 8:return[2]}})})},this.fetchMultipleFolderSizes=function(e){var t=e.files;return r.__awaiter(s,void 0,void 0,function(){var e,o,s;return r.__generator(this,function(r){switch(r.label){case 0:e=0,o=t.toArray(),r.label=1;case 1:return e<o.length?(s=o[e],[4,this.fetchFolderSizes({file:s})]):[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},this.dataApi=e,this.reduxStore=_.getStoreForBrowse()}return e.prototype.reloadCurrentPath=function(){m.isSearchMode(this.reduxStore.getState())||this.setUrl({path:m.path(this.reduxStore.getState()),qargs:{reload:"1"}})},e.prototype.updatePreview=function(e){var t=e.files;A()&&P().updateFiles(t)},e.prototype.closeFileViewer=function(){A()&&P().close()},e.prototype.setUrl=function(e){var t=e.path,r=e.qargs;g.browseNavActions.setUrl({path:t,qargs:r})},e.prototype.selectRowsFromBoltClient=function(e){void 0===e&&(e=[]),this.reduxStore.dispatch(h.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(e.map(function(e){return e.fq_path}))}))},e.prototype.copyFiles=function(e){l.copyFiles(e)},e.prototype.moveFiles=function(e){l.moveFiles(e)},
e.prototype.selectFilesAfterUpload=function(e){var t=e.fqPathsToSelect,r=m.unsortedFilesWithFolderSizes(this.reduxStore.getState());t.every(function(e){return r.has(e)})?this.reduxStore.dispatch(h.selectFilesByFqPath({fqPathsToSelect:t})):this.reduxStore.dispatch(h.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(t)}))},e.prototype.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;this.reduxStore.dispatch(h.selectFilesByFqPath({fqPathsToSelect:t}))},e.prototype.navigateToFileOrFolder=function(e){var t=e.file,r=e.shouldFocusComment,o=void 0!==r&&r,s=e.shouldPrepareForSignature,n=void 0!==s&&s,a=e.onFileViewerUnmount,i=e.fileViewAction,l=void 0===i?E.FileViewActionType.CLICK:i,d=e.fileViewOrigin,p=void 0===d?E.FileViewOriginType.BROWSE:d,h=m.user(this.reduxStore.getState()),f=m.context(this.reduxStore.getState());t.isDeleted?this.doRestoreFilesWithUnifiedTrashModal({files:[t]}):t.is_dir?S.File.isNoAccessSharedFolder(t)?c.showNoAccess(h,t,f):this.setUrl({path:t.fq_path}):this.openPreviewForBrowseFile(t,o,n,h,l,p,function(e){return u.fetchPreviewData(e,h)},a)},e.prototype.openPreviewForBrowseFile=function(e,t,r,o,s,n,i,l){var c=f.getIndexOfFile(e,this.reduxStore.getState()),d=c<0?[e]:m.sortedFilesWithFolderSizes(this.reduxStore.getState()).toArray();if(c<0?c=0:d[c]=e,e.is_cloud_doc&&i){var u=R.LOADING_PAGE_URL+a.parent_dir(e.fq_path),h=v.unsafe_open_tab(u);i(e).then(function(e){e.preview_url&&null!==h&&v.redirect(e.preview_url,h)})}else{var _=function(){T.showElementsBehindFileViewer(),l&&l()};T.asyncOpenPreview({containerId:p.BROWSE_FILE_VIEWER_ELEMENT_ID,files:d,indexOfPreviewFile:c,shouldFocusComment:t,user:o,onFileViewerDidMount:T.hideElementsBehindFileViewer,onFileViewerUnmount:_,fileViewAction:s,fileViewOrigin:n,fileViewTarget:E.FileViewTargetType.PRIVATE,shouldPrepareForSignature:r})}},e.prototype.navigateToResultObjectParentFolder=function(e){var t=e.file,r=e.fileViewAction;void 0===r&&E.FileViewActionType.CLICK;if(S.File.isNoAccessSharedFolder(t))c.showNoAccess(m.user(this.reduxStore.getState()),t,m.context(this.reduxStore.getState()));else{var o=a.parent_dir(t.fq_path);this.setUrl({path:o})}},e.prototype.navigateToParentFolder=function(){var e=a.parent_dir(m.path(this.reduxStore.getState()));this.setUrl({path:e})},e.prototype.setShouldShowDeletedFiles=function(e){e.shouldShowDeletedFiles?i.default.update_query_param(p.BrowseQueryArg.d,"1"):i.default.remove_query_param(p.BrowseQueryArg.d)},e.prototype.downloadFiles=function(e){var t=e.files,r=e.context,o=e.user,n=e.useMetaserverDownloads;if(1===t.count()&&!t.first().is_dir)return void(n?s.get({url:t.first().href}):s.get_blockserver_link({url:t.first().direct_blockserver_link}));if(r.blockHash){var a=r.currentFQPath,i=t.toArray().map(function(e){return e.fq_path});s.get_zip({fq_paths:i,subject_uid:o.id,block_hash:r.blockHash,parent_path:a})}},e.prototype.fetchAndSetSameNamespaceFolderSize=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this.dataApi.fetchSameNamespaceFolderSizes(e,t)];case 1:return o=r.sent(),this.reduxStore.dispatch(h.setFolderSizesPending({fetchFolderSizesResp:o})),[2,o]}})})},e.prototype.handleShowShareModal=function(e,t){var r=m.user(this.reduxStore.getState()),o=m.context(this.reduxStore.getState());I.asyncShowShareModal(r,e,{browseContext:o,origin:t},g.browseNavActions.setPath,g.browseNavActions.setUrl)},e.prototype.handleShowShareInterstitialModal=function(e,t,r,o,s){var n=m.user(this.reduxStore.getState()),a=m.context(this.reduxStore.getState());I.expAsyncShowShareInterstitialModal(n,e,r,o,s,{browseContext:a,origin:t},g.browseNavActions.setPath,g.browseNavActions.setUrl)},e})();t.browseActions=new O(u)}),define("modules/clean/react/browse/api",["require","exports","tslib","external/lodash","modules/clean/ajax","modules/clean/api_v2/user_client","modules/clean/react/browse/models","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,r,o,s,n,a,i,l,c){"use strict";function d(e){try{return JSON.parse(e)}catch(e){if(!(e instanceof SyntaxError))throw e}return null}function u(e){var t=e.sortLabel,r=e.sortIsAscending,o=e.path,n=e.userId,a=e.onSuccess,i=e.includeDeletedFiles,l=void 0!==i&&i,c=e.sortFoldersFirst,u=void 0===c||c,p=e.onError;return s.WebRequest({data:{sort_label:t,sort_is_ascending:r.toString(),show_deleted:l||"",sort_folders_first:u,include_file_info:"True",path2:o},url:"/browse",subject_user:n,success:function(e,t,r){var s=d(e);s&&a({path:o,data:s,xhr:r})},error:function(e,t,r){p&&p(e,t,r)}})}function p(e){var t=e.files,r=e.newPath,n=e.userId,c=e.onSuccess,d=e.checkFSWs,u=t.map(function(e){return e.fq_path});return u.includes(r)?(l.Notify.error(i._("You can’t copy a folder into itself.")),null):s.WebProgressRequest({url:"/cmd/copy",data:{files:u,to_path:r,fsw_request:d?"check":void 0},subject_user:n,progress_text:i._("Copying files..."),success:function(e){try{var t=o.isString(e)?JSON.parse(e):e;c({newFiles:t.new_browse_files?t.new_browse_files.map(a.File.fromServerObject):[],destinationPath:r,changesets:t.changesets,failureDetails:t.failure_details})}catch(e){}}})}function h(e){var t=e.files,r=e.userId,n=e.onSuccess,a=t.map(function(e){return e.fq_path});return s.WebProgressRequest({url:"/cmd/delete",data:{files:a},subject_user:r,progress_text:i._("Deleting files..."),success:function(e){try{var r=o.isString(e)?JSON.parse(e):e;n({fileDeltas:t.map(function(e){return{before:e,after:null}}),changesets:r.changesets})}catch(e){}}})}function f(e){var t=e.path,r=e.files,n=e.newPath,c=e.userId,d=e.onSuccess,u=e.allowOwnershipTransfer,p=e.checkFSWs;if(t===n)return l.Notify.error(i._("Those files already exist in that folder.")),null;var h=r.map(function(e){return e.fq_path});return h.includes(n)?(l.Notify.error(i._("You can’t move a folder into itself.")),null):s.WebProgressRequest({url:"/cmd/move",data:{files:h,to_path:n,allow_ownership_transfer:u,fsw_request:p?"check":void 0},subject_user:c,progress_text:i._("Moving files..."),skipNotifyError:!u,success:function(e){try{var r=o.isString(e)?JSON.parse(e):e;d({path:t,destinationPath:n,newFiles:r.new_browse_files?r.new_browse_files.map(a.File.fromServerObject):[],changesets:r.changesets,failureDetails:r.failure_details})}catch(e){}},error:function(t,r,o){l.Notify.error(o),e.onError&&e.onError(o)}})}function m(e){var t=e.files,r=e.userId,o=e.onSuccess,n=e.isSearchMode;return s.WebProgressRequest({url:"/cmd/restore",data:{files:t.map(function(e){return e.fq_path}),source:n?"search":"browse"},subject_user:r,dataType:"json",progress_text:i._("Restoring…"),success:function(){o()}})}function _(e){var t=e.files,r=e.userId,o=e.onSuccess,n=e.progressText,a=void 0===n?i._("Deleting…"):n;return s.WebProgressRequest({url:"/cmd/purge",data:{files:t.map(function(e){return e.fq_path})},subject_user:r,dataType:"text",progress_text:a,success:function(e){var r=d(e);r&&"success"===r.status&&o(t)}})}function S(e){var t=e.userId,r=e.changesets,o=void 0===r?null:r,n=e.progressText,a=e.onSuccess;return s.WebProgressRequest({url:"/cmd/rollback",data:{ns_to_cs:JSON.stringify(o)},subject_user:t,progress_text:n,success:function(){a()}})}function g(e){var t=e.pathName,r=e.folderName,o=e.userId,n=e.onSuccess,i=e.onError,l=e.checkFSWs;return s.WebProgressRequest({url:new c.URI({path:"/cmd/new"+t}).toString(),data:{to_path:r,folder:"yes",fsw_request:l?"check":void 0},subject_user:o,success:function(e){var t=d(e);if(t){var r=t.new_browse_files?a.File.fromServerObject(t.new_browse_files[0]):null;n({changesets:t.changesets,createdFolder:r,failureDetails:t.failure_details})}},error:function(){i()}})}function E(e){var t=e.pathName,r=e.title,o=e.documentType,n=e.userId,i=e.onSuccess,l=e.onError,u=e.checkFSWs,p=(t+"/"+r+"."+o).replace("//","/");return s.WebRequest({url:new c.URI({path:"/cmd/create_cloud_doc"}).toString(),subject_user:n,data:{to_path:p,title:r,fsw_request:u?"check":void 0},success:function(e){var t=d(e);if(t){i({changesets:null,createdFile:t.new_browse_files?a.File.fromServerObject(t.new_browse_files[0]):null,failureDetails:t.failure_details})}},error:function(e,t,r){l(r)},skipNotifyError:!0})}function v(e){var t=e.path,r=e.userId,n=e.namespaceToJournalIdMap,a=e.onSuccess,i=e.includeDeletedFiles,l="/"===t?"":t,c={fq_dir:l,ns_map:o.map(n,function(e,t){return t+"_"+e}).join(","),show_deleted:!!i};return s.WebRequest({url:"/update/list_dir",subject_user:r,data:c,dataType:"text",success:function(e){var t=d(e);t&&a(t)}})}function w(e,t){if(!b(e))return Promise.resolve(e);var o=[[e.ns_id,e.sjid,e.fq_path.substr(0,e.fq_path.length-e.ns_path.length)]];return new Promise(function(n,a){s.WebRequest({data:{nsid_sjid_fq_mount_point_tuples:JSON.stringify(o)},url:"/browse_file_info",dataType:"json",subject_user:t,success:function(t,o,s){var a=t.file_results[0];n(r.__assign({},e,a))},error:function(e,t,r){a(r)}})})}function F(e,t){return(new n.UserApiV2Client).ns("folders").rpc("get_shared_subfolder_sizes",t,{subjectUserId:e})}function T(e,t){return(new n.UserApiV2Client).ns("folders").rpc("get_subfolder_sizes_in_same_namespace",t,{subjectUserId:e})}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),t.loadPath=u,t.copyFiles=p,t.deleteFiles=h,t.moveFiles=f,t.renameFile=function(e){var t=e.file,r=e.name,o=e.user;return new Promise(function(e,n){s.WebRequest({url:new c.URI({path:"/cmd/rename"+t.fq_path}).toString(),subject_user:o.id,data:{to_path:r},success:function(r){var o=d(r);if(o){var s=t.merge(o.new_browse_files[0]);e({changesets:o.changesets,renamedFile:s})}else n(r)},error:n})})},t.restoreFiles=m,t.purgeFiles=_,t.rollbackChangeSets=S,t.createNewFolder=g,t.createCloudDoc=E,t.getChangesForDirectory=v;var b=function(e){return e.is_cloud_doc||!(e.event_type||e.preview_url||e.preview_thumbnail_url||e.preview_type||e.linkfile_data||e.htmlified_link||e.preview_ssr_image_url_tmpl||e.preview_ssr_refresh_url||e.preview_ssr_text_url_tmpl)};t.fetchPreviewData=w,t.fetchSharedFolderSizes=F,t.fetchSameNamespaceFolderSizes=T}),define("modules/clean/react/browse/browse",["require","exports","tslib","react","external/react-redux","modules/clean/react/browse/controller","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors","modules/clean/react/app_actions/data/selectors","modules/clean/react/files_view/data/store","modules/clean/react/folder_overview/data/selectors","modules/clean/search/search_bar/data/action_creators","modules/clean/search/search_bar/data/selectors","modules/clean/viewer","modules/clean/web_timing_logger"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),a=r.__importStar(a),i=r.__importStar(i),c=r.__importStar(c),d=r.__importStar(d),u=r.__importStar(u),h=r.__importStar(h),f=r.__importStar(f),m=r.__importStar(m),S=r.__importStar(S);var g=function(e){var t=i.context,r=i.sortedFilesWithFoldersSizesWithoutTeamFolders,o=i.sortedFilesWithFolderSizes,s=i.teamFolders,n=i.paginatedTotalNumFiles,a=i.loadingState,l=i.path,c=i.selection,p=i.selectedFiles,f=i.fileRename,_=i.shouldShowDeletedFiles,S=i.shouldShowPinnedTeamFolders,g=i.shouldShowSharedFolderInvites,E=i.newFolderCreationState,v=i.isTimelineVisible,w=i.sortOrder,F=i.urlPrefix,T=i.canDisplayFolderSizes,b=i.isQueryingFolderSizes,y=i.user,C=i.viewer,I=i.browsePostTTIExperiments,R=i.mountPoints,D=i.isFileJumping,N=i.isSearchMode,P=i.shouldShowFolderOverview,A=d.viewType,O=d.viewTypeColumns,L=u.fileExtensionsConfigs,x=m.searchSessionId,M=m.isSearchBarFocused,U=h.pinnedItems;return{files:o(e),filesWithoutTeamFolders:r(e),teamFolders:s(e),paginatedTotalNumFiles:n(e),loadingState:a(e),path:l(e),fileRename:f(e),shouldShowDeletedFiles:_(e),shouldShowPinnedTeamFolders:S(e),shouldShowSharedFolderInvites:g(e),isTextSelectable:!!f(e),createNewFolderState:E(e),isTimelineVisible:v(e),currentSort:w(e),urlPrefix:F(e),canDisplayFolderSizes:T(e),viewTypeColumns:O(e),isQueryingFolderSizes:b(e),user:y(e),viewer:C(e),browsePostTTIExperiments:I(e),brsContext:t(e),brsSelection:c(e),brsSelectedFiles:p(e),mountPoints:R(e),isFileJumping:D(e),searchSessionId:x(e),isSearchBarFocused:M(e),isSearchMode:N(e),viewType:A(e),fileExtensionsConfigs:L(e),pinnedItems:U(e),shouldShowFolderOverview:P(e)}},E={addFileJumpKeyCode:a.addFileJumpKeyCode,appendFiles:a.appendFiles,applyBoltUpdates:a.applyBoltUpdates,blurSearchBar:f.blurSearchBar,clearFiles:a.clearFiles,clearSearchBar:f.clearSearchBar,copyFilesToClipboard:a.copyFilesToClipboard,hideTimeline:a.hideTimeline,pasteFilesFromClipboard:a.pasteFilesFromClipboard,renameFile:a.renameFile,resetFileJumpFilter:a.resetFileJumpFilter,setAndStoreSortOrder:a.setAndStoreSortOrder,setBrowsePostTTIExperiments:a.setBrowsePostTTIExperiments,setBrowseScope:f.setBrowseScope,setCanDisplayFolderSizes:a.setCanDisplayFolderSizes,setFileCategories:f.setFileCategories,setFileRename:a.setFileRename,setIsSearchMode:a.setIsSearchMode,setLoadingState:a.setLoadingState,setMountPoints:a.setMountPoints,setPath:a.setPath,setPathData:a.setPathData,setSearchBarExperiments:f.setExperiments,setSearchQuery:f.setSearchQuery,setSelection:a.setSelection,setShouldShowDeletedFiles:a.setShouldShowDeletedFiles,setUrl:a.setUrl,setViewType:c.setViewType,setViewTypeColumns:c.setViewTypeColumns,showTimeline:a.showTimeline},v=s.connect(g,E)(n.BrowseController),w=(function(e){function t(t){var r=e.call(this,t)||this;S.log_js_modules_application_code_start(),p.getStoreForFilesView(),r.reduxStore=l.getStoreForBrowse();var o=_.Viewer.get_viewer(),s=o.get_user_by_id(t["user-id"]);return r.reduxStore.dispatch(c.loadViewType()),r.reduxStore.dispatch(c.loadViewTypeColumns({user:s})),r.reduxStore.dispatch(a.setPath({path:t["init-fq-path"]||"/"})),r.reduxStore.dispatch(a.appInit({experiments:t["exp-browse-experiments"]||{},shouldShowDeletedFiles:!!t["should-show-deleted-files"],user:s,viewer:o})),r}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(s.Provider,{store:this.reduxStore},o.default.createElement(v,r.__assign({},this.props)))},t})(o.default.PureComponent);t.BrowseApp=w}),define("modules/clean/react/browse/browse_prefetch_loader",["require","exports","tslib","modules/core/exception","modules/clean/react/files_view/types","modules/clean/react/browse/models","modules/clean/pagination_manager","modules/core/notify","modules/clean/web_timing_logger"],function(e,t,r,o,s,n,a,i,l){"use strict";function c(e){if(0===e.indexOf("err:")){var t=e.substr("err:".length);i.Notify.error(t)}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),l=r.__importStar(l);var d=(function(){function e(e,t,r,i){var d=e.user,u=e.path,p=e.fqPathsToSelect,h=t.onPrefetchComplete,f=t.onPrefetchError,m=t.onLoadComplete,_=t.onPostTTIPrefetchComplete,S=t.onPostTTIPrefetchError,g=r.onInitializeEverything,E=r.onLoad,v=r.onAddFilesAndSetLoadingState;void 0===i&&(i=window);var w=this;this.isPrefetching=function(){return!!w.browsePreloadHandler&&!!w.firstPagePreloadHandler},this.handlePrefetch=function(){o.assert(w.isPrefetching(),"trying to handle prefetching and think we aren't prefetching at the same time.  something is wrong"),w.browsePreloadHandler(w.handlePrefetchDataSuccess,w.onPrefetchError),l.waitForTTI().then(function(){w.postTTIPreloadHandler(w.handlePostTTIDataSuccess,w.onPostTTIPrefetchError)})},this.handlePostTTIDataSuccess=function(e){var t=void 0;try{t=JSON.parse(e)}catch(e){return void w.onPostTTIPrefetchError(e)}if(!t)return void w.onPostTTIPrefetchError();w.onPostTTIPrefetchComplete(t)},this.handlePrefetchDataSuccess=function(e){var t=w.extractAjaxInitData(e);if(!t)return void w.onPrefetchError();var r,o,a=[],i=0,l=s.LoadingState.LOADING_FIRST_PAGE,c=w.firstPagePreloadHandler.getDataIfAvailable();if(c){if(!c.payload||c.error)return void w.onPrefetchError();var d=w.extractAjaxFileInfo(c.payload);if(!d)return void w.onPrefetchError();r=d.file_info,o=d.first_page,o?(a=[],i=o.total_num_items,l=s.LoadingState.LOADING_REMAINING_PAGES):r&&(a=r,i=a.length,l=s.LoadingState.LOADED)}var u=n.BrowseContext.fromServerObject(t);w.onInitializeEverything({path:w.path,files:a.map(n.File.fromServerObject),paginatedTotalNumFiles:i,context:u,mountPoints:t.ns_id_to_mount_point,fqPathsToSelect:w.fqPathsToSelect,loadingState:l,teamFolders:t.team_folders_js_info&&t.team_folders_js_info.map(n.File.fromServerObject)}),r||o?(o?w.initializePaginationManager(o):w.onLoadComplete(),w.onPrefetchComplete(t)):w.firstPagePreloadHandler(function(e){w.handleFirstPagePrefetchDataSuccess(e,t,u)},w.onPrefetchError)},this.handleFirstPagePrefetchDataSuccess=function(e,t,r){var o=w.extractAjaxFileInfo(e);if(!o)return void w.onPrefetchError();o.paginated?w.initializePaginationManager(o.first_page):(w.onLoad({path:w.path,files:o.file_info.map(n.File.fromServerObject),paginatedTotalNumFiles:o.file_info.length,context:r}),w.onLoadComplete()),w.onPrefetchComplete(t)},this.extractAjaxInitData=function(e){var t=void 0;try{t=JSON.parse(e)}catch(t){c(e)}return t},this.extractAjaxFileInfo=function(e){var t=void 0;try{t=JSON.parse(e)}catch(t){c(e)}return t},this.initializePaginationManager=function(e){var t=e.total_num_items,r=a.PaginationManager.create({firstPage:e,keyName:"sjid",ajaxURL:"/browse_get_next",userID:w.user.id,newDataAvailableCallback:function(e,r){var o=e.areAllItemsReady(),a=o?s.LoadingState.LOADED:s.LoadingState.LOADING_REMAINING_PAGES;w.onAddFilesAndSetLoadingState({path:w.path,files:r.map(n.File.fromServerObject),paginatedTotalNumFiles:t,loadingState:a}),o&&(e.stopAutoFetching(),w.onLoadComplete())}});l.waitForTTI().then(function(){return r.startAutoFetching()})},this.user=d,this.path=u,this.fqPathsToSelect=p,this.onPrefetchComplete=h,this.onPrefetchError=f,this.onLoadComplete=m,this.onPostTTIPrefetchComplete=_,this.onPostTTIPrefetchError=S,this.onInitializeEverything=g,this.onLoad=E,this.onAddFilesAndSetLoadingState=v,this.browsePreloadHandler=i.__REGISTER_BROWSE_PRELOAD_HANDLER,this.firstPagePreloadHandler=i.__REGISTER_BROWSE_FIRST_PAGE_PRELOAD_HANDLER,this.postTTIPreloadHandler=i.__REGISTER_BROWSE_POST_TTI_PRELOAD_HANDLER}return e})();t.BrowsePrefetchLoader=d}),define("modules/clean/react/browse/browse_view",["require","exports","tslib","external/immutable","react","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/action_logger","modules/clean/react/browse/constants","modules/clean/react/folder_overview/connected","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/browse/sidebar","modules/clean/react/browse/title","modules/clean/react/browse/web_team_sharing_experiment","modules/clean/react/file_uploader/file_uploader","modules/clean/react/files_view/constants","modules/clean/react/files_view/controller","modules/clean/react/files_view/types","modules/clean/react/maestro/layout","modules/clean/react/search_success_banner/constants","modules/clean/react/search_success_banner/search_success_banner","modules/clean/react/search_success_banner/util","modules/clean/search/search_bar/experiments","modules/clean/search/search_bar/log_helper","modules/clean/search/search_results/controller","modules/clean/search/search_results/log_helper","modules/clean/sharing/access_level","modules/clean/sharing/shared_folder_invite/shared_folder_invite_async","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/core/browser","modules/clean/react/async/loadable","modules/clean/web_user_action_events"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S,g,E,v,w,F,T,b,y,C,I,R,D,N,P,A,O,L){"use strict";var x=this;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importDefault(s),a=r.__importStar(a),l=r.__importStar(l),u=r.__importStar(u),A=r.__importStar(A);var M=[R.NameSpaceAccess.ACCESS_NO_ACCESS,R.NameSpaceAccess.ACCESS_READER,R.NameSpaceAccess.ACCESS_READER_NO_COMMENT],U=(function(t){function R(n){var f=t.call(this,n)||this;return f.onSearchBarAbandonedEvent=function(e){var t=e.detail.searchBarState;f.setState({searchBarAbandoned:t.abandoned})},f.onSearchResultActionClickEvent=function(e){var t=e.detail.resultActionState;f.setState({searchResultActionClicked:t.clicked})},f.handleGetOverflowMenuActions=function(e,t,r){var s=f.handleGetFileActionsForSetOfFiles(o.Set([e]),t,r,!1),n=new Array;return s.forEach(function(e){"function"!=typeof e&&n.push(e)}),[n]},f.handleGetFileActionsForSetOfFiles=function(t,r,o,s,n){if(f.props.arePostTTIModulesLoaded){var a=f.props,i=a.context,l=a.user,c=a.actionHandlers,d=a.isSearchMode,u=a.isOverFreeQuota,p=a.isQueryingFolderSizes,h=a.browsePostTTIExperiments,m=a.viewType,_=a.fileExtensionsConfigs,S=a.searchBarExperiments,g=a.pinnedItems,E=e("modules/clean/react/browse/file_actions"),v=h.expShowAddToShowcase,w=h.expShowAddFolderToShowcase,F=h.expBrowseMoveSuggestions,T=h.expEsignatureEnabled,b=h.expHasCreatedShowcase,y=h.expHasShowcaseFreemium,C=h.expShowShowcaseInterstitial,I=h.expFolderCalcSize,R=h.expNewFolderInMoveDialog,D=h.expMetaserverDownloads,N="ON"===F,P="ON"===R,A="CTX"===I,O=S.expSearchSuccessBanner;return E.getActionsForFileCollection({files:t,context:i,user:l,viewType:m,fileExtensionsConfigs:_,canDisplayFolderSizes:r,actionHandlers:c,skipSharing:!1,isSearchMode:d,isOverFreeQuota:u,isQueryingFolderSizes:p,canShowUJPopup:s,showAddToShowcase:!!v,showAddFolderToShowcase:!!w,hasCreatedShowcase:!!b,hasShowcaseFreemium:!!y,isSidebar:n,showShowcaseInterstitialExp:!!C,responsive:o,showFolderSuggestion:N,showPrepareForSignature:!!T,showFolderCalcSize:A,createNewFolderInMoveDialog:P,useMetaserverDownloads:!!D,useSearchSuccessBanner:!!O,pinnedItems:g})}return[]},f.handleLocationLinkClick=function(e,t){if(!t){var r=a.parent_dir(e.fq_path);f.props.onNavigateToPath(r)}},f.handleOpenPaper=function(e){var t=f.props,r=t.user,o=t.isSearchMode,s=t.viewType;o&&I.recordSearchResultsAction({result:e,user:r,action_type:L.WebUserActionLogEvent.PAPER_OPEN,view_type:s}),A.redirect(e.url)},f.handleUploadButtonClick=function(e){_.FileUploaderController.setPath(f.props.path),_.FileUploaderController.handleUploadButtonClick(e)},f.handleShowFileUploader=function(){_.FileUploaderController.setPath(f.props.path),_.FileUploaderController.showModal()},f.handleSelectionChange=function(e){var t=f.props.getFileByFullPath(e.selected.first());if(t){var r=t.ns_id,o=t.sjid,s=t.file_id,n=t.fq_path,i=t.bytes,c=t.ext,d=t.request_id;l.logSelectRow({uid:f.props.user.id,entity_type:t.is_dir?"folder":"file",view_type:f.props.viewType,file_nsid:r,file_sjid:o,file_id:s,file_name:a.filename(t.fq_path),file_path:n,file_size:i,file_extension:c,request_id:d})}f.props.onSelectionChange({selection:e})},f.handleFileListSortChange=function(e,t){l.logSortRecords({uid:f.props.user.id,sort_by:e,sort_direction:t,view_type:f.props.viewType}),f.props.onSortFiles({sortField:e,sortDirection:t})},f.handleStarClick=function(e,t){var r=t?L.WebUserActionLogEvent.STAR:L.WebUserActionLogEvent.REMOVE_STAR,o=f.props,s=o.user,n=o.isSearchMode,a=o.viewType,i=o.selectedFiles,c=o.searchBarExperiments,d=u.countFilesAndFolders(i),p=d.num_files_selected,h=d.num_folders_selected;if(n){I.recordSearchResultsAction({result:e,user:s,action_type:r,view_type:a});c.expSearchSuccessBanner&&T.doSearchResultActionClickBroadcast(!0)}else l.logBrowseAction(s.id,"BROWSE",r,p,h,a,e)},f.handleSearchFromSearchBar=function(e){var t=e.query,r=e.searchPath,o=e.qargs;t?f.props.onSearch(t,r,!0,o):f.props.onSetUrl({path:r})},f.handleSearchResultOpen=function(e){e instanceof p.File?(y.logDropdownSearchAction({result:e,user:f.props.user,action_type:e.is_dir?L.WebUserActionLogEvent.FOLDER_OPEN:L.WebUserActionLogEvent.FILE_VIEW,viewport:"dropdown-view"}),f.props.onSearchBarResultOpen(e)):(e instanceof p.Paper||e instanceof p.PaperFolder)&&(y.logDropdownSearchAction({result:e,user:f.props.user,action_type:L.WebUserActionLogEvent.PAPER_OPEN,viewport:"dropdown-view"}),A.open_tab(e.url))},f.handleResultObjectPathClick=function(e){f.props.searchBarExperiments.expSearchSuccessBanner&&(T.setSearchSuccessBannerVisible(),T.setClickablePathData(a.parent_dir(e.fq_path))),y.logDropdownSearchAction({result:e,user:f.props.user,action_type:L.WebUserActionLogEvent.CLICK_PATH_LINK,viewport:"dropdown-view"}),f.props.onSearchBarPathClicked(e)},f.setFilesViewControllerRef=function(e){f.filesViewControllerRef=e},f.handleSearchFromSearchResults=function(e,t,r){f.props.onSearch(e,t,!1,r)},f.handleFocusSearchBar=function(){return document.getElementsByClassName("search-bar__text-input")[0].focus()},f.renderSharedWithController=function(t){var r=f.props,o=r.context,n=r.arePostTTIModulesLoaded,a=r.user;if(!n)return null;if(t.type===i.FileTypes.TEAM_SHARED_FOLDER&&("archived"===t.team_folder_status||"archive_in_progress"===t.team_folder_status))return null;var l=f.props.selectedFiles,c=!!l.size,d=e("modules/clean/react/browse/shared_with").SharedWithController;return s.default.createElement("div",{className:"brws-vertically-center brws-shared-with-wrapper"},s.default.createElement(d,{file:t,browseContext:o,inSelectMode:c,user:a}))},f.renderAppContent=function(e){return f.props.isSearchMode?f.renderSearchResults(e):f.renderFilesViewController(e)},f.getPageHeaderHeight=function(e){return e.isMatchedLarge||e.isMatchedMedium?c.DEFAULT_PAGE_HEADER_HEIGHT:c.COMPACT_PAGE_HEADER_HEIGHT},f.handleFixedHeaderHeightChange=function(e){f.setState({fixedHeaderHeight:e})},f.renderFixedHeader=function(){return f.props.shouldShowFolderOverview?s.default.createElement(d.FolderOverview,{onNavigateToFileOrFolder:f.props.onNavigateToFileOrFolder,isReadOnly:!f.props.context.isCurrentPathWriteable(),browseLoadingState:f.props.loadingState,onChangeHeight:f.handleFixedHeaderHeightChange}):f.props.shouldShowSharedFolderInvites?s.default.createElement(D.AsyncSharedFolderInvite,{user:f.props.user,onChangeHeight:f.handleFixedHeaderHeightChange}):null},f.renderSidebar=function(e){var t=f.props,o=t.fileCategories,n=t.fileExtensionsConfigs,a=t.isNautilusEnabled,i=t.isPaperEnabled,l=t.pinnedItems;return s.default.createElement(h.BrowseSidebar,r.__assign({},f.props,{onSearch:f.handleSearchFromSearchResults,onUploadButtonClick:f.handleUploadButtonClick,onGetFileActionsForFiles:f.handleGetFileActionsForSetOfFiles,responsive:e,fileCategories:o,isNautilusEnabled:a,isPaperEnabled:i,fileExtensionsConfigs:n,pinnedItems:l}))},f.hideTimeline=function(){f.props.onHideTimeline()},f.state={searchBarProps:f.getCurrentSearchBarProps(f.props),searchBarAbandoned:!1,searchResultActionClicked:!1},window.addEventListener(w.SEARCH_BAR_ABANDONED_EVENT,f.onSearchBarAbandonedEvent),window.addEventListener(w.SEARCH_RESULT_ACTION_CLICK_EVENT,f.onSearchResultActionClickEvent),f}return r.__extends(R,t),R.prototype.componentWillReceiveProps=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return e.isSearchMode===this.props.isSearchMode&&e.path===this.props.path||this.setState({searchBarProps:this.getCurrentSearchBarProps(e)}),[2]})})},R.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,P.waitForTTI()];case 1:return t.sent(),this.defineFileUploader(),this.maybeOpenUploaderOnMount(),new Promise(function(t,r){e(["modules/clean/growth/experiments/overquota_helper"],t,r)}).then(r.__importStar).then(function(e){e.OverquotaHelper.maybeShowSubgrowthProOQRecurringModal("wb_oq_ups_recur_fb")}),N.UEClient.sendEvent("BrowseView","componentDidMount",this.props.context.toJSON()),[2]}})})},R.prototype.componentDidUpdate=function(){this.props.loadingState===E.LoadingState.LOADED&&N.UEClient.sendEvent("BrowseView","componentDidUpdate",this.props.context.toJSON())},R.prototype.componentWillUnmount=function(){window.removeEventListener(w.SEARCH_BAR_ABANDONED_EVENT,this.onSearchBarAbandonedEvent),window.removeEventListener(w.SEARCH_RESULT_ACTION_CLICK_EVENT,this.onSearchResultActionClickEvent)},R.prototype.maybeOpenUploaderOnMount=function(){this.props.shouldOpenUploadModal&&this.handleShowFileUploader()},R.prototype.getCurrentDropTargetHighlightMode=function(){var e=this.props,t=e.selectedFiles,r=e.context;return r.isInsideSharedFolder&&M.includes(r.currentSharedFolderPermissionRole)?E.DropTargetHighlightMode.NONE:this.props.isDraggingInternalFiles?t.some(function(e){return e.isDeleted||e.type===i.FileTypes.TEAM_SHARED_FOLDER})?E.DropTargetHighlightMode.NONE:t.some(function(e){return e.type===i.FileTypes.SHARED_FOLDER})?r.currentNSAllowsNesting?E.DropTargetHighlightMode.NONSELECTED_FOLDERS:E.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS:E.DropTargetHighlightMode.NONSELECTED_FOLDERS:this.props.isDraggingExternalFiles&&!this.props.isUploadModalOpen?E.DropTargetHighlightMode.ALL_FOLDERS:E.DropTargetHighlightMode.NONE},R.prototype.getCurrentSearchBarProps=function(e){return{showSearchBar:!0,currentPath:e.path,onSearch:this.handleSearchFromSearchBar,onSearchResultOpen:this.handleSearchResultOpen,onResultObjectPathClick:this.handleResultObjectPathClick,isSearchBarExpanded:e.isSearchMode,searchBarExperiments:e.searchBarExperiments,onSearchFiltersChanged:e.onSearchFiltersChanged,searchFrom:e.searchFrom}},R.prototype.getFilesViewControllerRef=function(){return this.filesViewControllerRef},R.prototype.renderSearchSuccessBanner=function(){var e=this.props,t=e.isSearchMode,r=e.searchBarExperiments,o=r.expSearchSuccessBanner,n=this.state.searchBarAbandoned||this.state.searchResultActionClicked&&t||T.shouldShowSearchSuccessBanner();return o&&!T.isFilePreview()&&!T.userIsOptedOutOfSearchSuccessBanner()&&n?s.default.createElement(F.SearchSuccessBanner,{user:this.props.user,displayContext:w.SearchSuccessDisplayContext.IN_EMBEDDED_APP}):null},R.prototype.renderSearchResults=function(e){var t=this.props,r=t.actionHandlers,o=t.filesViewActionHandlers,a=t.fileRename,i=t.path,l=t.user,c=t.handleComponentTTI,d=t.isFileViewerShown,u=t.arePostTTIModulesLoaded,p=t.getIsFileJumping,h=t.ensureFileViewerClosedIfNotPreviewing,f=t.browseExperiments,m=t.searchResultsExperiments,S=t.searchBarExperiments,g=t.onNavigateToParentFolder,E=t.onNavigateToPath,v=t.shouldShowDeletedFiles,w=t.onNavigateToFileOrFolder,F=t.onSearchFiltersChanged,T=t.starredState,y=t.fileCategories,I=t.isPaperEnabled,R=t.viewType;return s.default.createElement("div",null,this.renderSearchSuccessBanner(),s.default.createElement(C.SearchResultsController,{actionHandlers:r,filesViewActionHandlers:o,path:i,user:l,searchResultsExperiments:m,searchBarExperiments:S,browseExperiments:f,onSearch:this.handleSearchFromSearchResults,setFileUploaderPath:_.FileUploaderController.setPathAndPermissions,maestroSearchBarProps:this.state.searchBarProps,handleComponentTTI:c,ensureFileViewerClosedIfNotPreviewing:h,getIsFileJumping:p,renderSharedWithController:this.renderSharedWithController,hrefForFile:n.href_for_file,isFileViewerShown:d,fileRename:a,arePostTTIModulesLoaded:u,getOverflowMenuActions:this.handleGetOverflowMenuActions,onFocusSearchBar:this.handleFocusSearchBar,onNavigateToFileOrFolder:w,onNavigateToParentFolder:g,onNavigateToPath:E,onOpenPaper:this.handleOpenPaper,shouldShowDeletedFiles:b.isInDeletedFilterRightRailExperiment(S)?v:void 0,responsive:e,onSearchFiltersChanged:F,starredState:T,viewType:R,fileCategories:y,isPaperEnabled:I,pageHeaderHeight:this.getPageHeaderHeight(e),onStarClick:this.handleStarClick}))},R.prototype.renderFilesViewController=function(e){var t=this.props.shouldShowPinnedTeamFolders,o=t?this.props.filesWithoutTeamFolders:this.props.files;return s.default.createElement("div",{className:"maestro-browse-app-content"},this.renderSearchSuccessBanner(),s.default.createElement(m.WebTeamSharingModalExperiment,{context:this.props.context,user:this.props.user,
path:this.props.path,selectedFiles:this.props.selectedFiles,browsePostTTIExperiments:this.props.browsePostTTIExperiments}),this.renderFixedHeader(),s.default.createElement(g.FilesViewController,r.__assign({},this.props.filesViewActionHandlers,{disabledMultiselect:this.props.isTimelineVisible,getOverflowMenuActions:this.handleGetOverflowMenuActions,renderSharedWithController:this.renderSharedWithController,hrefForFile:n.href_for_file,onLocationLinkClick:this.handleLocationLinkClick,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder,onNavigateToParentFolder:this.props.onNavigateToParentFolder,onOpenPaper:this.handleOpenPaper,onFocusSearchBar:this.handleFocusSearchBar,context:this.props.context,createNewFolderState:this.props.createNewFolderState,currentSort:this.props.currentSort,dropTargetHighlightMode:this.getCurrentDropTargetHighlightMode(),fileRename:this.props.fileRename,items:o,responsive:e,getIsFileJumping:this.props.getIsFileJumping,isDraggingExternalFiles:this.props.isDraggingExternalFiles,isDraggingInternalFiles:this.props.isDraggingInternalFiles,isFileViewerShown:this.props.isFileViewerShown,isOverFreeQuota:this.props.isOverFreeQuota,shouldShowPinnedTeamFolders:t,arePostTTIModulesLoaded:this.props.arePostTTIModulesLoaded,fileExtensionsConfigs:this.props.fileExtensionsConfigs,isTextSelectable:this.props.isTextSelectable,loadingState:this.props.loadingState,onComponentTTI:this.props.handleComponentTTI,onSelectionChange:this.handleSelectionChange,onSortChange:this.handleFileListSortChange,onStarClick:this.handleStarClick,path:this.props.path,ref:this.setFilesViewControllerRef,selectedFiles:this.props.selectedFiles,selection:this.props.selection,setFileUploaderPath:_.FileUploaderController.setPathAndPermissions,showFileUploaderModal:this.handleShowFileUploader,teamFolders:this.props.teamFolders,totalNumFiles:this.props.totalNumItems,user:this.props.user,viewType:this.props.viewType,isQueryingFolderSizes:this.props.isQueryingFolderSizes,columns:this.props.columns,viewTypeColumns:this.props.viewTypeColumns,viewTypes:S.AllViewTypes,viewTypeLabels:S.ViewTypeLabels,starredState:this.props.starredState,pageHeaderHeight:this.getPageHeaderHeight(e),isStickyColumnHeader:this.props.shouldShowSharedFolderInvites||this.props.shouldShowPinnedTeamFolders||"V1"===this.props.browseExperiments.expFolderOverview,scrollPositionOffset:this.state.fixedHeaderHeight||0})))},R.prototype.defineFileUploader=function(){_.FileUploaderController.loadCoreComponent()},R.prototype.render=function(){var e=this.props,t=e.user,r=e.path,o=e.isDraggingExternalFiles,n=e.isDraggingInternalFiles,a=e.isUploadModalOpen,i=e.isSearchMode,l=e.context,c=e.isTimelineVisible,d=e.onSetUrl,u=e.browsePostTTIExperiments.expFolderHistoryRollbacks;return s.default.createElement("div",null,s.default.createElement(k,{user:t,browseContext:l,hideTimeline:this.hideTimeline,isTimelineVisible:c,expFolderHistoryRollbacks:u||!1}),s.default.createElement(v.MaestroChrome,{user:t,titleRegion:s.default.createElement(f.BrowseTitle,{path:r,user:t,isDraggingExternalFiles:o,isDraggingInternalFiles:n,isUploadModalOpen:a,isSearchMode:i,onSetUrl:d}),titleClass:"page-header__title-overflow",embeddedAppRegion:this.renderAppContent,actionSidebarRegion:this.renderSidebar,searchBarProps:this.state.searchBarProps}))},R.defaultProps={selectedFiles:o.OrderedMap(),viewType:E.ViewType.List},R})(s.default.PureComponent);t.BrowseView=U;var k=O.Loadable({loader:function(){return r.__awaiter(x,void 0,void 0,function(){var t;return r.__generator(this,function(o){switch(o.label){case 0:return[4,P.waitForTTI()];case 1:return o.sent(),[4,new Promise(function(t,r){e(["modules/clean/react/timeline/timeline"],t,r)}).then(r.__importStar)];case 2:return t=o.sent().Timeline,[2,t]}})})}})}),define("modules/clean/react/browse/controller",["require","exports","tslib","external/lodash","react","external/react-dom","modules/clean/analytics","modules/clean/browse/browse_bolt_client","modules/clean/em_string","modules/clean/filepath","modules/clean/filepath","modules/clean/filetypes","modules/clean/history","modules/clean/pagelet_logger","modules/clean/react/app_actions/education/async_extensions_edu_modal","modules/clean/react/async_overquota_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/api","modules/clean/react/browse/browse_prefetch_loader","modules/clean/react/browse/browse_view","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/nav_actions","modules/clean/react/browse/professional_collection_actions","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/file_uploader","modules/clean/react/file_uploader/store","modules/clean/react/file_uploader/utils","modules/clean/react/file_viewer/async_controller","modules/clean/react/fileops_actions","modules/clean/react/files_view/types","modules/clean/react/search_success_banner/util","modules/clean/react/snackbar","modules/clean/search/logger","modules/clean/search/search_bar/chips","modules/clean/search/search_bar/experiments","modules/clean/search/search_results/actions","modules/clean/search/search_helpers","modules/clean/search/search_results/log_helper","modules/clean/search/search_results/store","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/sharing/ui_notifications_util","modules/clean/storage","modules/clean/upsell/prompt_event_emitter","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/constants/python","modules/core/browser","modules/core/exception","modules/core/html","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/react/browse/uri_helper","modules/core/browser_detection","modules/clean/react/files_view/constants","modules/clean/pagination_manager"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S,g,E,v,w,F,T,b,y,C,I,R,D,N,P,A,O,L,x,M,U,k,B,q,V,H,W,z,G,j,Q,K,Y,J,X,Z,$,ee,te,re,oe,se,ne){"use strict";function ae(e){ee.Notify.success($._("%(file_name)s added to your Dropbox.").format({file_name:d.filename(e)}))}function ie(e){var t=$._('Added “%(folder_name)s” <a href="%(href)s">Learn More</a>').format({folder_name:l.Emstring.em_snippet(d.filename(e),H.SNIPPET_SIZES.FILENAME),href:"/help/business/team-space-overview#acceptfolder"});ee.Notify.success(new Z.HTML(t))}function le(e){var t=d.parent_dir(e);"/"!==t&&ee.Notify.success($._("Folder is in %(path)s").format({path:l.Emstring.em_snippet(t,22)}))}function ce(e){var t=re.getQueryArgs();p.default.replace_state(e,o.pick.apply(o,[t,w.BrowseQueryArg.d,w.BrowseQueryArg.select,w.BrowseQueryArg.preview,w.BrowseQueryArg.activity,w.BrowseQueryArg.preselected_for_showcase].concat(w.FRAMEWORK_ARGS)))}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importDefault(s),n=r.__importStar(n),c=r.__importStar(c),p=r.__importDefault(p),m=r.__importStar(m),_=r.__importStar(_),g=r.__importStar(g),R=r.__importStar(R),N=r.__importStar(N),L=r.__importStar(L),k=r.__importStar(k),Q=r.__importStar(Q),J=r.__importStar(J),oe=r.__importStar(oe);var de;(function(e){e[e.BROWSE=0]="BROWSE",e[e.SEARCH=1]="SEARCH"})(de||(de={}));var ue=(function(t){function l(s){var i=t.call(this,s)||this;i.deferredCheckForMissingStarredData=o.noop,i.searchHistoryTime=0,i.logOnceFetchedDataRequiredForTTI=o.once(function(){return Q.log_js_modules_fetched_data_required_for_tti()}),i.previousHistoryCallbackMode=de.BROWSE,i.debouncedRunSearch=o.debounce(function(e){U.searchResultsActions.runSearch(e)},250),i.handlePreviewAndShareModalsOnLoad=function(t){var o=i.getPathFromProps(),s=i.props.user,n=!!i.props["open-preview"],a=!!i.props["show-share-modal"],l=i.props["share-prefill-email"];if(n&&!t){ee.Notify.error($._("The file doesn’t exist"));var c=i.props.urlPrefix,d=i.getUrlForFQPath(c,o),u=re.getQueryArgs();delete u.preview,p.default.replace_state(d,u)}if(t){var h=F.File.fromServerObject(t);D.asyncOpenPreview({containerId:w.BROWSE_FILE_VIEWER_ELEMENT_ID,files:[h],fileViewAction:Y.FileViewActionType.CLICK,fileViewOrigin:Y.FileViewOriginType.BROWSE,fileViewTarget:Y.FileViewTargetType.PRIVATE,indexOfPreviewFile:0,user:s,updateBrowserLocation:!1,onFileViewerDidMount:D.hideElementsBehindFileViewer,onFileViewerUnmount:function(){D.showElementsBehindFileViewer();var e=i.browseViewRef;(e=e.getFilesViewControllerRef())&&(e=e.getFilesViewTileGridRef())&&(e=e.getTileGridRef())&&e.getAndUpdateTileLayout(),i.restoreUrlAfterFileViewClose()}}),a&&Q.waitForTTI().then(function(){i.mounted&&V.asyncShowPrefilledShareModal({user:s,sharePrefillEmail:l,content:h,setPath:T.browseNavActions.setPath,setUrl:i.props.setUrl})})}else a&&i.showShareModalForCurrentPath(l);a||i.props["showing-mobile-billing-modal"]||i.props["showing-client-modal"]||Q.waitForTTI().then(function(){G.promptBufferedEventEmitter.on(G.Events.ON_PROMPT_INITIALIZED,function(t){return r.__awaiter(i,void 0,void 0,function(){var o,s,n,a,i,l;return r.__generator(this,function(c){switch(c.label){case 0:return t&&(t.didMainCampaignLoad()||t.didCampaignForUserEducationLoad())?[2]:[4,new Promise(function(t,r){e(["modules/clean/react/ncct/post_tti_ncct_modal"],t,r)}).then(r.__importStar)];case 1:return o=c.sent().postTTINCCTReminderModal,[4,o()];case 2:return(s=c.sent())?[2]:(n="V1"===this.props.browsePostTTIExperiments.expEngageDesktopWebOnly,a="V1"===this.props.browsePostTTIExperiments.expEngageDesktopWebFirst,n&&this.props.user.is_team?[4,new Promise(function(t,r){e(["modules/clean/growth/experiments/install_client_modal"],t,r)}).then(r.__importStar)]:[3,4]);case 3:return i=c.sent().installClientModalExperiment,i(),[3,6];case 4:return a?[4,new Promise(function(t,r){e(["modules/clean/growth/experiments/non_unity_web_first_modal"],t,r)}).then(r.__importStar)]:[3,6];case 5:l=c.sent().nonUnityWebFirstModal,l(),c.label=6;case 6:return[2]}})})})})},i.receiveStateFromStores=function(){i.setState(i.getStateFromStores())},i.handleComponentTTI=function(e){i.browseLogger&&(i.browseLogger.componentReady(e),i.browseLogger.ttiLogged&&i.ajaxRequestWebTimer&&(i.ajaxRequestWebTimer.markTimeToInteractive(),delete i.ajaxRequestWebTimer))},i.onAllUploadsComplete=function(e){var t=e.detail.files,r=t.map(function(e){return c.normalize(e.path)+c.normalize(e.name)});S.browseActions.selectFilesAfterUpload({fqPathsToSelect:r})},i.getIsFileJumping=function(){return i.props.isFileJumping},i.getFileByFullPath=function(e){return i.props.files.find(function(t){return t.fq_path===e})||null},i.getFileByFilename=function(e){return i.props.files.find(function(t){return c.filename(t.fq_path)===e})||null},i.setBrowseViewRef=function(e){i.browseViewRef=e},i.startBoltLiveUpdate=function(){i.browseBoltClient.startLiveUpdate(function(){i.getChangesRequest&&i.getChangesRequest.abort();var e=i.props,t=e.user,r=e.path,o=e.shouldShowDeletedFiles;i.getChangesRequest=g.getChangesForDirectory({path:r,userId:t.id,namespaceToJournalIdMap:i.browseBoltClient.getNsMap(),includeDeletedFiles:o,onSuccess:function(e){delete i.getChangesRequest,r===i.props.path&&(i.props.applyBoltUpdates({updates:e,setPath:T.browseNavActions.setPath}),i.browseBoltClient.handleUpdateBoltClient(e.bolt_data))}})})},i.toggleTimelineIfNecessary=function(){var e=re.getQueryArgs().activity;e&&!i.props.isTimelineVisible&&i.props.showTimeline(),!e&&i.props.isTimelineVisible&&i.props.hideTimeline()},i.showShareModalForCurrentPath=function(e){var t=i.props.user,r=i.getPathFromProps();Q.waitForTTI().then(function(){if(i.mounted){var o=i.props["ns-id"],s=i.props["ns-path"];V.asyncShowPrefilledShareModal({user:t,sharePrefillEmail:e,content:{fqPath:r,isFolder:!0,nsId:o&&s?o:null,targetNsId:o&&!s?o:null},setPath:T.browseNavActions.setPath,setUrl:i.props.setUrl})}})},i.handleFileLocationChange=function(e,t){if(e="/"+te.URI.decode(e),i.ensureFileViewerIsOpenedOrClosedIfNeeded(t),i.toggleTimelineIfNecessary(),t.share&&!i.props["show-share-modal"]&&i.showShareModalForCurrentPath(),i.previousHistoryCallbackMode!==de.BROWSE||!c.paths_are_equal(i.props.path,e)||"1"===t.d!==i.props.shouldShowDeletedFiles||t.reload){t.reload&&(delete t.reload,i.props.setUrl({path:i.props.path,qargs:t}));var r=function(){return se.SortIsFilename.includes(i.props.currentSort.sortField)?P.SortLabel.FILENAME:i.props.currentSort.sortField===P.SortField.MODIFIED?P.SortLabel.MODIFIED:P.SortLabel.SIZE};i.previousHistoryCallbackMode=de.BROWSE,i.props.setPath({path:e}),i.props.setLoadingState({loadingState:P.LoadingState.LOADING_FIRST_PAGE,path:e}),i.props.setShouldShowDeletedFiles({shouldShowDeletedFiles:"1"===t.d}),i.browseLogger&&i.browseLogger.ttiLogged&&i.ensureTimer("browse_ajax","browse_ajax_nav"),g.loadPath({sortLabel:r(),sortIsAscending:i.props.currentSort.sortDirection===P.SortDirection.ASCENDING,path:e,userId:i.props.user.id,sortFoldersFirst:!oe.mac,includeDeletedFiles:"1"===t.d,onSuccess:function(t){var r=t.path,o=t.data,s=t.xhr;if(i.ajaxRequestWebTimer){var n=s.getResponseHeader("x-dropbox-request-id");i.ajaxRequestWebTimer.end(n?n:void 0)}if(c.paths_are_equal(e,r)&&!re.getQueryArgs().query){i.props.setPath({path:e}),i.props.setMountPoints({mountPoints:o.ns_id_to_mount_point});var a=F.BrowseContext.fromServerObject(o);if(o.paginated){var l=o.first_page.total_num_items;i.props.setPathData({path:e,files:[],context:a,paginatedTotalNumFiles:l});ne.PaginationManager.create({firstPage:o.first_page,keyName:"sjid",ajaxURL:"/browse_get_next",userID:i.props.user.id,newDataAvailableCallback:function(t,r){var o=t.areAllItemsReady()?P.LoadingState.LOADED:P.LoadingState.LOADING_REMAINING_PAGES;i.props.appendFiles({path:e,files:r.map(F.File.fromServerObject)}),i.props.setLoadingState({path:e,loadingState:o}),t.areAllItemsReady()&&t.stopAutoFetching()}}).startAutoFetching()}else i.props.setPathData({path:e,files:o.file_info.map(F.File.fromServerObject),paginatedTotalNumFiles:o.file_info.length,context:a}),i.props.setLoadingState({loadingState:P.LoadingState.LOADED,path:e})}},onError:function(){c.paths_are_equal(e,"/")||i.props.setUrl({path:"/"})}})}},i.getPathFromProps=function(){return i.props["init-fq-path"]||"/"},i._handleSearchLocationChange=function(e,t){if(t){i.props.isSearchMode||i.props.setIsSearchMode({isSearchMode:!0});var r=i.searchBarExperiments,o=t.query||t.query_unnormalized||"";e=t.path||t.last_fq_path||"/";var s=t.search_session_id||"",n=t.file_categories||"",a=void 0,l=void 0;if(M.isInDeletedFilterRightRailExperiment(r)&&(a="1"===t.d,i.props.setShouldShowDeletedFiles({shouldShowDeletedFiles:a}),a&&(_.logSwitchViewType({uid:i.props.user.id,isSearchMode:!0,viewType:P.ViewType.List}),i.props.setViewType({viewType:P.ViewType.List}))),o&&(!c.paths_are_equal(e,i.props.path)||o!==i.state.latestQuery||M.isInDeletedFilterRightRailExperiment(r)&&a!==i.props.shouldShowDeletedFiles||k.isInFileTypeFilterExperiment(r)&&n!==k.fileCategoriesToString(i.state.latestFileCategories))){var d=i.props.user;setTimeout(function(){i.props.clearFiles({path:e,context:i.props.brsContext})}),i.previousHistoryCallbackMode=de.SEARCH,c.paths_are_equal(i.props.path,e)||i.props.setPath({path:e}),k.isInFileTypeFilterExperiment(r)&&(l=k.fileCategoriesFromString(n),n!==k.fileCategoriesToString(i.state.latestFileCategories)&&i.props.setFileCategories({fileCategories:l})),i.props.setSearchQuery({query:o,searchSessionId:s,searchPath:e});var u=i.searchResultsExperiments,p=u.expShowSymlinkIcon,h=u.expFolderCalcSize,f={user:d,path:e,query:o,searchSessionId:s,showSymlinkIcon:!!p,webTimer:i.ajaxRequestWebTimer,logOnceFetchedDataRequiredForTTI:i.logOnceFetchedDataRequiredForTTI,deletedFiles:a,expSinglePageSearch:i.isInSinglePageSearchExperiment,fileCategories:l,isPaperEnabled:!!i.props["paper-enabled-for-user"],expFolderCalcSize:h};i.isInSinglePageSearchExperiment?i.debouncedRunSearch(f):U.searchResultsActions.runSearch(f)}}},i.handleSearchExit=function(){i.props.setIsSearchMode({isSearchMode:!1}),U.searchResultsActions.clearSearch(),i.searchBarExperiments.expSearchSuccessBanner&&!A.getClickedOnSearchResultsPageItem()&&A.setSearchSuccessBannerVisible(),i.isInSinglePageSearchExperiment&&!i.props.isSearchBarFocused&&i.props.blurSearchBar()},i.markTTVIfNeeded=function(){if(!i.hasTTVBeenLogged&&i.mounted&&(i.prefetchComplete||i.props["search-query"])){var e=window.ensemble;e&&e.markPageletRenderedByDOMNode(n.findDOMNode(i)),Q.mark_time_to_view(),i.hasTTVBeenLogged=!0}},i.handleFileListUpdated=function(){i.fileViewerIsShown()?i.props.files.isEmpty()?S.browseActions.closeFileViewer():S.browseActions.updatePreview({files:i.props.files.toJS()}):i.ensureFileViewerIsOpenedOrClosedIfNeeded(re.getQueryArgs()),i.prefetchPreviewData(i.props.files.toArray(),i.props.user)},i.handleOnNavigateToPath=function(e){i.searchBarExperiments.expSearchSuccessBanner&&(A.setSearchSuccessBannerVisible(),A.setClickablePathData(e)),i.blurSearchBarIfInSinglePageSearch(),S.browseActions.setUrl({path:e})},i.handleOnNavigateToParentFolder=function(){i.blurSearchBarIfInSinglePageSearch(),S.browseActions.navigateToParentFolder()},i.handleDelete=function(e){var t=e.some(F.File.isTeamSharedFolder),r=e.some(function(e){return e.read_only}),o=e.every(function(e){return e.isDeleted});!i.browseContext.isCurrentPathWriteable()||t||r?t?ee.Notify.error($._("Team folders can’t be deleted.")):ee.Notify.warning($._("You don’t have permission to delete files in this folder.")):o?S.browseActions.doPermanentDeleteWithModal({files:e}):S.browseActions.doDeleteFilesWithModal({files:e})},i.handleSearchBarResultOpen=function(e){S.browseActions.navigateToFileOrFolder({file:e,fileViewAction:Y.FileViewActionType.SEARCH})},i.handleSearchBarPathClicked=function(e){S.browseActions.navigateToResultObjectParentFolder({file:e,fileViewAction:Y.FileViewActionType.SEARCH})},i.handleOnNavigateToFileOrFolder=function(e,t){if(i.blurSearchBarIfInSinglePageSearch(),i.searchBarExperiments.expSearchSuccessBanner&&!A.userIsOptedOutOfSearchSuccessBanner()){A.resetSearchResultClickKey();var r=e.is_dir;if(i.props.isSearchMode)A.setClickedOnSearchResultsPageItem(),A.setSearchSuccessBannerVisible(),r&&A.setFolderSearchResultData(e.fq_path);else{A.doSearchBarInteractionBroadcast(!1),A.doSearchResultActionClickBroadcast(!1);var o=e.fq_path,s=A.getClickablePath(),n=A.getSearchResultPath(),a=A.getSearchResultClickTimestamp(),l=A.getClickableFilePathClickTimestamp(),c=Date.now();a&&c-a<=3e4&&A.parentPathOfFileEqualsSearchResultPath(o,n,r)||l&&c-l<=3e4&&A.parentPathOfFileEqualsSearchResultPath(o,s,r)?A.setSearchSuccessBannerVisible():A.resetSearchSuccessBannerSettings()}}i.props.hideTimeline();var d=window.pageYOffset;i.ensureFullFileObjectPopulated(e,i.completeNavigateToFileOrFolder,function(){window.scrollTo(void 0,d)})},i.ensureFullFileObjectPopulated=function(e,t,r){i.props.isSearchMode?U.searchResultsActions.fetchCompleteSearchResultSRP({searchResult:e,user:i.props.user,onSuccess:t}):t(e,r)},i.completeNavigateToFileOrFolder=function(e,t){var r=i.props,o=r.isSearchMode,s=r.user,n=r.viewer,l=r.viewType,d=e.ns_id,p=e.sjid,h=e.file_id,f=e.fq_path,m=e.bytes,g=e.ext,E=e.request_id;if(_.logOpenRow({uid:s.id,entity_type:e.is_dir?"folder":"file",source:"list_browse",view_type:l,file_nsid:d,file_sjid:p,file_id:h,file_name:c.filename(e.fq_path),file_path:f,file_size:m,file_extension:g,request_id:E}),e.type===u.FileTypes.TEAM_SHARED_FOLDER&&(j.UEClient.sendEvent("FileItemRow","TeamFolderClicked"),a.TeamsWebActionsLogger.log("clicked_team_folder_web",{team_id:n.team_id})),o){var v=K.WebUserActionLogEvent.FILE_VIEW;e.is_unmounted?v=K.WebUserActionLogEvent.UNMOUNTED_VIEW:e.is_dir&&(v=K.WebUserActionLogEvent.FOLDER_OPEN),B.recordSearchResultsAction({result:e,user:s,action_type:v,view_type:l})}S.browseActions.navigateToFileOrFolder({file:e,onFileViewerUnmount:t,fileViewAction:o?Y.FileViewActionType.SEARCH:Y.FileViewActionType.CLICK})},i.actionHandlers={onDelete:i.handleDelete,onShowRename:function(e){return i.props.setFileRename({file:e,renameState:P.RenameState.PENDING_INPUT})},onRestore:function(e){var t=i.state.isOverFreeQuota;!i.props.user.is_team&&t?m.showOverquota("wb_oq_rstdel_f"):S.browseActions.doRestoreFilesWithUnifiedTrashModal({files:e})},onPermanentDelete:function(e){S.browseActions.doPermanentDeleteWithModal({files:e})},onShowComment:function(e){return i.onShowComment(e)},onPrepareForSignature:function(e){return i.onPrepareForSignature(e)}},i.getOnShowShareHandler=function(e,t){var r=i.props.browsePostTTIExperiments,o=r.expShowShowcaseInterstitial,s=r.expHasCreatedShowcase,n=r.expHasShowcaseFreemium;o?S.browseActions.handleShowShareInterstitialModal(e,t,!!s,!!n,i.props.viewType):S.browseActions.handleShowShareModal(e,t)},i.filesViewActionHandlers={onDelete:i.handleDelete,onShowRename:function(e){return i.props.setFileRename({file:e,renameState:P.RenameState.PENDING_INPUT})},onCopyToClipboard:function(e){return i.props.copyFilesToClipboard({files:e})},onPasteFromClipboard:function(){return i.props.pasteFilesFromClipboard({copyFiles:N.copyFiles})},onNewFolderSubmit:function(e){return S.browseActions.createFolder({pathName:i.browseContext.currentFQPath,folderName:e,nsId:i.browseContext.rootNSID,checkFSWs:!0})},onNewFolderCancel:function(){return S.browseActions.cancelCreateFolder()},onRenameSubmit:function(e,t){return i.props.renameFile({file:e,name:t,isSearchMode:i.props.isSearchMode})},onRenameCancel:function(e){return i.props.setFileRename({file:e,renameState:null})},onSwitchViewType:function(e){_.logSwitchViewType({uid:i.props.user.id,isSearchMode:i.props.isSearchMode,viewType:e}),i.props.setViewType({viewType:e})},onColumnsChanged:function(e,t,r){i.props.setViewTypeColumns({columns:e,viewType:t,user:i.props.user}),i.props.setCanDisplayFolderSizes({canDisplayFolderSizes:r})},onCanDisplayFolderSizesChanged:function(e){return i.props.setCanDisplayFolderSizes({canDisplayFolderSizes:e})},onAddFileJumpKeyCode:function(e){return i.props.addFileJumpKeyCode({keyChar:e})},onResetFileJump:function(){return i.props.resetFileJumpFilter()},onShowShare:i.getOnShowShareHandler},i.uploadAjaxInterceptor={interceptUploadPrecheck:function(e){return e},interceptUpload:function(e,t){var o=t.ns_id_for_routing;if(!o){var s=i.props.mountPoints,n=i.props.brsContext.rootNSID;X.assert(null!=s,"mountPoints is null"),X.assert(null!=n,"rootNSID is null"),o=R.getNsId(s,n,e.dest)}return r.__assign({},t,{ns_id_for_routing:o,ns_id:o})}},i.shouldPushNewHistory=function(){if(!i.isInSinglePageSearchExperiment)return!0;var e=(new Date).getTime(),t=e-i.searchHistoryTime;return i.searchHistoryTime=e,t>1e3},i.handleSearch=function(e,t,r,o){var s=k.buildSearchURL({user:i.props.user,searchPath:t,normalizedQuery:e,searchSessionId:r?i.props.searchSessionId:q.getSearchResultsStore().searchSessionId(),searchToken:k.getSearchCsrfToken(),qargs:o});i.ensureTimer("search_results"),i.shouldPushNewHistory()?p.default.push_state(s.getPath(),s.getQuery()):p.default.replace_state(s.getPath(),s.getQuery())},i.handleSearchFiltersChanged=function(e){var t=e.path,r=void 0===t?i.props.path:t,o=e.deletedFiles,s=e.fileCategories,n=void 0===s?i.state.latestFileCategories:s,a=i.state,l=a.searchSessionId,c=a.latestQuery,d=i.props.user;r&&r!==i.props.path&&L.logScopeChipChanged({searchSessionId:l,user:d,chipAdded:!x.isScopeChipRoot(r),filePath:r,viewport:"right-rail",searchType:"full_page"}),void 0!==o&&o!==i.props.shouldShowDeletedFiles&&L.logDeletedFilterChanged({searchSessionId:l,user:d,deletedFiles:o,viewport:"right-rail",searchType:"full_page"});var u={};if(void 0!==o&&(u.d=o?"1":"0"),void 0!==n&&!k.allCategoriesUnchecked(n)){var p=k.fileCategoriesToString(n);u.file_categories=p}i.handleSearch(c,r,!1,u)},i.fileViewerIsShown=function(){if(i.state.arePostTTIModulesLoaded){return e("modules/clean/react/file_viewer/controller").isShown()}return!1},i.ensureFileViewerClosedIfNotPreviewing=function(e){!e.preview&&i.fileViewerIsShown()&&S.browseActions.closeFileViewer()},i.prefetchPreviewData=function(t,r){if(i.state.arePostTTIModulesLoaded){e("modules/clean/react/file_viewer/controller").prewarmPreviewData(t,r)}},i.ensureFileViewerIsOpenedOrClosedIfNeeded=function(e){var t=i.fileViewerIsShown();if(e.preview&&!t){var r=i.getFileByFilename(e.preview);r&&S.browseActions.navigateToFileOrFolder({file:r})}else t&&!e.preview&&S.browseActions.closeFileViewer()},i.getLearnMoreLinkHandler=function(){window.open("/help/business/unsynced-team-folder","_blank")};var l=q.getSearchResultsStore();return i.props.setSearchBarExperiments({experiments:i.searchBarExperiments}),l.add_change_listener(i.receiveStateFromStores),I.uploaderStore.add_change_listener(i.receiveStateFromStores),window.addEventListener(y.ALL_UPLOADS_COMPLETE_EVENT,i.onAllUploadsComplete),i.state=r.__assign({},i.getStateFromStores(),{arePostTTIModulesLoaded:!1,searchFrom:re.getQueryArgs().search_from}),i.props.setIsSearchMode({isSearchMode:!!i.state.latestQuery}),i}return r.__extends(l,t),Object.defineProperty(l.prototype,"uploaderExperiments",{get:function(){return this.props["exp-uploader-experiments"]||{}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"uploaderPostTTIExperiments",{get:function(){return this.state.uploaderPostTTIExperiments||{}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"searchBarExperiments",{get:function(){return this.props["exp-search-bar-experiments"]||{}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"searchResultsExperiments",{get:function(){return this.props["exp-search-results-experiments"]||{}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"browseExperiments",{get:function(){return this.props["exp-browse-experiments"]||{}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"isInSinglePageSearchExperiment",{get:function(){return M.isInSinglePageSearchExperiment(this.searchBarExperiments)},enumerable:!0,configurable:!0}),l.prototype.componentWillMount=function(){var t,o=this;t=this.props["search-query"]?["FilesViewController"]:["FilesViewController","AppActionsView"],this.browseLogger=new h.PageletLogger("browse",t,!0,{view_type:this.props.viewType.toLowerCase()});var s=this.props,n=s.urlPrefix,a=s.user,l=s.viewer,c=this.props["search-query"],d=this.props["share-link"],u=!!this.props["open-preview"],f=this.getPathFromProps();c||d||u||ce(this.getUrlForFQPath(n,f));var m=l.get_users().map(function(e){return e.id});z.UserLocalStorage.clearOtherUsers(m),this.browseBoltClient=new i.BrowseBoltClient(a.id);var _=new E.BrowsePrefetchLoader({user:a,path:f,fqPathsToSelect:this.props["select-fq-paths"]},{onPrefetchComplete:function(e){o.prefetchComplete=!0,o.handlePreviewAndShareModalsOnLoad(e.preview_file_info),Q.log_js_modules_fetched_data_required_for_tti(),o.markTTVIfNeeded()},onPrefetchError:function(){o.prefetchComplete=!0,o.props.setUrl({path:""}),o.handleFileLocationChange("",{})},onLoadComplete:function(){o.maybeShowPrepopulatedAddToCollectionModal(o.props.files)},onPostTTIPrefetchComplete:function(t){var s=t["exp-browse-post-tti-experiments"],n=t["exp-uploader-post-tti-experiments"],a=!!t["is-over-free-quota"],i=!!t["maybe-render-team-admin-modals"];s.expShouldShowNcctPaywall&&J.redirect("/ncct-trial-end"),i&&new Promise(function(t,r){e(["modules/clean/react/ncct/post_tti_ncct_modal"],t,r)}).then(r.__importStar).then(function(e){(0,e.postTTINCCTReminderModal)()}),o.setState({uploaderPostTTIExperiments:n,isOverFreeQuota:a}),o.props.setBrowsePostTTIExperiments({browsePostTTIExperiments:s})},onPostTTIPrefetchError:function(e){X.reportException({err:e||new Error("failed to load post TTI experiments")})}},{onInitializeEverything:S.browseActions.initializeEverything,onLoad:T.browseNavActions.loadPath,onAddFilesAndSetLoadingState:S.browseActions.addFilesAndSetLoadingState});_.isPrefetching()&&_.handlePrefetch(),this.searchBarExperiments.expSearchSuccessBanner&&(window.addEventListener("popstate",function(){A.resetSearchSuccessBannerSettings(),A.doSearchBarInteractionBroadcast(!1),A.doSearchResultActionClickBroadcast(!1)}),p.default.deconstruct_url(document.referrer).qargs.search_session_id&&!A.getClickedOnSearchResultsPageItem()?A.setSearchSuccessBannerVisible():A.getSearchSuccessBannerVisibleFromHome()?(A.setSearchSuccessBannerVisible(),A.resetSearchSuccessBannerVisibleFromHome()):A.resetSearchSuccessBannerSettings());p.default.add_callback(n,this.handleFileLocationChange,!0),p.default.add_callback("/search",this._handleSearchLocationChange,!c),p.default.add_exit_callback("/search",this.handleSearchExit)},l.prototype.componentDidMount=function(){var t=this;this.mounted=!0;var s=this.getPathFromProps(),n=this.props.user,a=this.props["search-query"],i=this.props["share-link"],c=!!this.props["open-preview"];this.props["from-scl-sync-modal"]&&(n.is_cdm_member?ie(s):ae(s)),this.props["show-share-success-snackbar"]&&W.showInBandShareSuccessSnackbar(d.filename(s)),this.shouldShowUnsyncNotification()&&this.showUnsyncNotification(),!a&&i&&!c&&n.is_cdm_member&&le(s),this.toggleTimelineIfNecessary(),this.markTTVIfNeeded(),l.mountFileViewerTarget(),Q.waitForTTI().then(function(){t.props["search-query"]||t.fetchAndStartBoltUpdates();var s=function(e){var r=e[0],s=(r[0],r[1],r[2].SharedWithStore),n=(r[3],r[4]),a=n.checkForMissingStarredData,i=n.StarredStore,l=(r[5],r[6],e[1]),c=(l[0],l[1],l[2].BloodhoundContactsV2),d=l[3].EmailVerification;if(l[4],l[5],l[6],t.mounted){var u=t.props,p=u.user,h=u.path,m=u.files,_=m.toArray();s.initializeWith({path:h,files:_}),a({items:_,user:p});var S=i.addListener(function(){t.setState({starredState:i.getLoadingStates()})});t.deferredCheckForMissingStarredData=function(){return o.defer(function(){a({items:t.props.files.toArray(),user:p})})},t.removeStarredStoreListener=function(){S()},c.getOrCreateForUser(p),t.setState({arePostTTIModulesLoaded:!0}),t.props["email-just-verified"]?d.getForRole(p.role).show_verified_modal():t.props["email-just-verified-and-changed"]?d.getForRole(p.role).show_verified_and_changed_modal():t.props["send-verification-email"]&&d.getForRole(p.role).show_sent_modal(),t.prefetchPreviewData(m.toArray(),p),t.props["should-open-extensions-edu-modal"]&&f.asyncShowExtensionsEduModal()}};s.perfName="browse_post_tti",Promise.all([Promise.all([new Promise(function(t,r){e(["modules/clean/react/file_viewer/controller"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/browse/file_actions"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/browse/shared_with"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/files_view/overflow_menu"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/starred/browse_exports"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/file_modal_controller"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/sharing/share_modal_util"],t,r)}).then(r.__importStar)]),Promise.all([new Promise(function(t,r){e(["modules/clean/sharing/ui_util"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/sharing/wizard/wizard_modals"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/contacts/bloodhound_contacts_v2"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/account/email"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/unity_browse_interface"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/unity/features"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/unity/check_file_cache"],t,r)}).then(r.__importStar)])]).then(s)})},l.prototype.componentWillUpdate=function(e,t){e.isSearchMode&&!this.props.isSearchMode?this.browseBoltClient.stopLiveUpdate():!e.isSearchMode&&this.props.isSearchMode&&this.fetchAndStartBoltUpdates(),e.files.equals(this.props.files)||o.defer(this.handleFileListUpdated)},l.prototype.componentDidUpdate=function(e){
e.loadingState===P.LoadingState.LOADING_FIRST_PAGE&&this.props.loadingState!==e.loadingState&&this.markTTVIfNeeded(),e.files!==this.props.files&&this.deferredCheckForMissingStarredData()},l.prototype.componentWillUnmount=function(){this.removeStarredStoreListener&&this.removeStarredStoreListener(),window.removeEventListener("popstate",function(){A.resetSearchSuccessBannerSettings()}),l.unmountFileViewerTarget(),q.getSearchResultsStore().remove_change_listener(this.receiveStateFromStores),I.uploaderStore.remove_change_listener(this.receiveStateFromStores),window.removeEventListener(y.ALL_UPLOADS_COMPLETE_EVENT,this.onAllUploadsComplete),this.mounted=!1},Object.defineProperty(l.prototype,"browseContext",{get:function(){return this.props.isSearchMode?this.state.srpContext:this.props.brsContext},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"selection",{get:function(){return this.props.isSearchMode?this.state.srpSelection:this.props.brsSelection},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"selectedFiles",{get:function(){return this.props.isSearchMode?this.state.srpSelectedFiles:this.props.brsSelectedFiles},enumerable:!0,configurable:!0}),l.prototype.getStateFromStores=function(){var e=q.getSearchResultsStore(),t=e.latestQuery();return{isDraggingInternalFiles:C.FileUploaderController.isDraggingInternalFiles(),isDraggingExternalFiles:C.FileUploaderController.isDraggingExternalFiles(),isUploadModalOpen:C.FileUploaderController.isUploadModalOpen(),latestFileCategories:e.latestFileCategories(),srpContext:e.browseContext(),srpSelection:e.selection(),srpSelectedFiles:e.selectedFiles(),searchSessionId:e.searchSessionId(),latestQuery:t}},l.prototype.restoreUrlAfterFileViewClose=function(){var e,t=this.props.urlPrefix,r=this.getUrlForFQPath(t,this.props.path);e=this.props["open-preview"]?o.omit(re.getQueryArgs(),w.BrowseQueryArg.preview,w.BrowseQueryArg.select):{},p.default.replace_state(r,e)},l.prototype.getUrlForFQPath=function(e,t){return e+("/"===t?"":te.URI.encode_parts(t))},l.prototype.fetchAndStartBoltUpdates=function(){this.browseBoltClient.isReady()?this.startBoltLiveUpdate():this.browseBoltClient.fetchInitialBoltData(this.startBoltLiveUpdate)},l.prototype.ensureTimer=function(e,t){if(this.ajaxRequestWebTimer&&this.ajaxRequestWebTimer.getContextName()!==e&&delete this.ajaxRequestWebTimer,this.ajaxRequestWebTimer)this.ajaxRequestWebTimer.restart();else{this.ajaxRequestWebTimer=Q.get_timer(e);var r={requireTTI:!0,requireTTV:!1};t&&(r.url=t),this.ajaxRequestWebTimer.initialize(r)}},l.prototype.blurSearchBarIfInSinglePageSearch=function(){this.isInSinglePageSearchExperiment&&this.props.blurSearchBar()},l.prototype.onShowComment=function(e){this.ensureFullFileObjectPopulated(e,function(e){S.browseActions.navigateToFileOrFolder({file:e,shouldFocusComment:!0})})},l.prototype.onPrepareForSignature=function(e){this.ensureFullFileObjectPopulated(e,function(e){S.browseActions.navigateToFileOrFolder({file:e,shouldPrepareForSignature:!0})})},l.prototype.maybeShowPrepopulatedAddToCollectionModal=function(e){var t=re.getQueryArgs();if(t.preselected_for_showcase){var r=t.preselected_for_showcase.split(".").map(function(e){return"id:"+e});b.showPrepopulatedAddToCollectionModal(r,this.props.user,e.toJS());var o=this.getPathFromProps(),s=this.getUrlForFQPath(this.props.urlPrefix,o);delete t[w.BrowseQueryArg.preselected_for_showcase],p.default.replace_state(s,t)}},l.prototype.shouldShowUnsyncNotification=function(){return this.props["should-show-unsync-notification"]},l.prototype.showUnsyncNotification=function(){O.Snackbar.show(s.default.createElement(O.Snackbar,{variant:"generic",title:$._("Do you also need this on your computer?",{comment:'\'"this" refers to the folder that the user is currently browsing. (limited space, please keep the phase short)'}),timeoutDelayMs:1e5,actionButtonText:$._("Learn more"),closeButtonText:$._("Close"),onActionClick:this.getLearnMoreLinkHandler}))},l.prototype.render=function(){var e=this.state,t=e.isUploadModalOpen,r=e.starredState,o=e.arePostTTIModulesLoaded,n=e.isDraggingExternalFiles,a=e.isDraggingInternalFiles,i=e.isOverFreeQuota,l=e.searchSessionId,c=e.latestQuery,d=e.latestFileCategories,u=e.searchFrom,p=this.props,h=p.browsePostTTIExperiments,f=p.canDisplayFolderSizes,m=p.createNewFolderState,_=p.currentSort,S=p.fileRename,g=p.files,E=p.filesWithoutTeamFolders,w=p.hideTimeline,F=p.isQueryingFolderSizes,T=p.isSearchMode,b=p.isTextSelectable,y=p.isTimelineVisible,C=p.loadingState,I=p.paginatedTotalNumFiles,R=p.path,D=p.setAndStoreSortOrder,N=p.setSelection,P=p.setUrl,A=p.shouldShowDeletedFiles,O=p.shouldShowPinnedTeamFolders,L=p.shouldShowSharedFolderInvites,x=p.showTimeline,M=p.teamFolders,U=p.user,k=p.viewType,B=p.viewTypeColumns,q=p.fileExtensionsConfigs,V=p.pinnedItems,H=p.shouldShowFolderOverview,W=this,z=W.browseContext,G=W.selection,j=W.selectedFiles;return s.default.createElement(v.BrowseView,{autoTeamGroupId:this.props["auto-team-group-id"],ref:this.setBrowseViewRef,actionHandlers:this.actionHandlers,filesViewActionHandlers:this.filesViewActionHandlers,onNavigateToParentFolder:this.handleOnNavigateToParentFolder,onNavigateToPath:this.handleOnNavigateToPath,onNavigateToFileOrFolder:this.handleOnNavigateToFileOrFolder,onSearchBarResultOpen:this.handleSearchBarResultOpen,context:z,onSearchBarPathClicked:this.handleSearchBarPathClicked,createNewFolderState:m,currentSort:_,ensureFileViewerClosedIfNotPreviewing:this.ensureFileViewerClosedIfNotPreviewing,fileRename:S,files:g,filesWithoutTeamFolders:E,getIsFileJumping:this.getIsFileJumping,getFileByFullPath:this.getFileByFullPath,handleComponentTTI:this.handleComponentTTI,isDraggingExternalFiles:n,isDraggingInternalFiles:a,isFileViewerShown:this.fileViewerIsShown,isSearchMode:T,isTextSelectable:b,isTimelineVisible:y,isUploadModalOpen:t,loadingState:C,onSearch:this.handleSearch,path:R,selectedFiles:j,selection:G,shouldOpenUploadModal:this.props["should-open-upload-modal"],shouldShowDeletedFiles:A,shouldShowPinnedTeamFolders:O,shouldShowSharedFolderInvites:L,starredState:r,teamFolders:M,totalNumItems:I,uploadAjaxInterceptor:this.uploadAjaxInterceptor,user:U,viewType:k,canDisplayFolderSizes:f,columns:B[k],viewTypeColumns:B,arePostTTIModulesLoaded:o,isNoComment:this.props["is-no-comment"],isOverFreeQuota:i,isQueryingFolderSizes:F,nsId:this.props["ns-id"],uploaderExperiments:this.uploaderExperiments,uploaderPostTTIExperiments:this.uploaderPostTTIExperiments,searchBarExperiments:this.searchBarExperiments,searchResultsExperiments:this.searchResultsExperiments,browseExperiments:this.browseExperiments,browsePostTTIExperiments:h,searchSessionId:l,latestQuery:c,onSearchFiltersChanged:this.handleSearchFiltersChanged,fileCategories:d,isNautilusEnabled:!!this.props["nautilus-enabled-for-user"],isPaperEnabled:!!this.props["paper-enabled-for-user"],searchFrom:u,onShowTimeline:x,onHideTimeline:w,onSelectionChange:N,fileExtensionsConfigs:q,onSortFiles:D,onSetUrl:P,pinnedItems:V,shouldShowFolderOverview:H})},l.mountFileViewerTarget=function(){var e=document.getElementById(w.BROWSE_FILE_VIEWER_ELEMENT_ID);e||(e=document.createElement("div"),e.id=w.BROWSE_FILE_VIEWER_ELEMENT_ID,document.body.insertBefore(e,document.body.children[0]))},l.unmountFileViewerTarget=function(){var e=document.getElementById(w.BROWSE_FILE_VIEWER_ELEMENT_ID);e&&document.body.removeChild(e)},l})(s.default.Component);t.BrowseController=ue}),define("modules/clean/react/browse/data/action_creators",["require","exports","tslib","external/immutable","external/lodash","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/data/helpers","modules/clean/react/browse/uri_helper","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/file_uploader/constants","modules/clean/react/files_view/types","modules/clean/react/selection","modules/clean/react/snackbar","modules/clean/search/constants","modules/clean/search/search_results/dispatcher","modules/core/cookies","modules/core/exception","modules/core/i18n","modules/core/uri","modules/clean/react/app_actions/data/action_creators","modules/clean/redux/tests/store"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S,g,E,v,w,F,T,b,y,C,I){"use strict";function R(e,r,o,s){var n=o.mount_points,a=h.path(r()),i=u.getMountPointUpdateForCurrentPath(n,a,h.mountPoints(r())),l=i[0],c=i[1];l&&!c&&E.Snackbar.complete(b._("The folder was unshared."));var d=u.getPathForNewMountPoint(l,c,a);if(d)return void s({path:d});e(t.setMountPoints({mountPoints:n}))}function D(e,r,o){var s=o.added,n=o.moved,l=o.removed,c=h.path(r()),u=h.unsortedFiles(r()),p=h.folderSizes(r()),f=u.size;u=u.withMutations(function(e){p=p.withMutations(function(t){for(var r=function(e){return a.paths_are_equal(a.parent_dir(e.fq_path),c)},o=function(t){r(t)&&(e.set(t.fq_path,m.File.fromServerObject(t)),f+=1)},i=function(r,s){var n=e.get(r);if(!(n&&n.sjid>=s.sjid&&r===s.fq_path)){e.remove(r),f-=1,o(s);var a=t.get(r);a&&(t.remove(r),t.set(s.fq_path,a))}},d=function(r){e.remove(r),t.remove(r),f-=1},u=0,p=s;u<p.length;u++){var h=p[u];e.has(h.fq_path)?i(h.fq_path,h):o(h)}for(var _=0,S=n;_<S.length;_++){var g=S[_],E=g[0],h=g[1];e.has(E)?i(E,h):o(h)}for(var v=0,w=l;v<w.length;v++){var E=w[v];e.has(E)&&d(E)}})}),u.size!==f&&T.reportException({err:new Error("applyBoltUpdates ended up with unexpected number of items"),tags:["browse_file_collections_mismatch"],severity:T.SEVERITY.CRITICAL,exc_extra:{expected_unsorted_files_size:f,actual_unsorted_files_size:u.size,is_deleted_files_on:h.shouldShowDeletedFiles(r()),filesAdded:s,filesRemoved:l,filesMove:n}}),u!==h.unsortedFiles(r())&&(t.setUnsortedFiles({unsortedFiles:u})(e,r,I.mockExtraArguments),i.Dispatcher.dispatch({type:d.SharedWithActionType.BROWSE_FILES_UPDATED,data:{parentPath:c,files:u.toArray()}})),p!==h.folderSizes(r())&&e(t.setFolderSizes({folderSizes:p})),L({unsortedFiles:u})(e,r,I.mockExtraArguments)}var N=this;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),n=r.__importStar(n),a=r.__importStar(a),l=r.__importDefault(l),c=r.__importStar(c),h=r.__importStar(h),v=r.__importStar(v);t.appInit=function(e){var t=e.experiments,r=e.shouldShowDeletedFiles,o=e.user,s=e.viewer;return function(e,n){e({type:f.ActionTypes.APP_INIT,payload:{experiments:t,shouldShowDeletedFiles:r,user:o,viewer:s}});var a=F.Cookies.read(d.BROWSE_SORT_COOKIE_NAME);if(a&&a.indexOf("|")>-1){var l=a.split("|",2),c={sortField:l[0],sortDirection:l[1]},u=h.sortOrder(n());c.sortDirection===u.sortDirection&&c.sortField===u.sortField||e(O({sortOrder:c}))}i.Dispatcher.dispatch({type:_.UploaderActionType.SET_USER,data:{user:o}})}},t.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;return{type:f.ActionTypes.SELECT_FILES_BY_FQ_PATH,payload:{fqPathsToSelect:t}}},t.setCanDisplayFolderSizes=function(e){var t=e.canDisplayFolderSizes;return{type:f.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES,payload:{canDisplayFolderSizes:t}}},t.setClipboardFiles=function(e){var t=e.clipboardFiles;return{type:f.ActionTypes.SET_CLIPBOARD_FILES,payload:{clipboardFiles:t}}},t.copyFilesToClipboard=function(e){var r=e.files;return function(e,o){if(r.length){if(r.some(function(e){return e.isDeleted}))return void E.Snackbar.fail(b._("Deleted files cannot be added to the clipboard"));if(r.some(m.File.isTeamSharedFolder))return void E.Snackbar.fail(b._("Team Folders can’t be copied."));var s=b.ungettext("Added %(num_items)s item to clipboard","Added %(num_items)s items to clipboard",r.length).format({num_items:r.length});E.Snackbar.complete(s),e(t.setClipboardFiles({clipboardFiles:r}))}}},t.pasteFilesFromClipboard=function(e){var t=e.copyFiles;return function(e,r){t({user:h.user(r()),files:h.clipboardFiles(r()),newPath:h.path(r()),checkFSWs:!0,dataApi:c,onSuccess:function(e){var t=b.ungettext("Pasted %(num_items)s item from clipboard","Pasted %(num_items)s items from clipboard",e.length).format({num_items:e.length});E.Snackbar.complete(t)}})}},t.setContext=function(e){var t=e.context;return{type:f.ActionTypes.SET_CONTEXT,payload:{context:t}}},t.setBrowsePostTTIExperiments=function(e){var t=e.browsePostTTIExperiments;return{type:f.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS,payload:{browsePostTTIExperiments:t}}};var P=function(e){var t=e.fileJumpFilter;return{type:f.ActionTypes.SET_FILE_JUMP_FILTER,payload:{fileJumpFilter:t}}};t.addFileJumpKeyCode=function(e){var r=e.keyChar;return function(e,o){var s=h.fileJumpFilter(o())+r.toLowerCase();e(P({fileJumpFilter:s}));for(var n=null,a=h.fileJumpIndex(o()),i=0,l=a;i<l.length;i++){var c=l[i],d=c.fqPath;if(c.filename>=s){n=d;break}}null!=n&&e(t.selectFilesByFqPath({fqPathsToSelect:[n]}))}},t.resetFileJumpFilter=function(){return P({fileJumpFilter:""})},t.setFilePathsToSelectOnNextUpdate=function(e){var t=e.filePathsToSelectOnNextUpdate;return{type:f.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE,payload:{filePathsToSelectOnNextUpdate:t}}},t.showTimeline=function(){return{type:f.ActionTypes.SHOW_TIMELINE,payload:{}}},t.hideTimeline=function(){return{type:f.ActionTypes.HIDE_TIMELINE,payload:{}}},t.setFileRename=function(e){var t=e.file,r=e.renameState;return{type:f.ActionTypes.SET_FILE_RENAME,payload:{file:t,renameState:r}}};var A=function(e,t){w.SearchResultsDispatcher.dispatch({type:v.CHANGE_FILES_ACTION,data:{fileDeltas:[{before:e.fq_path,after:e.is_dir?t.set("icon",e.icon):t}]}})};t.renameFile=function(e){var s=e.file,a=e.name,i=e.isSearchMode;return function(e,l){return r.__awaiter(N,void 0,void 0,function(){var d,u,p,f,m;return r.__generator(this,function(r){switch(r.label){case 0:d=h.user(l()),e(t.setFileRename({file:s,renameState:S.RenameState.SAVING_INPUT})),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,c.renameFile({file:s,name:a,user:d})];case 2:return u=r.sent(),p=u.renamedFile,f=u.changesets,n.notifyRenameSuccess(d,f,function(){i&&A(p,s),e(t.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set([s.fq_path])}))}),e(t.setFileRename({file:s,renameState:null})),i&&A(s,p),e(t.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set([p.fq_path])})),[3,4];case 3:return m=r.sent(),e(t.setFileRename({file:s,renameState:null})),[3,4];case 4:return[2]}})})}},t.setFolderSizes=function(e){var t=e.folderSizes;return{type:f.ActionTypes.SET_FOLDER_SIZES,payload:{folderSizes:t}}},t.setLoadingState=function(e){var t=e.loadingState,r=e.path;return{type:f.ActionTypes.SET_LOADING_STATE,payload:{loadingState:t,path:r}}},t.setMountPoints=function(e){var t=e.mountPoints;return{type:f.ActionTypes.SET_MOUNT_POINTS,payload:{mountPoints:t}}},t.setNewFolderCreationState=function(e){var t=e.newFolderCreationState;return{type:f.ActionTypes.SET_NEW_FOLDER_CREATION_STATE,payload:{newFolderCreationState:t}}},t.setPaginatedTotalNumFiles=function(e){var t=e.paginatedTotalNumFiles;return{type:f.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES,payload:{paginatedTotalNumFiles:t}}},t.setUrl=function(e){var o=e.path,n=void 0===o?"":o,a=e.qargs;return function(e,o){l.default.push_state(h.urlPrefix(o())+y.URI.encode_parts(n),s.omitBy(r.__assign({},s.pick(p.getQueryArgs(),["d"]),a),s.isUndefined)),e(t.setSelection({selection:g.createSelection()}))}},t.setPath=function(e){var t=e.path;return{type:f.ActionTypes.SET_PATH,payload:{path:t}}},t.setPathData=function(e){var r=e.path,s=e.files,n=e.paginatedTotalNumFiles,l=e.context;return function(e,c){if(a.paths_are_equal(r,h.path(c()))){var u=o.Map(s.map(function(e){return[e.fq_path,e]}));e(t.setContext({context:l})),t.setUnsortedFiles({unsortedFiles:u})(e,c,I.mockExtraArguments),e(t.setPaginatedTotalNumFiles({paginatedTotalNumFiles:n})),e(t.clearSelection()),L({unsortedFiles:u})(e,c,I.mockExtraArguments),setTimeout(function(){i.Dispatcher.dispatch({type:d.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:r,files:s}}),i.Dispatcher.dispatch({type:_.UploaderActionType.SET_PATH,data:{path:r,hasPermissionToUploadToFolder:l.isCurrentPathWriteable()}})},1)}}},t.setSelection=function(e){var t=e.selection;return{type:f.ActionTypes.SET_SELECTION,payload:{selection:t}}},t.clearSelection=function(){return t.setSelection({selection:g.createSelection()})},t.setShouldShowDeletedFiles=function(e){var t=e.shouldShowDeletedFiles;return{type:f.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES,payload:{shouldShowDeletedFiles:t}}};var O=function(e){var t=e.sortOrder;return{type:f.ActionTypes.SET_SORT_ORDER,payload:{sortOrder:t}}};t.setAndStoreSortOrder=function(e){return function(t,r){F.Cookies.delete(d.BROWSE_SORT_COOKIE_NAME);var o=e.sortField+"|"+e.sortDirection;F.Cookies.create(d.BROWSE_SORT_COOKIE_NAME,o,1095),t(O({sortOrder:e}))}},t.setUnsortedFiles=function(e){var t=e.unsortedFiles;return function(e,o){return r.__awaiter(N,void 0,void 0,function(){var s,n;return r.__generator(this,function(r){switch(r.label){case 0:return s=h.user(o()),e({type:f.ActionTypes.SET_UNSORTED_FILES,payload:{unsortedFiles:t}}),n=e,[4,C.updateExtensionConfigWithNewFiles({files:t.toArray(),user:s})];case 1:return n.apply(void 0,[r.sent()]),[2]}})})}},t.requestFolderSizes=function(e){var t=e.fqPath;return{type:f.ActionTypes.REQUEST_FOLDER_SIZES,payload:{fqPath:t}}},t.setFolderSizesPending=function(e){var t=e.fetchFolderSizesResp;return{type:f.ActionTypes.SET_FOLDER_SIZES_PENDING,payload:{fetchFolderSizesResp:t}}},t.completeFolderSizes=function(e){var t=e.fetchFolderSizeState;return{type:f.ActionTypes.COMPLETE_FOLDER_SIZES,payload:{fetchFolderSizeState:t}}},t.setFetchFolderSizeState=function(e){var r=e.files,o=e.state;return function(e,s){var n=h.browsePostTTIExperiments(s());if(n&&n.expFolderCalcSize&&"AUTO"===n.expFolderCalcSize){for(var a={sizes_dict:[],queue:[]},i=0,l=r;i<l.length;i++){var c=l[i];c.is_dir&&c.bytes>=0&&!m.File.isNoAccessSharedFolder(c)&&(a.sizes_dict.push({fq_path:c.fq_path,size:c.bytes}),e(t.requestFolderSizes({fqPath:c.fq_path})))}e(t.setFolderSizesPending({fetchFolderSizesResp:a})),e(t.completeFolderSizes({fetchFolderSizeState:o}))}}},t.applyBoltUpdates=function(e){var r=e.updates,o=e.setPath;return function(e,s){var n=r.parent_changes,a=h.user(s());if(n&&n.change_to_fq_path)return u.showUserNotificationForPathChange(a,n),void t.setUrl({path:n.change_to_fq_path})(e,s,I.mockExtraArguments);R(e,s,r,o),D(e,s,r)}};var L=function(e){var r=e.unsortedFiles;return function(e,s){var n=h.filePathsToSelectOnNextUpdate(s()).filter(function(e){return r.has(e)}).toArray();0!==n.length&&(e(t.selectFilesByFqPath({fqPathsToSelect:n})),n.length===h.filePathsToSelectOnNextUpdate(s()).size&&e(t.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set()})))}};t.setIsSearchMode=function(e){var t=e.isSearchMode;return{type:f.ActionTypes.SET_IS_SEARCH_MODE,payload:{isSearchMode:t}}},t.appendFiles=function(e){var r=e.path,s=e.files;return function(e,n){if(a.paths_are_equal(r,h.path(n()))){var l=h.unsortedFiles(n()).size,c=h.unsortedFiles(n()).merge(o.Map(s.map(function(e){return[e.fq_path,e]})));t.setUnsortedFiles({unsortedFiles:c})(e,n,I.mockExtraArguments),L({unsortedFiles:c})(e,n,I.mockExtraArguments),setTimeout(function(){i.Dispatcher.dispatch({type:d.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:r,files:s}})},1),c.size!==l+s.length&&T.reportException({err:new Error("appendFiles ended up with unexpected number of files."),tags:["browse_file_collections_mismatch"],severity:T.SEVERITY.CRITICAL,exc_extra:{previous_unsorted_files_size:l,incoming_files_size:s.length,updated_unsorted_files_size:c.size,is_deleted_files_on:h.shouldShowDeletedFiles(n())}})}}},t.clearFiles=function(e){var r=e.path,s=e.context;return function(e,n){a.paths_are_equal(r,h.path(n()))&&(t.setUnsortedFiles({unsortedFiles:o.Map()})(e,n,I.mockExtraArguments),e(t.setSelection({selection:g.createSelection()})),e(t.setPaginatedTotalNumFiles({paginatedTotalNumFiles:0})),e(t.setContext({context:s})))}}}),define("modules/clean/react/browse/data/helpers",["require","exports","tslib","external/lodash","modules/clean/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/snackbar","modules/core/i18n"],function(e,t,r,o,s,n,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),n=r.__importStar(n),t.showUserNotificationForPathChange=function(e,t){function r(e){return o.escape(s.filename(e))}function n(e){a.Snackbar.complete(e)}function l(e){a.Snackbar.fail(e)}switch(null!=t.change_type?t.change_type.toLowerCase():null){case"moved":n(i._("This folder has been moved"));break;case"renamed":n(i._("This folder has been renamed to “%(folder_name)s”").format({folder_name:r(t.change_to_fq_path)}));break;case"deleted":l(i._("The folder “%(folder_name)s” has been deleted").format({folder_name:r(t.old_fq_path)}))}},t.getMountPointUpdateForCurrentPath=function(e,t,r){var s,n,a=function(e){return t===e};return r&&r.find(a)?(n=r.find(a)||null,s=e[r.findKey(a)]||null):(n=null,s=o.find(e,a)||null),[n,s]},t.getPathForNewMountPoint=function(e,t,r){return e&&!t?r:e&&t?s.paths_are_equal(e,t)?null:t:!e&&t?r:null},t.getIndexOfFile=function(e,t){return n.sortedFiles(t).findIndex(function(t){return t.sjid===e.sjid&&t.ns_id===e.ns_id})}}),define("modules/clean/react/browse/data/reducer",["require","exports","tslib","external/immutable","modules/clean/filepath","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/files_view/types","modules/clean/react/selection","modules/core/exception"],function(e,t,r,o,s,n,a,i,l,c){"use strict";function d(e,t){var o=t.payload,s=o.experiments,n=o.shouldShowDeletedFiles,a=o.user,i=o.viewer;return c.assert(null===e.user,"Cannot reinitialize Browse store; changing invariants such as `user` is untested"),r.__assign({},e,{experiments:s,shouldShowDeletedFiles:n,user:a,viewer:i})}function u(e,t){var s=t.payload.fqPathsToSelect,n=s.map(function(e){return e.toLowerCase()}),a=e.unsortedFiles.toList().filter(function(e){return n.includes(e.fq_path.toLowerCase())}),i=a.map(function(e){return e.fq_path}),l=o.OrderedSet(i),c=i.size?i.get(0):null;return r.__assign({},e,{selection:e.selection.set("selected",l).set("anchor",c)})}function p(e,t){var o=t.payload.canDisplayFolderSizes;return r.__assign({},e,{canDisplayFolderSizes:o})}function h(e,t){var o=t.payload.clipboardFiles;return r.__assign({},e,{clipboardFiles:o})}function f(e,t){var o=t.payload.context;return r.__assign({},e,{context:o})}function m(e,t){var o=t.payload.fileJumpFilter;return r.__assign({},e,{fileJumpFilter:o})}function _(e,t){var o=t.payload.filePathsToSelectOnNextUpdate;return r.__assign({},e,{filePathsToSelectOnNextUpdate:o})}function S(e,t){var o=t.payload,s=o.file,n=o.renameState;return n?r.__assign({},e,{fileRename:{file:s,state:n}}):r.__assign({},e,{fileRename:null})}function g(e,t){var o=t.payload.folderSizes;return r.__assign({},e,{folderSizes:o})}function E(e,t){var n=t.payload,a=n.loadingState,l=n.path;return s.paths_are_equal(l,e.path)?a===i.LoadingState.LOADED?r.__assign({},e,{loadingState:a,filePathsToSelectOnNextUpdate:o.Set()}):r.__assign({},e,{loadingState:a}):e}function v(e,t){var s=t.payload.mountPoints;return r.__assign({},e,{mountPoints:o.Map(s)})}function w(e,t){var o=t.payload.newFolderCreationState;return r.__assign({},e,{newFolderCreationState:o})}function F(e,t){var o=t.payload.paginatedTotalNumFiles;return r.__assign({},e,{paginatedTotalNumFiles:o})}function T(e,t){var o=t.payload.path;return r.__assign({},e,{path:o})}function b(e,t){var o=t.payload.selection;return r.__assign({},e,{selection:o})}function y(e,t){var o=t.payload.shouldShowDeletedFiles;return r.__assign({},e,{shouldShowDeletedFiles:o})}function C(e,t){var o=t.payload.sortOrder;return r.__assign({},e,{sortOrder:o})}function I(e,t){var o=t.payload.unsortedFiles;return r.__assign({},e,{unsortedFiles:o})}function R(e,t){var o=t.payload.browsePostTTIExperiments;return r.__assign({},e,{browsePostTTIExperiments:o})}function D(e,t){var o=t.payload.fqPath;if(e.isQueryingFolderSizes)return e;var s=e.folderSizes.withMutations(function(e){e.set(o,{size:0,state:i.FetchFolderSizeState.LOADING})});return r.__assign({},e,{folderSizes:s,isQueryingFolderSizes:!0})}function N(e,t){var o=t.payload.fetchFolderSizesResp,s=e.currentFolderSizesQuery,n=e.folderSizes.withMutations(function(t){for(var r=function(r){t.update(r.fq_path,{size:0,state:i.FetchFolderSizeState.LOADING},function(t){return{size:!e.browsePostTTIExperiments||"CTX"!==e.browsePostTTIExperiments.expFolderCalcSize&&"AUTO"!==e.browsePostTTIExperiments.expFolderCalcSize?t.size+r.size:r.size,state:i.FetchFolderSizeState.LOADING}}),s=s.withMutations(function(e){return e.add(r.fq_path)})},n=0,a=o.sizes_dict;n<a.length;n++){r(a[n])}});return r.__assign({},e,{currentFolderSizesQuery:s,folderSizes:n})}function P(e,t){var s=t.payload.fetchFolderSizeState,n=e.folderSizes.withMutations(function(t){e.currentFolderSizesQuery.forEach(function(r){var o=e.folderSizes.get(r);o&&t.update(r,function(){return{size:o.size,state:s}})})});return r.__assign({},e,{currentFolderSizesQuery:o.Set(),folderSizes:n,isQueryingFolderSizes:!1})}function A(e,t){return r.__assign({},e,{isTimelineVisible:!0})}function O(e,t){return r.__assign({},e,{isTimelineVisible:!1})}function L(e,t){var o=t.payload.isSearchMode;return r.__assign({},e,{isSearchMode:o})}function x(e,r){switch(void 0===e&&(e=t.defaultBrowseState),r.type){case n.ActionTypes.APP_INIT:return d(e,r);case n.ActionTypes.SELECT_FILES_BY_FQ_PATH:return u(e,r);case n.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES:return p(e,r);case n.ActionTypes.SET_CLIPBOARD_FILES:return h(e,r);case n.ActionTypes.SET_CONTEXT:return f(e,r);case n.ActionTypes.SET_FILE_JUMP_FILTER:return m(e,r);case n.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:return _(e,r);case n.ActionTypes.SET_FILE_RENAME:return S(e,r);case n.ActionTypes.SET_FOLDER_SIZES:return g(e,r);case n.ActionTypes.SET_LOADING_STATE:return E(e,r);case n.ActionTypes.SET_MOUNT_POINTS:return v(e,r);case n.ActionTypes.SET_NEW_FOLDER_CREATION_STATE:return w(e,r);case n.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES:return F(e,r);case n.ActionTypes.SET_PATH:return T(e,r);case n.ActionTypes.SET_SELECTION:return b(e,r);case n.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES:return y(e,r);case n.ActionTypes.SET_SORT_ORDER:return C(e,r);case n.ActionTypes.SET_UNSORTED_FILES:return I(e,r);case n.ActionTypes.SHOW_TIMELINE:return A(e,r);case n.ActionTypes.HIDE_TIMELINE:return O(e,r);case n.ActionTypes.REQUEST_FOLDER_SIZES:return D(e,r);case n.ActionTypes.SET_FOLDER_SIZES_PENDING:return N(e,r);case n.ActionTypes.COMPLETE_FOLDER_SIZES:return P(e,r);case n.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS:return R(e,r);case n.ActionTypes.SET_IS_SEARCH_MODE:return L(e,r)}return e}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),t.defaultBrowseState={canDisplayFolderSizes:!1,clipboardFiles:[],context:new a.BrowseContext,experiments:{},browsePostTTIExperiments:{},fileJumpFilter:"",filePathsToSelectOnNextUpdate:o.Set(),fileRename:null,folderSizes:o.Map(),isTimelineVisible:!1,loadingState:i.LoadingState.LOADING_FIRST_PAGE,mountPoints:null,newFolderCreationState:i.NewFolderCreationState.CREATE_FOLDER_INACTIVE,paginatedTotalNumFiles:0,path:"",selection:l.createSelection(),shouldShowDeletedFiles:!1,sortOrder:{sortField:i.SortField.FILENAME,sortDirection:i.SortDirection.ASCENDING},user:null,unsortedFiles:o.Map(),viewer:null,currentFolderSizesQuery:o.Set(),isQueryingFolderSizes:!1,isSearchMode:!1},t.browseReducer=x}),define("modules/clean/react/browse/data/selectors",["require","exports","tslib","external/immutable","external/reselect","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/data/reducer","modules/clean/react/browse/uri_helper","modules/clean/react/browse/util","modules/clean/react/files_view/types","modules/clean/redux/selectors","modules/clean/redux/types","modules/core/browser_detection","modules/core/exception","modules/clean/react/files_view/data/selectors","modules/clean/react/folder_overview/data/selectors"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),h=r.__importStar(h),_=r.__importStar(_);var S=function(e){return u.getStateAtNamespace(e,p.BROWSE_NAMESPACE_KEY)||i.defaultBrowseState};t.canDisplayFolderSizes=function(e){return S(e).canDisplayFolderSizes},t.clipboardFiles=function(e){return S(e).clipboardFiles},t.context=function(e){return S(e).context},t.experiments=function(e){return S(e).experiments},t.postTTIExperiments=function(e){return S(e).browsePostTTIExperiments},t.fileJumpFilter=function(e){return S(e).fileJumpFilter},t.filePathsToSelectOnNextUpdate=function(e){return S(e).filePathsToSelectOnNextUpdate},t.fileRename=function(e){return S(e).fileRename},t.folderSizes=function(e){return S(e).folderSizes},t.isFileJumping=function(e){return S(e).fileJumpFilter.length>0},t.isQueryingFolderSizes=function(e){return S(e).isQueryingFolderSizes};var g=function(e){return S(e).loadingState};t.mountPoints=function(e){return S(e).mountPoints},t.newFolderCreationState=function(e){return S(e).newFolderCreationState},t.paginatedTotalNumFiles=function(e){return t.loadingState(e)===d.LoadingState.LOADED?t.sortedFiles(e).count():S(e).paginatedTotalNumFiles},t.path=function(e){return S(e).path},t.selection=function(e){return S(e).selection},t.shouldShowDeletedFiles=function(e){return S(e).shouldShowDeletedFiles},t.sortOrder=function(e){return S(e).sortOrder},t.unsortedFiles=function(e){return S(e).unsortedFiles},t.user=function(e){var t=S(e).user;return f.assert(null!=t,"Browse store `user` accessed before APP_INIT action"),t},t.viewer=function(e){var t=S(e).viewer;return f.assert(null!=t,"Browse store `viewer` accessed before APP_INIT action"),t},t.isTimelineVisible=function(e){return S(e).isTimelineVisible},t.browsePostTTIExperiments=function(e){return S(e).browsePostTTIExperiments||{}},t.fileJumpIndex=s.createSelector(t.unsortedFiles,function(e){return e.keySeq().toArray().map(function(e){return{filename:n.filename(e).toLowerCase(),fqPath:e}}).sort(function(e,t){return e.filename<t.filename?-1:e.filename>t.filename?1:0})}),t.sortedFiles=s.createSelector(t.unsortedFiles,t.sortOrder,t.folderSizes,function(e,t,r){return c.sortFiles(e.toList(),t,r,h.mac)}),t.selectedFiles=s.createSelector(t.sortedFiles,t.selection,function(e,t){if(t.selected.isEmpty()||e.isEmpty())return o.OrderedMap();var r=e.filter(function(e){return t.selected.has(e.fq_path)});return o.OrderedMap(r.map(function(e){return[e.fq_path,e]}))}),t.urlPrefix=s.createSelector(t.user,t.viewer,function(e,t){return l.browse_root(t,e)}),t.teamFolders=s.createSelector(t.unsortedFiles,t.folderSizes,function(e,t){var r={sortField:d.SortField.FILENAME,sortDirection:d.SortDirection.ASCENDING};return c.sortFiles(e.toList().filter(function(e){return e.type===a.FileTypes.TEAM_SHARED_FOLDER}),r,t,h.mac)}),t.sortedFilesWithFolderSizes=s.createSelector(t.sortedFiles,t.folderSizes,function(e,t){return e.map(function(e){var r=t.get(e.fq_path);return r?e.updateSize(r.size,r.state):e})}),t.unsortedFilesWithFolderSizes=s.createSelector(t.unsortedFiles,t.folderSizes,function(e,t){return e.withMutations(function(r){t.forEach(function(t,o){var s=e.get(o);if(s&&t){var n=s.updateSize(t.size,t.state);r.set(o,n)}})})}),t.sortedFilesWithFoldersSizesWithoutTeamFolders=s.createSelector(t.sortedFilesWithFolderSizes,function(e){return e.filter(function(e){return e.type!==a.FileTypes.TEAM_SHARED_FOLDER})}),t.shouldShowFolderOverview=s.createSelector(t.path,t.experiments,function(e,t){return"V1"===t.expFolderOverview&&!n.paths_are_equal(e,"/")}),t.loadingState=s.createSelector(g,t.shouldShowFolderOverview,_.haveAllComponentsLoaded,_.hasFailedToLoad,function(e,t,r,o){
return!t||o?e:r?e:d.LoadingState.LOADING_FIRST_PAGE}),t.shouldShowPinnedTeamFolders=s.createSelector(t.context,t.loadingState,t.path,t.teamFolders,m.viewType,function(e,t,r,o,s){return e.showPinnedTeamFolder&&!o.isEmpty()&&n.paths_are_equal(r,"/")&&s===d.ViewType.List&&(t===d.LoadingState.LOADED||t===d.LoadingState.LOADING_REMAINING_PAGES)}),t.isSearchMode=function(e){return S(e).isSearchMode},t.shouldShowSharedFolderInvites=s.createSelector(t.browsePostTTIExperiments,t.path,function(e,t){return!!e.expShowSharedFolderInvites&&n.paths_are_equal(t,"/")})}),define("modules/clean/react/browse/data/store",["require","exports","modules/clean/redux/types","modules/clean/react/browse/data/reducer","modules/clean/redux/store"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;t.getStoreForBrowse=function(){return n||(n=s.getStoreAndRegisterReducers((e={},e[r.BROWSE_NAMESPACE_KEY]=o.browseReducer,e))),n;var e}}),define("modules/clean/react/browse/global_actions",["require","exports","tslib","external/lodash","react","modules/clean/analytics","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/new_file_menu","modules/clean/filepath","modules/clean/react/browse/action_logger","modules/clean/react/async_onboarding_move_modal","modules/clean/react/browse/actions","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/store","modules/clean/react/browse/nav_actions","modules/clean/react/modal","modules/clean/sharing/access_level","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/viewer","modules/core/browser_detection","modules/core/exception","modules/core/i18n","modules/core/notify","modules/clean/user_education/user_education_client"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S,g,E,v,w,F,T,b){"use strict";function y(e){var t=(e.arePostTTIModulesLoaded,e.context),r=e.user,l=e.viewType,c=e.showDeletedFiles,u=e.onUpload,p=void 0===u?o.noop:u,h=e.isNoComment,f=void 0!==h&&h,_=e.autoTeamGroupId,g=(e.browseExperiments,e.browsePostTTIExperiments),w=t.isCurrentlyInRoot,F=!t.canViewContainingNSMembers,T=t.isCurrentPathWriteable(),y=v.is_input_webkitdirectory_supported(),I={action:{className:"action-upload",label:D(C.UploadFiles),popoverLabel:D(C.Files),iconName:y?"upload-file":"upload",performAction:function(){return p(!1)},disabled:!T},isPrimary:!1},R=y?{action:{className:"action-upload",label:D(C.UploadFolder),popoverLabel:D(C.Folder),iconName:"upload-folder",performAction:function(){return p(!0)},disabled:!T},isPrimary:!1}:void 0,U=!t.isInsideSandboxFolder,k=g.expTimeline,B=g.expEnableCloudDocsPaperCreate,q=g.expEnableCloudDocsGddCreate,V=g.expEnableCloudDocsFileCreatePrimaryInFolder,H={action:function(){return s.default.createElement(i.NewFileMenu,{key:"new-file-menu",user:r,source:a.NewFileMenuFromType.BROWSE,path:t.currentFQPath,disabled:!T,showGdd:!!q,showPaper:!!B,primaryButton:!1})},isPrimary:!1},W={action:function(){return s.default.createElement(i.NewFileMenu,{key:"new-file-menu",user:r,source:a.NewFileMenuFromType.BROWSE,path:t.currentFQPath,disabled:!T,showGdd:!!q,showPaper:!!B,primaryButton:!0})},isPrimary:!0},z=[];if(t.isInsideTeamFolderTree||!t.isInsideDeletedSharedFolder&&!t.isInsideDeletedNestedSharedFolder)if(t.isInsideDeletedFolder)z.push({action:{label:D(C.RestoreFolder),iconName:"restore",className:"action-restore",performAction:L(r,l,t),disabled:!T},isPrimary:!0});else{var G={label:D(C.NewFolder),iconName:"new-folder",performAction:N(r,l,t,_,g.expSubgrowthProOQNewFolder,g.expNewFolderModal),disabled:!T,className:"action-new-folder"},j={action:G,isPrimary:!1},Q={label:D(w?C.NewSharedFolder:C.ShareFolder),iconName:"new-shared-folder",performAction:A(r,t,g.expSubgrowthProOQNewFolder),disabled:F,className:"action-share-folder"},K={action:Q,isPrimary:!0},Y={action:Q,isPrimary:!1},J={action:{label:D(C.NewTeamFolder),iconName:"new-team-folder",performAction:M(r,t),disabled:!1,className:"action-team-folder"},isPrimary:!1};if(r.is_cdm_member&&"/"===t.currentFQPath){b.UEClient.registerBulkCallbackForEducationStep([{moduleName:"trial_admin_setup_team_space",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_mobile",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_mobile_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_folder_structure",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_folder_structure_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_free_order",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_free_order_v2",stepName:"team_folder_modal"}],G.performAction);var X=function(e){n.TeamsWebActionsLogger.log(e),window.setTimeout(function(){b.UEClient.sendEvent("SetStructureModal","Close")},2500),m.Modal.close()};b.UEClient.registerBulkCallbackForEducationStep([{moduleName:"trial_admin_shared_workspace",stepName:"set_structure_modal"},{moduleName:"trial_admin_shared_workspace_v2",stepName:"set_structure_modal"},{moduleName:"trial_admin_shared_workspace_free_order",stepName:"set_structure_modal"},{moduleName:"trial_admin_shared_workspace_free_order_v2",stepName:"set_structure_modal"}],function(){var e={user:r,teamName:E.Viewer.get_viewer().team_name,onSuccess:function(){return X("uj_ss_modal_success")},onError:function(){return X("uj_ss_modal_error")},onCancel:function(){return X("uj_ss_modal_cancel")}};d.showOnboardingMoveDialog(e)}),z.push(W),z.push(I),y&&z.push(R),z.push(j)}else w?(z.push(W),z.push(I),y&&z.push(R),!r.is_cdm_member&&S.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&z.push(J),z.push(Y,j)):(U?(V&&z.push(W),z.push(K)):z.push(W),z.push(I),y&&z.push(R),z.push(j),U&&!V&&z.push(H));f||z.push({action:{label:D(c?C.HideDeletedFiles:C.ShowDeletedFiles),iconName:c?"hide":"show-deleted-files",performAction:O(r,l,c),disabled:F,className:"action-deleted-files"},isPrimary:!1}),!E.Viewer.get_viewer().is_assume_user_session&&(S.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&S.GoldenGate.hasNewOwnershipModel(r.id)&&t.isInsideTeamFolderTree||!r.is_cdm_member&&S.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&t.isCurrentlyInRoot)&&z.push({action:{label:D(C.ManageAsAdmin),iconName:"settings-gear",performAction:M(r,t)},isPrimary:!1}),k&&z.push({action:{label:D(C.FolderHistory),iconName:"view-folder-history",performAction:P(r,t)},isPrimary:!1})}else z.push({action:{label:D(C.ReAddSharedFolder),iconName:"restore",performAction:x(r,t),disabled:!T},isPrimary:!0});return z}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importDefault(s),l=r.__importStar(l),p=r.__importStar(p),v=r.__importStar(v);var C;(function(e){e[e.UploadFiles=1]="UploadFiles",e[e.UploadFolder=2]="UploadFolder",e[e.Upload=3]="Upload",e[e.Files=4]="Files",e[e.Folder=5]="Folder",e[e.NewPaperDoc=6]="NewPaperDoc",e[e.NewFolder=7]="NewFolder",e[e.RestoreFolder=8]="RestoreFolder",e[e.ReAddSharedFolder=9]="ReAddSharedFolder",e[e.ShowDeletedFiles=10]="ShowDeletedFiles",e[e.HideDeletedFiles=11]="HideDeletedFiles",e[e.NewSharedFolder=12]="NewSharedFolder",e[e.ShareFolder=13]="ShareFolder",e[e.ManageAsAdmin=14]="ManageAsAdmin",e[e.NewTeamFolder=15]="NewTeamFolder",e[e.FolderHistory=16]="FolderHistory"})(C||(C={}));var I={},R=function(e){switch(e){case C.UploadFiles:return F._("Upload files");case C.UploadFolder:return F._("Upload folder");case C.Upload:return F._("Upload");case C.FolderHistory:return F._("Folder history");case C.Files:return F._("Files");case C.Folder:return F._("Folder");case C.NewPaperDoc:return F._("New Paper Document");case C.NewFolder:return F._("New folder");case C.RestoreFolder:return F._("Restore folder");case C.ReAddSharedFolder:return F._("Re-add shared folder");case C.ShowDeletedFiles:return F._("Show deleted files");case C.HideDeletedFiles:return F._("Hide deleted files");case C.NewSharedFolder:return F._("New shared folder");case C.ShareFolder:return F._("Share folder");case C.ManageAsAdmin:return F._("View in admin console");case C.NewTeamFolder:return F._("New team folder")}},D=function(e){return e in I||(I[e]=R(e)),I[e]},N=function(t,o,s,n,a,i){return function(){if("V1"===a)new Promise(function(t,r){e(["modules/clean/growth/experiments/overquota_helper"],t,r)}).then(r.__importStar).then(function(e){e.OverquotaHelper.showSubgrowthProOQNewFolderModal({oqa:"wb_oq_ad_fo_fi"})});else{var d=s.currentNSID,p=s.currentFQPath;if(c.logCreateFolder({uid:t.id,view_type:o,file_nsid:d,file_path:p,file_name:l.filename(p)}),t.is_cdm_member&&"/"===p){w.assert(!!n,"All CDM Users should have an auto team group in their team");var h=function(e){T.Notify.error(e?e:F._("There was a problem completing this request.")),u.browseActions.cancelCreateFolder()},m=function(e){var t=e.user,r=e.folderName,o=e.fqPath;u.browseActions.createFolderComplete({user:t,folderName:r,changesets:null}),u.browseActions.selectFilesByFqPath({fqPathsToSelect:[o]}),i&&u.browseActions.handleNewFolderRedirectOnSuccess(o)};S.asyncShowAppropriateNewFolderModalForCdmUser({user:t,context:s,autoTeamGroupId:n,showFileSystemWarningsModal:void 0,onPending:u.browseActions.createFolderPending,onComplete:m,onCancel:h,autoTeamGroupDefaultAccessLevel:_.ACCESS_LEVEL.WRITER,setPath:f.browseNavActions.setPath,setUrl:f.browseNavActions.setUrl})}else if(i){var g=function(e){var r=e.folderName,o=e.isConfidential;u.browseActions.createFolderInNewFolderModal({folderName:r,isConfidential:o,user:t,context:s,redirectOnSuccess:u.browseActions.handleNewFolderRedirectOnSuccess})};S.asyncShowCdmNewFolderModal(g,t,s,!1,!1,!0)}else u.browseActions.nameNewFolder();"CONTROL"===a&&new Promise(function(t,r){e(["modules/clean/growth/experiments/overquota_helper"],t,r)}).then(r.__importStar).then(function(e){e.OverquotaHelper.logExposureSubgrowthProOQNewFolderModal("CONTROL")})}}},P=function(e,t){return function(){h.getStoreForBrowse().dispatch(p.showTimeline())}},A=function(t,o,s){return function(){"V1"===s?new Promise(function(t,r){e(["modules/clean/growth/experiments/overquota_helper"],t,r)}).then(r.__importStar).then(function(e){e.OverquotaHelper.showSubgrowthProOQNewFolderModal({oqa:"wb_oq_ad_shfo_fi"})}):o.isCurrentlyInRoot?S.asyncShowShareAFolderWizardModal(t):S.asyncShowShareModal(t,o,{origin:g.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS},f.browseNavActions.setPath,f.browseNavActions.setUrl),"CONTROL"===s&&new Promise(function(t,r){e(["modules/clean/growth/experiments/overquota_helper"],t,r)}).then(r.__importStar).then(function(e){e.OverquotaHelper.logExposureSubgrowthProOQNewFolderModal("CONTROL")})}},O=function(e,t,r){return function(){c.logToggleDeletedFiles({uid:e.id,show_deleted_files:!r,view_type:t}),u.browseActions.setShouldShowDeletedFiles({shouldShowDeletedFiles:!r})}},L=function(e,t,r){return function(){var o=r.currentNSID,s=r.currentFQPath;c.logRestore({uid:e.id,view_type:t,file_nsid:o,file_path:s,file_name:l.filename(s),num_files_selected:0,num_folders_selected:1}),u.browseActions.doRestoreFilesWithUnifiedTrashModal({})}},x=function(e,t){return function(){var r=t.currentFQPath.toLowerCase(),o=t.inactiveNSIDByFQPath[r],s=t.isInsideDeletedNestedSharedFolder;o&&S.asyncMountSharedFolder(o,e.role,g.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS,!1,null,s)}},M=function(e,t){return function(){S.asyncGoToContentManagerForPath({isLimitedTeam:E.Viewer.get_viewer().team_is_limited,containingFolder:t.currentFQPath,isCDM:e.is_cdm_member})}};t.getGlobalActions=y}),define("modules/clean/react/browse/nav_actions",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/store","modules/clean/react/file_uploader/constants","modules/clean/react/files_view/types"],function(e,t,r,o,s,n,a,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n);var c=(function(){function e(){this.setPath=function(e){var t=e.path;a.getStoreForBrowse().dispatch(n.setUrl({path:t}))}}return e.prototype.setUrl=function(e){var t=e.path,r=e.qargs;a.getStoreForBrowse().dispatch(n.setUrl({path:t,qargs:r}))},e.prototype.loadPath=function(e){var t=e.path,r=e.files,c=e.paginatedTotalNumFiles,d=e.context;a.getStoreForBrowse().dispatch(n.setPathData({path:t,files:r,paginatedTotalNumFiles:c,context:d})),a.getStoreForBrowse().dispatch(n.setFetchFolderSizeState({files:r,state:l.FetchFolderSizeState.COMPLETE})),a.getStoreForBrowse().dispatch(n.setLoadingState({loadingState:l.LoadingState.LOADED,path:t})),o.Dispatcher.dispatch({type:i.UploaderActionType.SET_PATH,data:{path:t,hasPermissionToUploadToFolder:d.isCurrentPathWriteable()}}),o.Dispatcher.dispatch({type:s.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:r}})},e})();t.BrowseNavActions=c,t.browseNavActions=new c}),define("modules/clean/react/browse/professional_collection_actions",["require","exports","tslib","external/lodash","modules/core/exception"],function(e,t,r,o,s){"use strict";function n(t,n,a){var i=o.keyBy(a,"file_id");if(!o.every(t,function(e){return!!i[e]}))return void s.reportException({err:new Error("Could not find specified files to add to Showcase")});var l=t.map(function(e){var t=i[e];return{ns_id:t.ns_id,ns_path:t.ns_path,fq_path:t.fq_path}});new Promise(function(t,r){e(["modules/clean/react/professional_collection/add_to_collection_modal_controller"],t,r)}).then(r.__importStar).then(function(e){(0,e.showAddToCollectionModal)(l,n)})}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.showPrepopulatedAddToCollectionModal=n}),define("modules/clean/react/browse/sidebar",["require","exports","tslib","react","modules/clean/search/search_results/sidebar_view","modules/clean/react/browse/sidebar_view"],function(e,t,r,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.BrowseSidebar=function(e){var t=e.autoTeamGroupId,a=e.arePostTTIModulesLoaded,i=e.canDisplayFolderSizes,l=e.context,c=e.handleComponentTTI,d=e.isNoComment,u=e.isSearchMode,p=e.isTimelineVisible,h=e.selectedFiles,f=e.shouldShowDeletedFiles,m=e.starredState,_=e.user,S=e.viewType,g=e.uploaderExperiments,E=e.uploaderPostTTIExperiments,v=e.browseExperiments,w=e.browsePostTTIExperiments,F=e.uploadAjaxInterceptor,T=e.searchBarExperiments,b=e.actionHandlers,y=e.path,C=e.onSearch,I=e.onUploadButtonClick,R=e.onGetFileActionsForFiles,D=e.responsive,N=e.onSearchFiltersChanged,P=e.fileCategories,A=e.isNautilusEnabled,O=e.isPaperEnabled,L=e.fileExtensionsConfigs,x=e.pinnedItems,M={user:_,selectedFiles:h,arePostTTIModulesLoaded:a,context:l,viewType:S,shouldShowDeletedFiles:f,responsive:D};return u?o.default.createElement(s.SearchResultsSidebarView,r.__assign({},M,{path:y,actionHandlers:b,searchBarExperiments:T,onSearch:C,onSearchFiltersChanged:N,fileCategories:P,isNautilusEnabled:A,isPaperEnabled:O,fileExtensionsConfigs:L})):o.default.createElement(n.BrowseSidebarView,r.__assign({},M,{isTimelineVisible:p,autoTeamGroupId:t,canDisplayFolderSizes:i,uploaderExperiments:g,uploaderPostTTIExperiments:E,browseExperiments:v,browsePostTTIExperiments:w,handleComponentTTI:c,onUploadButtonClick:I,isNoComment:d,onGetFileActionsForFiles:R,starredState:m,uploadAjaxInterceptor:F,pinnedItems:x}))}}),define("modules/clean/react/browse/sidebar_view",["require","exports","tslib","react","modules/clean/react/app_actions_view","modules/clean/react/browse/global_actions","modules/clean/react/browse/util","modules/clean/react/file_uploader/file_uploader","modules/core/i18n"],function(e,t,r,o,s,n,a,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var c=(function(t){function c(e){var r=t.call(this,e)||this;return r.state={appActionsProps:r.getCurrentAppActionsProps(r.props)},r}return r.__extends(c,t),c.prototype.componentWillReceiveProps=function(e){e.selectedFiles===this.props.selectedFiles&&e.context===this.props.context&&e.user===this.props.user&&e.shouldShowDeletedFiles===this.props.shouldShowDeletedFiles&&e.isNoComment===this.props.isNoComment&&e.arePostTTIModulesLoaded===this.props.arePostTTIModulesLoaded&&e.viewType===this.props.viewType&&e.starredState===this.props.starredState&&e.canDisplayFolderSizes===this.props.canDisplayFolderSizes&&e.uploadAjaxInterceptor===this.props.uploadAjaxInterceptor&&e.responsive.isMatchedMedium===this.props.responsive.isMatchedMedium&&e.responsive.isMatchedLarge===this.props.responsive.isMatchedLarge&&e.uploaderExperiments===this.props.uploaderExperiments&&e.uploaderPostTTIExperiments===this.props.uploaderPostTTIExperiments&&e.browseExperiments===this.props.browseExperiments&&e.browsePostTTIExperiments===this.props.browsePostTTIExperiments&&e.pinnedItems===this.props.pinnedItems||this.setState({appActionsProps:this.getCurrentAppActionsProps(e)})},c.prototype.renderSingleSelectionAudienceBox=function(t){var r=t.selectedFiles,s=t.arePostTTIModulesLoaded,n=t.context,a=t.user,i=r.first();if(s){var l=e("modules/clean/react/browse/shared_with").SharedWithController;return o.default.createElement(l,{file:i,browseContext:n,user:a,isInAudienceBox:!0})}return null},c.prototype.getCurrentAppActionsProps=function(t){function r(e){return"function"==typeof e?e:{displayName:e.label,popoverMenuName:e.popoverLabel,iconName:e.iconName,handleClick:e.performAction,disabled:e.disabled,className:e.className,badge:e.badge}}function s(e){if("function"==typeof e)return e;var t=void 0;return e.subItems&&(t=e.subItems.map(r)),{displayName:e.label,iconName:e.iconName,handleClick:e.performAction,disabled:e.disabled,className:e.className,subItems:t}}var i,c=t.selectedFiles,d=t.autoTeamGroupId,u=t.context,p=t.canDisplayFolderSizes,h=t.onGetFileActionsForFiles,f=t.user,m=t.viewType,_=t.shouldShowDeletedFiles,S=t.onUploadButtonClick,g=t.isNoComment,E=t.browseExperiments,v=t.browsePostTTIExperiments,w=t.arePostTTIModulesLoaded,F=t.handleComponentTTI,T=t.responsive,b=a.getSelectedFilesText(c,u),y=c.count(),C=o.default.createElement("div",null);if(y>0){i=h(c,p,T,!0,!0).map(function(e,t){return{action:e,isPrimary:0===t}}),1===y&&(C=this.renderSingleSelectionAudienceBox(t))}else if(i=n.getGlobalActions({arePostTTIModulesLoaded:w,context:u,user:f,viewType:m,showDeletedFiles:_,onUpload:S,isNoComment:g,autoTeamGroupId:d,browseExperiments:E,browsePostTTIExperiments:v}),w){var I=e("modules/clean/react/browse/shared_with").SharedWithController;C=o.default.createElement(I,{browseContext:u,user:f,isInAudienceBox:!0})}for(var R=[],D=[],N=0,P=i;N<P.length;N++){var A=P[N];A.isPrimary?R.push(s(A.action)):D.push(r(A.action))}return t.isNoComment&&(C=o.default.createElement("div",null)),{headerText:b,popoverTriggerLabel:l._("Actions"),primaryMenuItems:R,primarySubnode:C,secondaryMenuItems:D,handleComponentTTI:F}},c.prototype.maybeRenderBrowseFileUploader=function(){var e=this.props,t=e.context,r=e.viewType,s=e.uploadAjaxInterceptor,n=e.uploaderExperiments,a=e.uploaderPostTTIExperiments;return null!=t.currentFQPath?o.default.createElement(i.FileUploaderController,{key:"file-uploader-controller",ref:"fileUploader",loadOnRender:!1,needToSetStoreValues:!1,ajaxInterceptor:s,uploaderExperiments:n,uploaderPostTTIExperiments:a,browseViewType:r}):null},c.prototype.render=function(){return o.default.createElement("div",{className:"maestro-browse-action-sidebar"},this.maybeRenderBrowseFileUploader(),o.default.createElement(s.AppActionsView,r.__assign({},this.state.appActionsProps,{responsive:this.props.responsive})))},c})(o.default.PureComponent);t.BrowseSidebarView=c}),define("modules/clean/react/browse/title",["require","exports","tslib","react","modules/core/i18n","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/react/file_uploader/file_uploader","modules/clean/viewer","modules/clean/react/maestro/header","modules/clean/react/path_breadcrumbs"],function(e,t,r,o,s,n,a,i,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),a=r.__importStar(a);var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleGetUrlForPath=function(e){return n.browse_uri_for_fq_path(t.props.user,e).toString()},t}return r.__extends(t,e),t.setPageTitle=function(e){e&&(document.title=s._("%(folder_name)s - Dropbox").format({folder_name:a.filename(e,s._("Files"))}))},t.prototype.componentDidMount=function(){t.setPageTitle(this.props.path)},t.prototype.componentWillReceiveProps=function(e){e.path!==this.props.path&&t.setPageTitle(e.path)},t.prototype.render=function(){var e=this.props,t=e.path,r=e.user,n=e.isDraggingInternalFiles,u=e.isDraggingExternalFiles,p=e.isUploadModalOpen,h=e.isSearchMode,f=e.onSetUrl;if(h)return o.default.createElement(c.MaestroHeaderTitle,null,s._("Search results"));var m=a.filename("",l.Viewer.get_root_name(r)),_="work"===r.role?s._("Work"):s._("Personal");return o.default.createElement(d.PathBreadcrumbs,{path:t,isDraggingInternalFiles:n,setFileUploaderPath:i.FileUploaderController.setPathAndPermissions,getUrlForPath:this.handleGetUrlForPath,firstBreadcrumbName:m,firstBreadcrumbAlt:_,shouldHighlightDropTargets:n||u&&!p,setUrl:f})},t})(o.default.PureComponent);t.BrowseTitle=u}),define("modules/clean/react/browse/web_team_sharing_experiment",["require","exports","tslib","react","modules/clean/react/file_uploader/constants","modules/clean/react/async_fileops_modals","modules/clean/analytics","external/immutable","modules/clean/react/async/loadable","modules/clean/web_timing_logger"],function(e,t,r,o,s,n,a,i,l,c){"use strict";var d=this;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importStar(i);var u=l.Loadable({loader:function(){return r.__awaiter(d,void 0,void 0,function(){var t;return r.__generator(this,function(o){switch(o.label){case 0:return[4,c.waitForTTI()];case 1:return o.sent(),[4,new Promise(function(t,r){e(["modules/clean/react/web_team_sharing_modal"],t,r)}).then(r.__importStar)];case 2:return t=o.sent().WebTeamSharingModal,[2,t]}})})}}),p=(function(t){function l(e){var r=t.call(this,e)||this;return r.removeUploadListener=function(){window.removeEventListener(s.ALL_UPLOADS_COMPLETE_EVENT,r.handleUploadsComplete)},r.closeTeamSharingModal=function(){return r.setState({isWebTeamSharingModalOpen:!1})},r.openFileMoveDialog=function(){r.closeTeamSharingModal(),a.TeamsWebActionsLogger.log("post_m1_sharing_modal_clicked"),n.showMove({files:r.props.selectedFiles.toArray(),path:r.props.context.currentFQPath,user:r.props.user})},r.state={isWebTeamSharingModalOpen:!1,uploadedFiles:[],expWebSharingActive:!1},r}return r.__extends(l,t),l.prototype.componentWillReceiveProps=function(t){return r.__awaiter(this,void 0,void 0,function(){var o,n,a,i=this;return r.__generator(this,function(l){switch(l.label){case 0:return!t.browsePostTTIExperiments.expBizAddFilesTeamFolderRwls||this.handleUploadsComplete?[3,2]:[4,new Promise(function(t,r){e(["modules/clean/growth/experiments/web_sharing_helper"],t,r)}).then(r.__importStar)];case 1:o=l.sent(),n=o.logExposure,a=o.shouldShowModal,this.handleUploadsComplete=function(e){if(a(i.props.user,i.props.path)){n();var t=e.detail.files;i.setState({isWebTeamSharingModalOpen:!0,uploadedFiles:t,expWebSharingActive:!0})}},window.addEventListener(s.ALL_UPLOADS_COMPLETE_EVENT,this.handleUploadsComplete),l.label=2;case 2:return[2]}})})},l.prototype.componentWillUnmount=function(){this.handleUploadsComplete&&this.removeUploadListener()},l.prototype.render=function(){return this.state.expWebSharingActive?o.default.createElement(u,{context:this.props.context,files:this.state.uploadedFiles,handleModalClose:this.closeTeamSharingModal,handleAction:this.openFileMoveDialog,open:this.state.isWebTeamSharingModalOpen,user:this.props.user}):null},l.defaultProps={selectedFiles:i.OrderedMap()},l})(o.default.PureComponent);t.WebTeamSharingModalExperiment=p}),define("modules/clean/react/file_uploader/action_logger",["require","exports","tslib","modules/clean/filepath","modules/clean/web_upload_action_logger","modules/clean/web_user_action_logger","modules/clean/web_user_action_events","modules/core/browser"],function(e,t,r,o,s,n,a,i){"use strict";function l(e){return e&&!!e.uploadId}function c(e){return e&&!!e.batchId}function d(e){return e===a.WebUserActionLogEvent.UPLOAD_BUTTON_CLICK||e===a.WebUserActionLogEvent.ADD_MORE_FILES_CLICK||e===a.WebUserActionLogEvent.VIEW_DETAILS_CLICK||e===a.WebUserActionLogEvent.CLOSE_MODAL_CLICK||e===a.WebUserActionLogEvent.DISMISS_INLINE_STATUS||e===a.WebUserActionLogEvent.UPLOAD_CLICK||e===a.WebUserActionLogEvent.UPLOAD_FILES_CLICK||e===a.WebUserActionLogEvent.UPLOAD_FOLDER_CLICK||e===a.WebUserActionLogEvent.CANCEL_UPLOAD_CLICK}function u(e,t,a,u,p,h,f){var m={num_files:h,num_dirs:f,chooser_type:u,upload_method:p};if(l(a)){var _=a;m=r.__assign({},m,{upload_id:_.uploadId,file_size:_.size,file_extension:o.file_extension(_.name),failure_reason:_.errorType,batch_id:_.batchId,upload_destination:_.dest,current_path:i.get_pathname(),file_name:_.name})}else if(c(a)){var _=a;m=r.__assign({},m,{file_size:_.size,file_extension:o.file_extension(_.name),batch_id:_.batchId})}d(t)?n.WebUserActionLog.log(e,t,m):(t=t,m.client_timestamp=Math.round(Date.now()/1e3),s.WebUploadActionLog.log(e,t,m))}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i),t.logUploadAction=u}),define("modules/clean/react/file_uploader/constants",["require","exports","tslib","external/immutable"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);(function(e){e.ALL_UPLOADS_COMPLETE="ALL_UPLOADS_COMPLETE",e.SET_PATH="UPLOADER_SET_PATH",e.SET_FOLDER_NS_ID="UPLOADER_SET_FOLDER_NS_ID",e.SET_USER="UPLOADER_SET_USER",e.SET_NUM_DRAGGING_FILES="SET_NUM_DRAGGING_FILES",e.QUEUE_UPLOADS="QUEUE_UPLOADS",e.START_UPLOAD="START_UPLOAD",e.COMPLETE_UPLOAD="COMPLETE_UPLOAD",e.CANCEL_UPLOADS="CANCEL_UPLOADS",e.SET_CURRENT_UPLOAD_PROGRESS="SET_CURRENT_UPLOAD_PROGRESS",e.UPLOAD_ERROR="UPLOAD_ERROR",e.SET_IS_UPLOAD_MODAL_OPEN="SET_IS_UPLOAD_MODAL_OPEN",e.SET_INLINE_STATUS_SHOULD_BE_DISMISSED="SET_INLINE_STATUS_SHOULD_BE_DISMISSED",e.ADD_NEW_FAILED_FILE="ADD_NEW_FAILED_FILE",e.CONFIRM_FSW="CONFIRM_FSW",e.ADD_FILES_TO_PLU="ADD_FILES_TO_PLU",e.ADD_DIRECTORIES_TO_PLU="ADD_DIRECTORIES_TO_PLU",e.REMOVE_FILES="REMOVE_FILES",e.SET_HAS_OVERQUOTA_ERROR="SET_HAS_OVERQUOTA_ERROR"})(t.UploaderActionType||(t.UploaderActionType={}));var s;(function(e){e.PENDING="PENDING",e.UPLOADING="UPLOADING",e.COMPLETE="COMPLETE",e.CANCELLED="CANCELLED",e.FAILED="FAILED"})(s=t.FileStatusType||(t.FileStatusType={}));var n;(function(e){e.FILE_SIZE_ERROR="FILE_SIZE_ERROR",e.HTTP_ERROR="HTTP_ERROR",e.CONNECTION_ERROR="CONNECTION_ERROR",e.OVER_QUOTA_ERROR="OVER_QUOTA_ERROR",e.LOCKED_TEAM_ERROR="LOCKED_TEAM_ERROR",e.IGNORED="IGNORED",e.INVALID_EXTENSION="INVALID_EXTENSION",e.EMPTY_OR_FOLDER="EMPTY_OR_FOLDER",e.FOLDER_SAFARI="FOLDER_SAFARI",e.PACKAGE_FILE="PACKAGE_FILE",e.GENERIC="GENERIC",e.BLOCKS_MISSING_ERROR="BLOCKS_MISSING_ERROR",e.COMMIT_HTTP_ERROR="COMMIT_HTTP_ERROR",e.UPLOAD_BLOCK_ERROR="UPLOAD_BLOCK_ERROR",e.CHUNKS_NOT_ENABLED_ERROR="CHUNKS_NOT_ENABLED_ERROR",e.SERVER_RESPONSE_ERROR="SERVER_RESPONSE_ERROR",e.SERVER_TOKEN_EMPTY_ERROR="SERVER_TOKEN_EMPTY_ERROR",e.SERVER_TOKENS_MISSING_ERROR="SERVER_TOKENS_MISSING_ERROR",e.SERVER_HASH_RESPONSE_ERROR="SERVER_HASH_RESPONSE_ERROR",e.BLOCK_RUNTIME_ID_MISSING_ERROR="BLOCK_RUNTIME_ID_MISSING",e.CLIENT_HASH_EMPTY_ERROR="CLIENT_HASH_EMPTY_ERROR",e.SERVER_HASH_EMPTY_ERROR="SERVER_HASH_EMPTY_ERROR",e.HASHES_NOT_EQUAL_ERROR="HASHES_NOT_EQUAL_ERROR",e.BLOCK_INDEX_ERROR="BLOCK_INDEX_ERROR",e.BLOCK_EMPTY_ERROR="BLOCK_EMPTY_ERROR",e.BLOB_EMPTY_ERROR="BLOB_EMPTY_ERROR",e.BLOB_MISSING_ERROR="BLOB_MISSING_ERROR",e.CLIENT_HASH_DIGEST_ERROR="CLIENT_HASH_DIGEST_ERROR",e.FILE_READER_NULL_RESULT_ERROR="FILE_READER_NULL_RESULT_ERROR",e.COMMIT_READINESS_ERROR="COMMIT_READINESS_ERROR",e.UPLOAD_PRECHECK_ERROR="UPLOAD_PRECHECK_ERROR",e.UPLOAD_PRECHECK_INVALID_CHAR_ERROR="UPLOAD_PRECHECK_INVALID_CHAR_ERROR"})(n=t.UploadErrorType||(t.UploadErrorType={}));(function(e){e.NONE="NONE",e.BASIC_OVER_QUOTA="BASIC_OVER_QUOTA",e.BASIC_NEAR_QUOTA="BASIC_NEAR_QUOTA",e.LIMITED_TEAM_USER_OVER_QUOTA="LIMITED_TEAM_USER_OVER_QUOTA",e.LIMITED_TEAM_TSD_OVER_QUOTA="LIMITED_TEAM_TSD_OVER_QUOTA",e.LOCKED_TEAM_USER_OVER_QUOTA="LOCKED_TEAM_USER_OVER_QUOTA"})(t.OverQuotaStatusType||(t.OverQuotaStatusType={}));var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(o.Record({uploadId:void 0,dest:"",ns_id:null,ns_path:null,userId:null,name:"",size:0,percentUploaded:0,status:s.PENDING,errorType:n.GENERIC,errorMessage:"",batchId:void 0},"FileUpload"));t.FileUpload=a,t.UPLOAD_BEGIN_EVENT="dbxUploadBegin",t.UPLOAD_CANCEL_EVENT="dbxUploadCancel",t.UPLOAD_COMPLETE_EVENT="dbxUploadComplete",t.ALL_UPLOADS_COMPLETE_EVENT="dbxAllUploadsComplete",t.UPLOAD_ERROR_EVENT="dbxUploadError";(function(e){e[e["4mb"]=0]="4mb",e[e["8mb"]=1]="8mb"})(t.ValidChunkSizeStrings||(t.ValidChunkSizeStrings={})),t.INVALID_EXTENSIONS=["gdoc","gsheet","gslides","paper"]}),define("modules/clean/react/file_uploader/store",["require","exports","tslib","external/immutable","modules/clean/flux/base_store","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/utils","modules/core/exception"],function(e,t,r,o,s,n,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype._init=function(){this._path="/",this._hasPermissionToUploadToFolder=!0,this._folderNsId=null,this._user=null,this._fileList=o.OrderedMap(),this._currentUploadId=null,this._numDraggingFiles=0,this._isInternalTransfer=!1,this._isUploadModalOpen=!1,this._inlineStatusShouldBeDismissed=!1,this._numSecondsLeft=0,this._confirmedFSWs=[],this._confirmedFSWBatchIds=[],this._hasOverquotaError=!1,this._allUploadsComplete=!1},t.prototype.fileList=function(){return this._fileList},t.prototype.currentUpload=function(){var e=this._currentUploadId;if(!e)return null;var t=this._fileList.get(e);return t?t:null},t.prototype.uploadById=function(e){var t;return e&&(t=this._fileList.get(e)),t||void 0},t.prototype.numSecondsLeft=function(){return this._numSecondsLeft},t.prototype.isUploadCancelled=function(e){var t=this._fileList.get(e);return!!t&&t.status===n.FileStatusType.CANCELLED},t.prototype.inlineStatusShouldBeDismissed=function(){return this._inlineStatusShouldBeDismissed},t.prototype.path=function(){return this._path},t.prototype.folderNsId=function(){return this._folderNsId},t.prototype.hasPermissionToUploadToFolder=function(){return this._hasPermissionToUploadToFolder},t.prototype.user=function(){return this._user},t.prototype.nextUpload=function(){return this._fileList.find(function(e){return e.status===n.FileStatusType.PENDING})},t.prototype.numDraggingFiles=function(){return this._numDraggingFiles},t.prototype.isInternalTransfer=function(){return this._isInternalTransfer},t.prototype.isUploadModalOpen=function(){return this._isUploadModalOpen},t.prototype.confirmedFSWs=function(){return this._confirmedFSWs},t.prototype.confirmedFSWBatchIds=function(){return this._confirmedFSWBatchIds},t.prototype.hasOverquotaError=function(){return this._hasOverquotaError},t.prototype.allUploadsComplete=function(){return this._allUploadsComplete},t.prototype.setUser=function(e){var t=e.user;this._user=t,this.emit_change()},t.prototype.setPath=function(e){var t=e.path,r=e.hasPermissionToUploadToFolder,o=void 0===r||r;this._path=t,this._hasPermissionToUploadToFolder=o,this._confirmedFSWs=[],this.emit_change()},t.prototype.setFolderNsId=function(e){var t=e.folderNsId;this._folderNsId=t},t.prototype.setHasOverquotaError=function(e){var t=e.hasOverquotaError;this._hasOverquotaError=t,this.emit_change()},t.prototype.queueUploads=function(e){
for(var t=e.files,r={},o=0,s=t;o<s.length;o++){var n=s[o];r[n.uploadId]=n}this._fileList=this._fileList.merge(r),this.emit_change()},t.prototype.handleAllUploadsComplete=function(){this._allUploadsComplete=!0,this.emit_change()},t.prototype.startUpload=function(e){var t=e.file;i.assert(null==this.currentUpload(),"can't start an unload while one is ongoing"),i.assert(null!=t,"missing file to upload"),i.assert(this._fileList.get(t.uploadId)===t,"failed to find file in file list"),this._fileList.get(t.uploadId)&&(this._fileList=this._fileList.update(t.uploadId,function(e){return e.set("status",n.FileStatusType.UPLOADING)}),this._currentUploadId=t.uploadId,this._allUploadsComplete=!1),this.emit_change()},t.prototype.completeUpload=function(e){var t=e.uploadId,r=this._fileList.get(t);r&&(t===this._currentUploadId&&r.status===n.FileStatusType.UPLOADING||i.reportStack("Tried to mark a file upload that is not currently uploading as complete",{exc_extra:{file:r.toString(),fileListLength:this._fileList.count(),uploadId:t,currentUploadId:this._currentUploadId}}),this._fileList=this._fileList.update(t,function(e){return e.set("status",n.FileStatusType.COMPLETE)})),this._currentUploadId=null,this.emit_change()},t.prototype.cancelUploads=function(e){for(var t=e.files,r=0,o=t;r<o.length;r++){var s=o[r];this._fileList=this._fileList.update(s.uploadId,function(e){return e.status===n.FileStatusType.PENDING||e.status===n.FileStatusType.UPLOADING?e.set("status",n.FileStatusType.CANCELLED):e}),s.uploadId===this._currentUploadId&&(this._currentUploadId=null)}this.emit_change()},t.prototype.setCurrentUploadProgress=function(e){var t=e.percentComplete,r=e.numSecondsLeft,o=this._currentUploadId;o&&(this._fileList=this._fileList.update(o,function(e){return e.set("percentUploaded",t)}),void 0!==r&&(this._numSecondsLeft=r)),this.emit_change()},t.prototype.handleUploadError=function(e){var t=e.uploadId,r=e.errorType,o=e.errorMessage,s=this._fileList.get(t);s&&(s.uploadId!==this._currentUploadId&&i.reportStack("Error reported for file upload that is not the current upload",{exc_extra:{file:s.toString(),fileListLength:this._fileList.count(),errorType:r,errorMessage:o}}),this._fileList=this._fileList.update(s.uploadId,function(e){return e.set("status",n.FileStatusType.FAILED).set("errorType",r).set("errorMessage",o)})),this._currentUploadId=null,this.emit_change()},t.prototype.setNumDraggingFiles=function(e){var t=e.numDraggingFiles,r=e.isInternalTransfer,o=void 0!==r&&r;this._numDraggingFiles=t,this._isInternalTransfer=o,this.emit_change()},t.prototype.setIsUploadModalOpen=function(e){var t=e.isUploadModalOpen;this._isUploadModalOpen=t,this.emit_change()},t.prototype.setInlineStatusShouldBeDismissed=function(e){var t=e.inlineStatusShouldBeDismissed;this._inlineStatusShouldBeDismissed=t,this.emit_change()},t.prototype.addNewFailedFile=function(e){var t=e.file,r=e.errorType,o=e.errorMessage;null==t.uploadId&&(t=t.set("uploadId",a.generateUploadId())),t=t.set("status",n.FileStatusType.FAILED).set("errorType",r).set("errorMessage",o),this._fileList=this._fileList.set(t.uploadId,t),this.emit_change()},t.prototype.confirmFSW=function(e){var t=this,r=e.fswIds,o=e.batchId;r.forEach(function(e){t._confirmedFSWs.includes(e)||t._confirmedFSWs.push(e)}),this._confirmedFSWBatchIds.includes(o)||this._confirmedFSWBatchIds.push(o)},t.prototype._new_payload=function(e){var t=e.action;switch(t.type){case n.UploaderActionType.SET_USER:this.setUser(t.data);break;case n.UploaderActionType.SET_PATH:this.setPath(t.data);break;case n.UploaderActionType.SET_FOLDER_NS_ID:this.setFolderNsId(t.data);break;case n.UploaderActionType.QUEUE_UPLOADS:this.queueUploads(t.data);break;case n.UploaderActionType.START_UPLOAD:this.startUpload(t.data);break;case n.UploaderActionType.COMPLETE_UPLOAD:this.completeUpload(t.data);break;case n.UploaderActionType.ALL_UPLOADS_COMPLETE:this.handleAllUploadsComplete();break;case n.UploaderActionType.CANCEL_UPLOADS:this.cancelUploads(t.data);break;case n.UploaderActionType.SET_CURRENT_UPLOAD_PROGRESS:this.setCurrentUploadProgress(t.data);break;case n.UploaderActionType.UPLOAD_ERROR:this.handleUploadError(t.data);break;case n.UploaderActionType.SET_NUM_DRAGGING_FILES:this.setNumDraggingFiles(t.data);break;case n.UploaderActionType.SET_IS_UPLOAD_MODAL_OPEN:this.setIsUploadModalOpen(t.data);break;case n.UploaderActionType.SET_INLINE_STATUS_SHOULD_BE_DISMISSED:this.setInlineStatusShouldBeDismissed(t.data);break;case n.UploaderActionType.ADD_NEW_FAILED_FILE:this.addNewFailedFile(t.data);break;case n.UploaderActionType.CONFIRM_FSW:this.confirmFSW(t.data);break;case n.UploaderActionType.SET_HAS_OVERQUOTA_ERROR:this.setHasOverquotaError(t.data)}},t})(s.Store);t.UploaderStoreClass=l,t.uploaderStore=new l}),define("modules/clean/react/file_uploader/utils",["require","exports","tslib","modules/clean/base64","modules/core/browser"],function(e,t,r,o,s){"use strict";function n(){return i()}function a(){return"batch-"+i()}function i(){for(var e="",t=0;t<16;++t)e+=String.fromCharCode(Math.floor(256*Math.random()));var r=o.encode(e);return r=r.replace(/\+/g,"-"),r=r.replace(/\//g,"_"),r=r.replace(/\=*$/,"")}function l(e,t){var r=0;return e.forEach(function(e){t.indexOf(e.status)!==-1&&(r+=e.size)}),r}function c(e,t,r){var o=t,s=0;return e.forEach(function(e,t){for(var n=0,a=e.split("/"),i=r.split("/");n<a.length&&n<i.length&&a[n]===i[n];)n++;n===a.length&&n>1&&n>s&&(s=n,o=Number(t))}),o}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),t.generateUploadId=n,t.generateBatchId=a,t.calculateSizeOfUploads=l,t.getNsId=c,t.getOQmodalOQALocationCode=function(e){return"/h"===(e||s.get_uri().path)?"ho":"fb"}}),define("modules/clean/react/fileops_actions",["require","exports","tslib","react","modules/core/notify","modules/core/i18n","modules/clean/em_string","modules/clean/filepath","modules/clean/react/async_file_modal_controller","modules/clean/file_operations/notifications","modules/clean/react/browse/api","modules/clean/react/browse/nav_actions","modules/clean/react_format","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/react/browse/models","modules/clean/viewer"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_){"use strict";function S(e,t,r,o){var a=_.Viewer.get_viewer().team_name,c=!1;"is_cdm_member"in e&&e.is_cdm_member&&i.inSubDirectory(e.cdm_tmf_path,o)&&(c=!0);var d=E(e,t,a,r,c);if(null!=d){s.Notify.clear();var p=t===v.TEAM_SPACE_OWNER_ONLY_MANAGE_MEMBERSHIP_ERROR||t===v.TEAM_SPACE_ONLY_ON_TEAM_SHARING_ERROR||t===v.NS_HAVE_MOUNTED_CHILDREN_NS_ERROR,S=g(e,p,a,r.length,c),w=1===r.length,F=r[0]instanceof m.File&&w&&!p?n._("See owner"):void 0,T=function(){r[0]instanceof m.File&&h.asyncShowShareModal(e.id,r[0],{origin:f.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS},u.browseNavActions.setPath,u.browseNavActions.setUrl)};l.showMoveErrorModal({title:S,content:d,learnMoreLink:"/help/business/team-space-overview#move",buttonString:F,onClick:T})}}function g(e,t,r,o,s){return t?1===o?n._("Can’t move out of the team space"):n._("Can’t move %(num_of_files)s items").format({num_of_files:o}):"is_cdm_member"in e&&e.is_cdm_member&&!s?n.ungettext("Can’t move shared folder to the %(team_name)s team space","Can’t move shared folders to the %(team_name)s team space",o).format({team_name:a.Emstring.em_snippet(r,f.SNIPPET_SIZES.DISPLAY_NAME)}):n.ungettext("Can’t move shared folder to a team folder","Can’t move shared folders to a team folder",o)}function E(e,t,r,s,l){var c=n._("You don’t have permission to move some of these items. Try moving items individually."),d=null;return t===v.OFF_TEAM_OWNER_ERROR?d=1===s.length?null==r?p.reactFormat(n._("The owner of <strong>%(file_name)s</strong> is a member of another team.").format({file_name:a.Emstring.em_snippet(i.filename(s[0].fq_path),f.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):p.reactFormat(n._("The owner of <strong>%(file_name)s</strong> isn’t a member of %(team_name)s.").format({team_name:r,file_name:a.Emstring.em_snippet(i.filename(s[0].fq_path),f.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):null==r?n._("The owner of some of these shared folders is a member of another team."):n._("The owner of some of these shared folders isn’t a member of %(team_name)s.").format({team_name:r}):t===v.OWNER_ONLY_MANAGE_MEMBERSHIP_ERROR?d=1===s.length?"is_cdm_member"in e&&e.is_cdm_member&&!l?p.reactFormat(n._("Only the owner of <strong>%(file_name)s</strong> can move it to the %(team_name)s team space.").format({team_name:r,file_name:a.Emstring.em_snippet(i.filename(s[0].fq_path),f.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):p.reactFormat(n._("Only the owner of <strong>%(file_name)s</strong> can move it to a team folder.").format({file_name:a.Emstring.em_snippet(i.filename(s[0].fq_path),f.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):"is_cdm_member"in e&&e.is_cdm_member&&!l?n._("Only the owner can move some of these folders to the %(team_name)s team space.").format({team_name:r}):n._("Only the owner can move some of these folders to a team folder."):t===v.VIEW_ONLY_ACCESS_ERROR?d=1===s.length?p.reactFormat(n._("You can only view <strong>%(file_name)s</strong>. Ask an owner or editor of the folder for access to edit it.").format({file_name:a.Emstring.em_snippet(i.filename(s[0].fq_path),f.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):n._("You can’t edit some of these folders. Ask an owner or editor of the folders for access to edit them."):t===v.TEAM_SPACE_OWNER_ONLY_MANAGE_MEMBERSHIP_ERROR||t===v.TEAM_SPACE_ONLY_ON_TEAM_SHARING_ERROR?d=1===s.length?p.reactFormat(n._("If you need to move <strong>%(file_name)s</strong>, ask your admin to move it for you.").format({file_name:a.Emstring.em_snippet(i.filename(s[0].fq_path),f.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):c:t===v.NS_HAVE_MOUNTED_CHILDREN_NS_ERROR&&(d=1===s.length?p.reactFormat(n._("<strong>%(file_name)s</strong> has other shared folders inside it. Try moving each shared folder individually.").format({file_name:a.Emstring.em_snippet(i.filename(s[0].fq_path),f.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):c),d}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importStar(i),l=r.__importStar(l),c=r.__importStar(c),d=r.__importStar(d);var v={VIEW_ONLY_ACCESS_ERROR:"view_only_access_error",OFF_TEAM_OWNER_ERROR:"off_team_owner_error",OWNER_ONLY_MANAGE_MEMBERSHIP_ERROR:"owner_only_manage_membership_error",TEAM_SPACE_OWNER_ONLY_MANAGE_MEMBERSHIP_ERROR:"team_space_owner_only_manage_membership_error",TEAM_SPACE_ONLY_ON_TEAM_SHARING_ERROR:"team_space_only_on_team_sharing_error",NS_HAVE_MOUNTED_CHILDREN_NS_ERROR:"ns_have_mounted_children_ns_error"};t.copyFiles=function(e){var o=e.files,s=e.newPath,a=e.checkFSWs,i=e.onSuccess,u=e.onRequestNotSent,p=e.onUndo,h=e.user,f=e.dataApi;!(void 0===f?d:f).copyFiles({files:o,newPath:s,checkFSWs:a,userId:h.id,onSuccess:function(a){var d=a.newFiles,u=a.changesets,f=a.failureDetails;if(f){var m=function(){t.copyFiles(r.__assign({},e,{checkFSWs:!1}))};l.showFileSystemWarningsModal({fsws:f,onFinalAccept:m,confirmText:n._("Copy")})}else i&&i(d),c.notifyCopySuccess(o.length,h,u,s,function(){p&&p()})}})&&u&&u()},t.moveFiles=function(e){var o=e.path,a=e.files,i=e.newPath,u=e.checkFSWs,p=e.onSuccess,h=e.onRequestNotSent,f=e.onUndo,m=e.user,_=e.dataApi,g=void 0===_?d:_,E=function(o){var s=o.newFiles,d=o.changesets,u=o.failureDetails;if(u){var h=function(){t.moveFiles(r.__assign({},e,{checkFSWs:!1}))};l.showFileSystemWarningsModal({fsws:u,onFinalAccept:h,confirmText:n._("Move")})}else c.notifyMoveSuccess(a.length,m,d,i,function(){f&&f()}),p&&p(s)},v=function(e){"This will result in losing ownership of these folders."===e?(s.Notify.clear(),l.showConfirmOwnershipTransferModal(function(){g.moveFiles({path:o,files:a,newPath:i,userId:m.id,onSuccess:E,allowOwnershipTransfer:!0})})):S(m,e,a,i)};!g.moveFiles({path:o,files:a,newPath:i,checkFSWs:u,userId:m.id,onSuccess:E,onError:v,allowOwnershipTransfer:!1})&&h&&h()}}),define("modules/clean/react/files_view/column_header",["require","exports","tslib","external/classnames","spectrum/checkbox","spectrum/table","react","modules/clean/react/files_view/column_header_menu","modules/clean/react/files_view/fixed_table_head","modules/clean/react/files_view/sticky_table_head","modules/clean/react/files_view/view_type_column_header_menu","modules/clean/react/files_view/types"],function(e,t,r,o,s,n,a,i,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),a=r.__importDefault(a);var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isHovered:!1},t.handleChangeSelectAllCheckbox=function(e){"unchecked"===e?t.props.onDeselectAll():t.props.onSelectAll()},t.handleMouseEnter=function(){t.setState({isHovered:!0})},t.handleMouseLeave=function(){t.setState({isHovered:!1})},t}return r.__extends(t,e),t.prototype.getAriaSortValue=function(e){return e===u.SortDirection.ASCENDING?"ascending":e===u.SortDirection.DESCENDING?"descending":"none"},t.prototype.render=function(){var e=this,t=this.state.isHovered,u=this.props,p=u.columnFlex,h=u.isCompactMode,f=u.isSelectMode,m=u.isSticky,_=u.isTabbing,S=u.currentSort,g=u.onSelection,E=u.onSort,v=u.onSwitchViewType,w=u.selectAllCheckboxState,F=void 0===w?"unchecked":w,T=u.showSelectAllCheckbox,b=void 0===T||T,y=u.stickyOffsetHeight,C=u.stickyOffsetTop,I=u.columns,R=u.visibleColumns,D=u.viewType,N=u.viewTypes,P=u.viewTypeLabels,A=u.onTTI,O=!(_||f||t||h),L=[a.default.createElement(n.TableHeadCell,{className:"brws-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:"columnheader",scope:"col"},a.default.createElement("div",{className:"brws-vertically-center"},b?a.default.createElement(s.Checkbox,{className:o.default("brws-checkbox",{"brws-checkbox-checked":"checked"===F}),checked:F,onChange:this.handleChangeSelectAllCheckbox,variant:O?"invisible":"default"}):null))].concat(R.map(function(t,r){var o=S&&S.sortField===t.sortField?S.sortDirection:void 0;return a.default.createElement(n.TableHeadCell,{key:r,role:"columnheader",scope:"col","aria-sort":e.getAriaSortValue(o),className:"brws-column-header-table-cell"},a.default.createElement(i.ColumnHeaderMenu,{column:t,sortDirection:o,columns:I,visibleColumns:R,onSelection:g,onSort:E,viewType:D}),r===R.length-1&&a.default.createElement(d.ViewTypeColumnHeaderMenu,{onTTI:A,viewType:D,viewTypes:N,viewTypeLabels:P,onSwitchViewType:v}))})),x={offsetHeight:y,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave};return m?a.default.createElement(c.StickyTableHead,r.__assign({columnFlex:p,offsetTop:C,className:"brws-column-header"},x),L):a.default.createElement(l.FixedTableHead,r.__assign({},x),L)},t})(a.default.PureComponent);t.ColumnHeader=p}),define("modules/clean/react/files_view/column_header_menu",["require","exports","tslib","external/classnames","spectrum/icon_form","spectrum/popover","react","modules/clean/react/files_view/types","modules/core/i18n"],function(e,t,r,o,s,n,a,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),a=r.__importDefault(a);var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePopoverSelection=function(e){var r=t.props,o=r.onSort,s=r.onSelection,n=r.column;e===i.SortDirection.ASCENDING||e===i.SortDirection.DESCENDING?o(n.sortField,e):(s(e,n),1===t.props.visibleColumns.length&&o(e.sortField,t.props.sortDirection||i.SortDirection.ASCENDING))},t}return r.__extends(t,e),t.prototype._columnMenuTitle=function(){switch(this.props.viewType){case i.ViewType.Grid:case i.ViewType.LargeGrid:return l._("Group by");case i.ViewType.List:default:return l._("Show")}},t.prototype.render=function(){var e=this.props,t=e.column,r=e.columns,c=e.visibleColumns,d=e.sortDirection;if(t.isSortDisabled)return a.default.createElement("div",{className:"normal brws-column-header-menu"},a.default.createElement("span",{className:"brws-column-header-menu-trigger-disabled"},t.label));var u;!t.isLocked&&r&&r.length&&(u=[a.default.createElement(n.PopoverItemGroupSeparator,{key:"show-separator"}),a.default.createElement(n.PopoverItemGroup,{key:"show-item-group"},a.default.createElement(n.PopoverItemGroupTitle,{className:"brws-column-header-menu-title",key:"show-title"},this._columnMenuTitle()),r.filter(function(e){return!e.isLocked}).map(function(e){return a.default.createElement(n.PopoverSelectableItem,{key:e.sortField,disabled:c.map(function(e){return e.sortField}).includes(e.sortField)&&e.sortField!==t.sortField,selected:e.sortField===t.sortField,value:e},e.label)}))]);var p=d===i.SortDirection.ASCENDING?"sort-arrow-up":d===i.SortDirection.DESCENDING?"sort-arrow-down":"caret-down";return a.default.createElement(n.Popover,{className:"brws-column-header-menu",onSelection:this.handlePopoverSelection},a.default.createElement(n.PopoverTrigger,{className:o.default("brws-column-header-menu-trigger",{"brws-column-header-menu-trigger-active":!!d}),title:t.popoverTriggerLabel},a.default.createElement("span",null,t.label),a.default.createElement("span",{className:"brws-column-header-menu-label-icon-wrapper"},a.default.createElement(s.IconForm,{className:"brws-column-header-menu-label-icon",name:p}))),a.default.createElement(n.PopoverContent,null,a.default.createElement(n.PopoverItemGroup,null,a.default.createElement(n.PopoverItemGroupTitle,{className:"brws-column-header-menu-title"},l._("Order")),a.default.createElement(n.PopoverSelectableItem,{selected:d===i.SortDirection.ASCENDING,value:i.SortDirection.ASCENDING,disabled:t.sortField===i.SortField.SHARED_WITH},l._("Ascending")),a.default.createElement(n.PopoverSelectableItem,{selected:d===i.SortDirection.DESCENDING,value:i.SortDirection.DESCENDING,disabled:t.sortField===i.SortField.SHARED_WITH},l._("Descending"))),u))},t})(a.default.PureComponent);t.ColumnHeaderMenu=c}),define("modules/clean/react/files_view/column_manager",["require","exports","tslib","external/lodash","react","modules/clean/immutability_helper","modules/clean/react/files_view/types"],function(e,t,r,o,s,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importDefault(s);var i=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleSelection=function(e,t){var o=r.props,s=o.viewType,i=o.onColumnsChanged,l=o.viewTypeColumns,c=r.state.visibleColumns,d=l?l[a.ViewType.List]:void 0,u=l?l[a.ViewType.Grid]:void 0;if(d&&u){var p=c.indexOf(t);if(p===-1||c.includes(e))r.changeVisibleColumns(c);else{var h=n.splice(c,p,1,e);r.changeVisibleColumns(h);var f=r.isSizeColumnPresent(h);s===a.ViewType.List?i(r.swapColumns(d,t.sortField,e.sortField),a.ViewType.List,f):(i(r.swapColumns(u,t.sortField,e.sortField),s,f),e.sortField!==a.SortField.FILENAME&&i(r.swapColumns(d,d[1].sortField,e.sortField),a.ViewType.List,f))}}},r}return r.__extends(t,e),t.prototype.componentWillMount=function(){this.changeVisibleColumns(this.computeVisibleColumns(this.props),!0)},t.prototype.componentWillReceiveProps=function(e){var t=this.props.viewTypeColumns,r=this.state.visibleColumns,s=this.getNumVisibleColumns(this.props),n=this.getNumVisibleColumns(e);if(o.isEqual(this.props.columns,e.columns)&&this.props.viewType===e.viewType){if(n<s)this.changeVisibleColumns(r.slice(0,n),!0);else if(n>s){var i=this.props.columns,l=n-r.length,c=o.filter(i,function(e){return!o.find(r,function(t){return t.sortField===e.sortField})}).slice(0,l);this.changeVisibleColumns(r.concat(c),!0)}}else if(1===n&&e.columns.length&&e.currentSort){var i=e.columns,d=e.viewType,u=t?t[a.ViewType.Grid]:void 0;switch(d){case a.ViewType.List:this.changeVisibleColumns([i[0]],!0);break;case a.ViewType.Grid:case a.ViewType.LargeGrid:if(u){var p=e.currentSort,h=i.find(function(e){return e.sortField===p.sortField}),f=h||i[0];this.deferredOnColumnsChangedHandler([f],this.swapColumns(u,u[0].sortField,f.sortField),d)}}}else this.changeVisibleColumns(e.columns.slice(0,n),!0)},t.prototype.changeVisibleColumns=function(e,t){var r=this;void 0===t&&(t=!1),this.resetChangeVisibleColumnsTimeout();var o=this.isSizeColumnPresent(e);this.setState({visibleColumns:e,canDisplayFolderSizes:o}),t?this.changeVisibleColumnsTimeout=setTimeout(function(){r.resetChangeVisibleColumnsTimeout(),r.props.onCanDisplayFolderSizesChanged(o)}):this.props.onCanDisplayFolderSizesChanged(o)},t.prototype.resetChangeVisibleColumnsTimeout=function(){this.changeVisibleColumnsTimeout&&(clearTimeout(this.changeVisibleColumnsTimeout),this.changeVisibleColumnsTimeout=void 0)},t.prototype.deferredOnColumnsChangedHandler=function(e,t,r){var o=this;this.resetDeferredOnColumnsChangedHandler();var s=this.isSizeColumnPresent(e);this.setState({visibleColumns:e,canDisplayFolderSizes:s}),this.onColumnsChangesTimeout=setTimeout(function(){o.resetDeferredOnColumnsChangedHandler(),o.props.onColumnsChanged(t,r,s)})},t.prototype.resetDeferredOnColumnsChangedHandler=function(){this.onColumnsChangesTimeout&&(clearTimeout(this.onColumnsChangesTimeout),this.onColumnsChangesTimeout=void 0)},t.prototype.swapColumns=function(e,t,r){var o=e.map(function(e){return e.sortField}).indexOf(t),s=e.map(function(e){return e.sortField}).indexOf(r);if(o===s||o===-1||s===-1)return e;var a=e[o],i=e[s];return n.splice(n.splice(e,o,1,i),s,1,a)},t.prototype.computeVisibleColumns=function(e){return e.columns.slice(0,this.getNumVisibleColumns(e))},t.prototype.getNumVisibleColumns=function(e){var t=e.isMatchedLarge,r=e.isMatchedMedium;switch(e.viewType){case a.ViewType.Grid:case a.ViewType.LargeGrid:return 1;case a.ViewType.List:default:return t?3:r?2:1}},t.prototype.isSizeColumnPresent=function(e){return e.some(function(e){return e.sortField===a.SortField.SIZE})},t.prototype.render=function(){var e=this.props.children,t=this.state,r=t.visibleColumns,o=t.canDisplayFolderSizes;if(!e)return null;var s=e;return"function"==typeof e&&(s=e({visibleColumns:r,canDisplayFolderSizes:o,handleSelection:this.handleSelection})),s},t})(s.default.PureComponent);t.ColumnManager=i}),define("modules/clean/react/files_view/controller",["require","exports","tslib","external/classnames","external/immutable","spectrum/media_table_skeleton","spectrum/table","react","external/react-dom","external/lodash","modules/clean/react/files_view/types","modules/clean/react/files_view/drag_and_drop","modules/clean/react/files_view/file_grouper","modules/clean/react/files_view/file_list_empty_folder_table","modules/clean/react/files_view/column_header","modules/clean/react/files_view/column_manager","modules/clean/react/files_view/constants","modules/clean/react/files_view/list","modules/clean/react/files_view/pinned_team_folder_view","modules/clean/react/selectable_list","modules/clean/react/files_view/selectors","modules/clean/react/files_view/tile_grid","modules/clean/react/files_view/internal_drag_status","modules/clean/react/browse/models","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/core/browser_detection","modules/core/i18n","modules/core/notify","modules/clean/sharing/access_level","modules/clean/photos/thumb_loading/buffered_thumb_store","modules/clean/photos/thumb_loading/generic_thumb_store"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S,g,E,v,w,F,T,b,y,C,I,R,D,N,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),s=r.__importStar(s),i=r.__importDefault(i),l=r.__importStar(l),c=r.__importStar(c),y=r.__importStar(y);var A=function(){},O=[D.NameSpaceAccess.ACCESS_NO_ACCESS,D.NameSpaceAccess.ACCESS_READER,D.NameSpaceAccess.ACCESS_READER_NO_COMMENT],L=[{moduleName:"cdm_new_team_creator_v2",stepName:"start"},{moduleName:"cdm_new_team_joiner_v2",stepName:"start"},{moduleName:"uj_housewarming_v1",stepName:"start"},{moduleName:"uj_housewarming_v2",stepName:"start"},{moduleName:"uj_housewarming_v5",stepName:"start"},{moduleName:"ncct_uj_housewarming_v5",stepName:"start"},{moduleName:"trial_admin_setup_team_space",stepName:"team_space_tooltip"},{moduleName:"trial_admin_setup_team_space_v2",stepName:"team_space_tooltip"},{moduleName:"trial_admin_setup_team_space_mobile",stepName:"team_space_tooltip"},{moduleName:"trial_admin_setup_team_space_mobile_v2",stepName:"team_space_tooltip"},{moduleName:"biz_onboarding_tour_rwl_copy_creator_v1",stepName:"start"},{moduleName:"biz_onboarding_tour_rwl_copy_joiner_v1",stepName:"start"},{moduleName:"biz_trial_onboarding_creator_no_tf",stepName:"start"},{moduleName:"biz_trial_onboarding_joiner_no_tf",stepName:"start"},{moduleName:"trial_admin_setup_team_space_free_order",stepName:"team_space_tooltip"},{moduleName:"trial_admin_setup_team_space_free_order_v2",stepName:"team_space_tooltip"},{moduleName:"trial_admin_shared_workspace",stepName:"team_space_tooltip"},{moduleName:"trial_admin_shared_workspace_v2",stepName:"team_space_tooltip"},{moduleName:"joiner_checklist_shared_workspace",stepName:"team_workspace_tooltip"},{moduleName:"joiner_checklist_shared_workspace_mobile",stepName:"team_workspace_tooltip"},{moduleName:"joiner_checklist_shared_workspace_v2",stepName:"team_workspace_tooltip"},{moduleName:"joiner_checklist_shared_workspace_mobile_v2",stepName:"team_workspace_tooltip"},{moduleName:"trial_admin_shared_workspace_free_order",stepName:"team_space_tooltip"},{moduleName:"trial_admin_shared_workspace_free_order_v2",stepName:"team_space_tooltip"}],x=(function(t){function D(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridViewPrewarmedThumbnailRequestIds=[],e.state={thumbStore:new N.BufferedThumbStore,isTabbing:!1,keyboardShortcutModalHandler:function(){e.setState({shouldShowKeyboardShortcutModal:!0})},dropTarget:null,sections:{sectionLabels:[],sectionStartIndices:[]},tilesPerRow:1},e.handleMouseDownBody=function(){e.setState({isTabbing:!1})},e.handleKeyDownBody=function(t){9===t.keyCode&&e.setState({isTabbing:!0})},e.handleTabbingStart=function(){e.setState({isTabbing:!0})},e.handleCopyToClipboard=function(){var t=e.props,r=t.selectedFiles,o=t.onCopyToClipboard;r.size&&o(r.toArray())},e.handleNewFolderSubmit=function(t){""===t?(e.props.onNewFolderCancel(),e.handleNewFolderCancel({source:d.NameInputActionSource.SUBMIT})):e.props.onNewFolderSubmit(t)},e.handleNewFolderCancel=function(t){t.source!==d.NameInputActionSource.ESC&&R.Notify.error(I._("Please provide a name for the new folder.")),e.props.onNewFolderCancel()},e.handleSetFileUploaderPath=function(t){var r=t?t.path:e.props.path,o=e.props.context.isCurrentPathWriteable();t&&t.hasOwnProperty("hasPermissionToUploadToFolder")&&(o=!!t.hasPermissionToUploadToFolder),e.props.setFileUploaderPath({path:r,hasPermissionToUploadToFolder:o})},e.handleDragStart=function(t,o){void 0===o&&(o=[]);var s=e.props,n=s.path,a=s.selectedFiles,i=s.user,d=c.keyBy(o,"fq_path");d=r.__assign({},d,a.toJS());var u=c.values(d);if(u.some(function(e){return T.File.isTeamSharedFolder(e)}))return void R.Notify.error(I._("Team folders can’t be moved."));if(u.some(function(e){return T.File.isTeamMemberFolder(e)}))return void R.Notify.error(I._("Your member folder can’t be moved."));var p=t.dataTransfer;p&&(p.setDragImage&&e.internalDragStatusRef&&p.setDragImage(l.findDOMNode(e.internalDragStatusRef),-10,-10),p.setData(C.INTERNAL_FILE_DATA_TRANSFER_TYPE,JSON.stringify({userId:i.id,fromPath:n,filePaths:u.map(function(e){return e.fq_path})})),p.effectAllowed="copyMove")},e.handleDragEnter=function(t,r,o,s){u.onFileDragEnterItem(r,!!e.props.isDraggingExternalFiles,!!e.props.isDraggingInternalFiles,o,s,e.props.context,e.handleSetDropTarget,e.handleSetFileUploaderPath)},e.handleSetDropTarget=function(t){e.setState({dropTarget:t})},e.handleSelectionChange=function(t){b.UEClient.sendEvent("FileItemRow","CheckboxToggled"),e.props.onSelectionChange(t)},e.handleDeselectAll=function(){var t=e.props,r=t.selection;(0,t.onSelectionChange)(r.set("selected",s.OrderedSet()))},e.handleSelectAll=function(){var t=e.props,r=t.items,o=t.selection;(0,t.onSelectionChange)(o.set("selected",s.OrderedSet(r.filter(D.canSelectItem).map(function(e){return e.fq_path}))))},e._handleGetOverflowMenuActions=function(t,r){var o=e.props;return(0,o.getOverflowMenuActions)(t,r,o.responsive)},e.handleTTI=function(){e.props.onComponentTTI("FilesViewController")},e.setFilesViewTileGridRef=function(t){e.filesViewTileGridRef=t},e.setInternalDragStatusRef=function(t){e.internalDragStatusRef=t},e.getIsCurrentPathWriteable=function(){return e.props.context.isCurrentPathWriteable()},e.onTilesPerRowChange=function(t){e.setState({tilesPerRow:t})},e}return r.__extends(D,t),D.prototype.componentWillMount=function(){this.setTileItemsSections(this.props)},D.prototype.componentDidMount=function(){var t=this;this.setupUnity(),document.addEventListener("keydown",this.handleKeyDownBody),document.addEventListener("mousedown",this.handleMouseDownBody),b.UEClient.registerBulkCallbackForEducationStep(L,function(){t.props.onSwitchViewType(d.ViewType.List)}),y.waitForTTI().then(function(){t.prewarmGridViewThumbStore();var o=function(e){var r=e.showKeyboardShortcutsModal;t.state.shouldShowKeyboardShortcutModal&&r(t.props.viewType===d.ViewType.List),t.setState({keyboardShortcutModalHandler:function(){r(t.props.viewType===d.ViewType.List)},shouldShowKeyboardShortcutModal:!1})};o.perfName="keyboard_shortcuts_modal",new Promise(function(t,r){e(["modules/clean/react/files_view/keyboard_shortcuts_modal"],t,r)}).then(r.__importStar).then(o)})},D.prototype.componentWillReceiveProps=function(e){if(e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath){this.undoPrewarmGridViewThumbStore();var t=this.props.arePostTTIModulesLoaded?new P.GenericThumbStore:new N.BufferedThumbStore;this.setState({thumbStore:t})}(e.viewType!==this.props.viewType||!e.currentSort!=!this.props.currentSort||e.currentSort&&this.props.currentSort&&(e.currentSort.sortField!==this.props.currentSort.sortField||e.currentSort.sortDirection!==this.props.currentSort.sortDirection)||e.items!==this.props.items)&&this.setTileItemsSections(e)},D.prototype.componentDidUpdate=function(e){e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath&&this.prewarmGridViewThumbStore(),this.props.enableUnity&&e.items!==this.props.items&&this.triggerUnityChangeCallback&&this.triggerUnityChangeCallback(),e.path!==this.props.path&&this.handleScrollToTop()},D.prototype.componentWillUnmount=function(){this.triggerUnityChangeCallback=void 0,document.removeEventListener("keydown",this.handleKeyDownBody),document.removeEventListener("mousedown",this.handleMouseDownBody)},D.prototype.setupUnity=function(){return r.__awaiter(this,void 0,void 0,function(){var t,o=this;return r.__generator(this,function(s){switch(s.label){case 0:return[4,y.waitForTTI()];case 1:return s.sent(),[4,new Promise(function(t,r){e(["modules/clean/unity_browse_interface"],t,r)}).then(r.__importStar)];case 2:return t=s.sent().default,this.triggerUnityChangeCallback=function(){t.browse_visible_change_callback(o.props.items.toArray(),o.props.user.id,0,o.props.items.size-1)},[2]}})})},D.prototype.setTileItemsSections=function(e){this.setState({sections:e.viewType!==d.ViewType.List&&e.currentSort?p.getSections(e.items,e.currentSort.sortField,e.currentSort.sortDirection):D.emptySections})},D.prototype.prewarmGridViewThumbStore=function(){var e=this;if(this.props.viewType!==d.ViewType.Grid){var t=this.state.thumbStore;this.props.items.slice(0,100).forEach(function(r){if(r instanceof T.File){var o=w.getThumbnailUrlForItem(r,_.ViewTypeThumbnailSizes[d.ViewType.Grid]);if(o){var s=t.bind_url(o,{onSuccess:A});s&&e.gridViewPrewarmedThumbnailRequestIds.push(s)}}})}},D.prototype.undoPrewarmGridViewThumbStore=function(){
var e=this;this.gridViewPrewarmedThumbnailRequestIds.length&&(this.gridViewPrewarmedThumbnailRequestIds.forEach(function(t){e.state.thumbStore.unbind_url(t)}),this.gridViewPrewarmedThumbnailRequestIds=[])},D.prototype.handleScrollToTop=function(){window.scrollTo(0,0)},D.prototype.getFilesViewTileGridRef=function(){return this.filesViewTileGridRef},D.prototype.renderEmptyFolderView=function(){var e=this.props,t=e.context,r=e.responsive,o=e.onFocusSearchBar,s=e.onPasteFromClipboard,n=e.onNavigateToParentFolder;if(this.props.customEmptyFolderView)return this.props.customEmptyFolderView(r);var a=t.isInsideSharedFolder,l=t.currentSharedFolderPermissionRole,c=a&&O.includes(l),d=c?void 0:I._("Drag and drop files onto this window to upload.");return i.default.createElement(h.EmptyFolderTable,{title:I._("This folder is empty"),subtitle:d,onTTI:this.handleTTI,onFocusSearchBar:o,onPasteFromClipboard:s,onNavigateToParentFolder:n,onOpenKeyboardShortcutModal:this.state.keyboardShortcutModalHandler})},D.prototype.renderPinnedTeamFolderView=function(e){var t=this.props,r=t.context,o=t.dropTargetHighlightMode,s=t.onShowShare,n=t.renderSharedWithController,a=t.teamFolders,l=t.user,c=t.onRenameSubmit,d=t.onRenameCancel,u=this.state,p=u.dropTarget,h=u.isTabbing,f=u.thumbStore;return i.default.createElement(g.PinnedTeamFolderView,{activeDropTarget:p,columnFlex:_.LIST_VIEW_COLUMN_FLEX[1],context:r,dropTargetHighlightMode:o,getOverflowMenuActions:this._handleGetOverflowMenuActions,isCompactMode:e,isTabbing:h,onDragEnter:this.handleDragEnter,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder,onRenameCancel:d,onRenameSubmit:c,teamFolders:a,user:l,arePostTTIModulesLoaded:this.props.arePostTTIModulesLoaded,thumbStore:f,onShowShare:s,renderSharedWithController:n})},D.prototype.getSelectAllCheckboxCheckedVariant=function(){var e=this.props,t=e.selectedFiles,r=e.items,o="unchecked";return t.size===r.filter(D.canSelectItem).size?o="checked":t.size&&(o="mixed"),o},D.prototype.getShouldShowSelectAllCheckbox=function(){return this.props.items.filter(D.canSelectItem).size>0},D.prototype.isCreateFolderUIActive=function(){var e=this.props.createNewFolderState;return e&&"CREATE_FOLDER_INACTIVE"!==e},D.prototype.shouldShowEmptyFolderView=function(){return this.props.loadingState===d.LoadingState.LOADED&&!this.props.items.size&&!this.isCreateFolderUIActive()},D.canSelectItem=function(e){return e instanceof T.File},D.prototype.shouldComponentUpdate=function(e){return e.loadingState!==this.props.loadingState||e.loadingState!==d.LoadingState.LOADING_FIRST_PAGE},D.prototype.render=function(){var e=this,t=this.props,r=t.onDelete,s=t.onShowRename,l=t.onRenameSubmit,c=t.onRenameCancel,u=t.onSwitchViewType,p=t.onPasteFromClipboard,h=t.onColumnsChanged,g=t.onCanDisplayFolderSizesChanged,T=t.onFocusSearchBar,b=t.currentSort,y=t.createNewFolderState,C=t.context,I=t.columns,R=t.dropTargetHighlightMode,D=t.fileRename,N=t.getIsFileJumping,P=t.onAddFileJumpKeyCode,A=t.onResetFileJump,O=t.items,L=t.isSearchMode,x=t.isDraggingExternalFiles,M=t.isDraggingInternalFiles,U=t.isQueryingFolderSizes,k=t.isFileViewerShown,B=t.loadingState,q=t.onSortChange,V=t.path,H=t.selectedFiles,W=t.selection,z=t.shouldShowPinnedTeamFolders,G=t.renderSharedWithController,j=t.onShowShare,Q=t.teamFolders,K=t.totalNumFiles,Y=t.user,J=t.viewType,X=t.viewTypes,Z=t.viewTypeLabels,$=t.viewTypeColumns,ee=t.onLocationLinkClick,te=t.onNavigateToFileOrFolder,re=t.onNavigateToParentFolder,oe=t.onOpenPaper,se=t.arePostTTIModulesLoaded,ne=t.onStarClick,ae=t.fileExtensionsConfigs,ie=t.pageHeaderHeight,le=t.disabledMultiselect,ce=t.isStickyColumnHeader,de=this.props.responsive,ue=de.isMatchedLarge,pe=de.isMatchedMedium,he=this.state,fe=he.dropTarget,me=he.thumbStore,_e=he.isTabbing,Se=he.keyboardShortcutModalHandler,ge=he.sections,Ee=he.tilesPerRow;if(B===d.LoadingState.LOADING_FIRST_PAGE)return se?i.default.createElement(n.MediaTableSkeleton,{numRows:15}):null;var ve=v.getItemIds(this.props),we=!ue,Fe=!!H.size;if(this.shouldShowEmptyFolderView())return i.default.createElement("div",{className:"brws-files-view"},z&&this.renderPinnedTeamFolderView(we),this.renderEmptyFolderView());var Te=ue?_.DEFAULT_COLUMN_HEADER_HEIGHT:_.COMPACT_COLUMN_HEADER_HEIGHT,be=Te+ie,ye=this.props.scrollPositionOffset||0;return z&&(ye+=Te+Te+_.PINNED_TEAM_FOLDER_SECONDARY_HEADER_PADDING_TOP+Q.size*_.DEFAULT_ROW_HEIGHT),i.default.createElement("div",{className:o.default(["brws-files-view","brws-files-view--"+J.toLowerCase()])},z&&this.renderPinnedTeamFolderView(we),i.default.createElement(m.ColumnManager,{columns:I,viewTypeColumns:$,currentSort:b,onCanDisplayFolderSizesChanged:g,onColumnsChanged:h,isMatchedLarge:ue,isMatchedMedium:pe,isSearchMode:L,viewType:J},function(t){var n=t.visibleColumns,h=t.handleSelection,m=t.canDisplayFolderSizes,g=(L?_.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX:_.LIST_VIEW_COLUMN_FLEX)[n.length],v=i.default.createElement(f.ColumnHeader,{columnFlex:g,currentSort:b,isCompactMode:we,isSelectMode:Fe,isSticky:ce,isTabbing:_e,onDeselectAll:e.handleDeselectAll,onSelectAll:e.handleSelectAll,onSelection:h,onSort:q,onSwitchViewType:u,selectAllCheckboxState:e.getSelectAllCheckboxCheckedVariant(),showSelectAllCheckbox:e.getShouldShowSelectAllCheckbox(),stickyOffsetHeight:Te,stickyOffsetTop:ie,columns:I,visibleColumns:n,viewType:J,viewTypes:X,viewTypeLabels:Z,onTTI:e.handleTTI});return J===d.ViewType.List?i.default.createElement(E.SelectableList,{itemIds:ve,keyScope:E.SELECTABLE_LIST_KEY_SCOPE,onSelectionChange:e.handleSelectionChange,onTabbingStart:e.handleTabbingStart,selection:W,tilesPerRow:Ee},function(t){var d=t.focusedFileId,u=t.handleDeselect,h=(t.handleDeselectAll,t.handleFocusFile),f=t.handleSelect,_=(t.handleSelectAll,t.isSelectableListEvent);return i.default.createElement(a.Table,{"aria-rowcount":K,className:o.default("brws-files-view-list",{"brws-files-view-list-compact":we}),columnFlex:g},v,i.default.createElement(S.FilesViewList,{onDelete:r,onShowRename:s,activeDropTarget:fe,context:C,createNewFolderState:y,disabledMultiselect:le||!1,dropTargetHighlightMode:R,items:O,fileExtensionsConfigs:ae,fileRename:D,focusedFileId:d,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:N,onAddFileJumpKeyCode:P,onResetFileJump:A,isCompactMode:we,isDraggingExternalFiles:x,isDraggingInternalFiles:M,isFileViewerShown:k,isSearchMode:L,isSelectMode:Fe,isSelectableListEvent:_,arePostTTIModulesLoaded:se,isTabbing:_e,keyScope:E.SELECTABLE_LIST_KEY_SCOPE,onCopyToClipboard:e.handleCopyToClipboard,onDragStart:e.handleDragStart,onDragEnter:e.handleDragEnter,onDeselectFile:u,onFocusFile:h,onFocusSearchBar:T,onOpenKeyboardShortcutModal:Se,onLocationLinkClick:ee,onNavigateToFileOrFolder:te,onNavigateToParentFolder:re,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onOpenPaper:oe,onPasteFromClipboard:p,onRenameCancel:c,onRenameSubmit:l,onSelectFile:f,onSetDropTarget:e.handleSetDropTarget,onSetFileUploaderPath:e.handleSetFileUploaderPath,onStarClick:ne,scrollPositionOffset:ye,scrollToRow:d?ve.indexOf(d):0,selectedFiles:H,selection:W,renderSharedWithController:G,hrefForFile:e.props.hrefForFile,onShowShare:j,user:Y,viewportTopOffset:be,visibleColumns:n,canDisplayFolderSizes:m,thumbStore:me,shareButtonLabel:e.props.shareButtonLabel,showShareButton:e.props.showShareButton,starredState:e.props.starredState,useSearchSuccessBanner:e.props.useSearchSuccessBanner}))}):i.default.createElement(E.SelectableList,{itemIds:ve,keyScope:E.SELECTABLE_TILE_GRID_KEY_SCOPE,onSelectionChange:e.handleSelectionChange,onTabbingStart:e.handleTabbingStart,selection:W,tilesPerRow:Ee,sectionStartIndices:ge.sectionStartIndices},function(t){var o=t.handleDeselect,n=t.handleDeselectAll,d=t.handleFocusFile,u=t.handleSelect,h=t.handleSelectAll;return i.default.createElement("div",null,i.default.createElement(a.Table,{columnFlex:_.GRID_VIEW_COLUMN_FLEX},v),i.default.createElement(w.FilesViewTileGrid,{onDelete:r,disabledMultiselect:le||!1,onShowRename:s,activeDropTarget:fe,arePostTTIModulesLoaded:se,createNewFolderState:y,context:C,deselectAll:n,dropTargetHighlightMode:R,fileRename:D,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:N,onAddFileJumpKeyCode:P,onResetFileJump:A,onTTI:e.handleTTI,items:O,isCreateFolderUIActive:e.isCreateFolderUIActive(),isDraggingExternalFiles:x,isDraggingInternalFiles:M,isQueryingFolderSizes:U,isSearchMode:L,onCopyToClipboard:e.handleCopyToClipboard,onDeselectFile:o,onDragEnter:e.handleDragEnter,onDragStart:e.handleDragStart,onFocusFile:d,onFocusSearchBar:T,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onNavigateToFileOrFolder:te,onOpenPaper:oe,onOpenKeyboardShortcutModal:Se,onPasteFromClipboard:p,onRenameCancel:c,onRenameSubmit:l,onSelectFile:u,onSetDropTarget:e.handleSetDropTarget,onSortChange:q,onStarClick:ne,onTilesPerRowChange:e.onTilesPerRowChange,path:V,ref:e.setFilesViewTileGridRef,sections:ge,selectAll:h,selectedFiles:H,selection:W,onSetFileUploaderPath:e.handleSetFileUploaderPath,thumbStore:me,tilesPerRow:Ee,totalNumItems:K,user:Y,viewType:J,starredState:e.props.starredState,hrefForFile:e.props.hrefForFile}))})}),i.default.createElement(F.InternalDragStatus,{className:"offscreen-drag-icon",files:H.toArray(),ref:this.setInternalDragStatusRef}))},D.defaultProps={dropTargetHighlightMode:d.DropTargetHighlightMode.NONE,enableUnity:!0,fileRename:null,loadingState:d.LoadingState.LOADING_FIRST_PAGE,fileExtensionsConfigs:{}},D.emptySections={sectionLabels:[],sectionStartIndices:[]},D})(i.default.PureComponent);t.FilesViewController=x}),define("modules/clean/react/files_view/culled_table_body",["require","exports","tslib","spectrum/table","react"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importDefault(s);var n=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rangeInViewStartIndex=0,t.rangeInViewEndIndex=0,t.handleRangeInView=function(e,r){var o="scrollingElement"in document&&document.scrollingElement?document.scrollingElement.scrollTop:document.documentElement.scrollTop,s=window.innerHeight-t.props.viewportTopOffset,n=t.props.listItemHeight,a=t.props.items.length,i=a*n;t.rangeInViewStartIndex=Math.floor(o/i*a),t.rangeInViewEndIndex=Math.ceil((o+s||1)/i*a)-1},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.scrollToRow&&this.updateScroll(this.props.scrollToRow)},t.prototype.componentWillReceiveProps=function(e){this.props.scrollToRow!==e.scrollToRow&&e.scrollToRow!==-1&&this.updateScroll(e.scrollToRow)},t.prototype.updateScroll=function(e){var t=this.props,r=t.listItemHeight,o=t.viewportTopOffset;if(e<=this.rangeInViewStartIndex||e>=this.rangeInViewEndIndex){var s=document.body.scrollTop,n=window.innerHeight-o,a=(e+1)*r,i=e*r,l=0;l=i>s?Math.abs(n-a):a-r,window.scrollTo(0,l)}},t.prototype.render=function(){var e=this.props,t=e.viewportTopOffset,n=r.__rest(e,["viewportTopOffset"]);return s.default.createElement(o.CulledTableBody,r.__assign({onRangeInView:this.handleRangeInView,viewportHeight:window.innerHeight-t},n))},t.defaultProps={viewportTopOffset:0},t})(s.default.PureComponent);t.CulledTableBodyWithScrollToRow=n}),define("modules/clean/react/files_view/data/action_creators",["require","exports","tslib","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors","modules/clean/react/files_view/data/types","modules/clean/storage","modules/core/cookies"],function(e,t,r,o,s,n,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s);t.setViewType=function(e){var t=e.viewType;return function(e,r){i.Cookies.delete(o.VIEW_TYPE_COOKIE_NAME),i.Cookies.create(o.VIEW_TYPE_COOKIE_NAME,t,1095),e({type:n.ActionTypes.SET_VIEW_TYPE,payload:{viewType:t}})}},t.loadViewType=function(){return function(e,t){var r=i.Cookies.read(o.VIEW_TYPE_COOKIE_NAME);null!==r&&r!==s.viewType(t())&&e({type:n.ActionTypes.SET_VIEW_TYPE,payload:{viewType:r}})}},t.setViewTypeColumns=function(e){var t=e.columns,i=e.viewType,l=e.user;return function(e,c){a.UserLocalStorage.set(l.id,o.COLUMNS_STORAGE_KEY+"_"+i,t);var d=r.__assign({},s.viewTypeColumns(c()),(u={},u[i]=t,u));e({type:n.ActionTypes.SET_VIEW_TYPE_COLUMNS,payload:{viewTypeColumns:d}});var u}},t.loadViewTypeColumns=function(e){var t=e.user;return function(e,i){var l=s.viewTypeColumns(i());o.AllViewTypes.forEach(function(e){var s=a.UserLocalStorage.get(t.id,o.COLUMNS_STORAGE_KEY+"_"+e);s&&(l=r.__assign({},l,(n={},n[e]=s,n)));var n}),e({type:n.ActionTypes.SET_VIEW_TYPE_COLUMNS,payload:{viewTypeColumns:l}})}}}),define("modules/clean/react/files_view/data/reducer",["require","exports","tslib","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/types","modules/clean/react/files_view/types"],function(e,t,r,o,s,n){"use strict";function a(e,r){switch(void 0===e&&(e=t.defaultFilesViewState),r.type){case s.ActionTypes.SET_VIEW_TYPE:return i(e,r.payload);case s.ActionTypes.SET_VIEW_TYPE_COLUMNS:return l(e,r.payload)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFilesViewState={viewType:n.ViewType.List,viewTypeColumns:(c={},c[n.ViewType.List]=o.LIST_VIEW_COLUMNS,c[n.ViewType.Grid]=o.GRID_VIEW_COLUMNS,c[n.ViewType.LargeGrid]=o.GRID_VIEW_COLUMNS,c)};var i=function(e,t){var o=t.viewType;return r.__assign({},e,{viewType:o})},l=function(e,t){var o=t.viewTypeColumns;return r.__assign({},e,{viewTypeColumns:o})};t.filesViewReducer=a;var c}),define("modules/clean/react/files_view/data/selectors",["require","exports","modules/clean/react/files_view/data/reducer","modules/clean/redux/selectors","modules/clean/redux/types"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return o.getStateAtNamespace(e,s.FILES_VIEW_NAMESPACE_KEY)||r.defaultFilesViewState};t.viewType=function(e){return n(e).viewType},t.viewTypeColumns=function(e){return n(e).viewTypeColumns}}),define("modules/clean/react/files_view/data/store",["require","exports","modules/clean/react/files_view/data/reducer","modules/clean/redux/store","modules/clean/redux/types","modules/clean/react/app_actions/data/reducer"],function(e,t,r,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a;t.getStoreForFilesView=function(){return a||(a=o.getStoreAndRegisterReducers((e={},e[s.FILES_VIEW_NAMESPACE_KEY]=r.filesViewReducer,e[s.EXTENSIONS_NAMESPACE_KEY]=n.extensionsReducer,e))),a;var e}}),define("modules/clean/react/files_view/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.SET_VIEW_TYPE="FILES_VIEW/SET_VIEW_TYPE",e.SET_VIEW_TYPE_COLUMNS="FILES_VIEW/SET_VIEW_TYPE_COLUMNS"})(t.ActionTypes||(t.ActionTypes={}))}),define("modules/clean/react/files_view/file_grouper",["require","exports","modules/core/i18n","modules/clean/datetime","modules/clean/react/browse/constants","modules/clean/react/files_view/types","modules/clean/react/browse/models"],function(e,t,r,o,s,n,a){"use strict";function i(e){return e instanceof a.File?a.File.getCategoryDescription(e,!0):s.ExtensionCategories.DOCUMENT}function l(e){return e instanceof a.File?e.is_dir?s.FileTypeCapitalizedCategoryTranslations.FOLDER:a.File.getExtension(e).toUpperCase():u}function c(e){return e instanceof a.File&&e.ts?1e3*e.ts:e instanceof a.Paper?Date.parse(e.last_modified_date):0}function d(e,t,s){var a=[],d=[],h=null;if(t===n.SortField.CATEGORY)e.forEach(function(e,t){if(e){var r=i(e);r!==h&&(a.push(r),d.push(t),h=r)}});else if(t===n.SortField.EXTENSION)e.forEach(function(e,t){if(e){var r=l(e);if(r!==h){var o=r;""===r&&(o=u),a.push(o),d.push(t),h=r}}});else if(t===n.SortField.MODIFIED)if(s===n.SortDirection.DESCENDING){var f=o.getTimeBands(Date.now());e.forEach(function(e,t){if(e){var o,s=c(e);o=s>=f.today?r._("Today"):s>=f.yesterday?r._("Yesterday"):s>=f.thisWeek?r._("This week"):s>=f.lastWeek?r._("Last week"):s>=f.thisMonth?r._("This month"):s>=f.lastMonth?r._("Last month"):s>=f.lastThreeMonths?r._("Three months ago"):r._("Older"),o!==h&&(a.push(o),d.push(t),h=o)}})}else e.forEach(function(e,t){if(e){var r;if(c(e)){var s=new Date(c(e)),n=s.getMonth(),i=s.getFullYear();r=o.month_with_year(n,i)}else r=p;r!==h&&(a.push(r),d.push(t),h=r)}});return{sectionLabels:a,sectionStartIndices:d}}Object.defineProperty(t,"__esModule",{value:!0});var u=r._("Extensionless",{comment:"Label for files without extensions like .txt or .png"}),p=r._("Missing dates",{comment:"label for group of files without dates marking when they are created or modified"});t.getSections=d}),define("modules/clean/react/files_view/file_name_cell",["require","exports","tslib","external/classnames","spectrum/media_table","react","modules/clean/browse_interface","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/files_view/constants","modules/clean/react/files_view/types","modules/clean/react/files_view/name_input","modules/clean/react/files_view/star","modules/clean/react/files_view/util","modules/clean/react/browse/models","modules/clean/react/icon/file_folder_icon","modules/clean/filename_highlights","modules/clean/user_education/react/user_education_effect","modules/core/i18n","modules/clean/react/title_bubble","modules/clean/em_string","spectrum/dimensions"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S,g,E,v,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),i=r.__importStar(i);var F=(function(e){function t(r){var o=e.call(this,r)||this;return o._thumbRequestId=null,o.handleNameInputSubmit=function(e){o.props.onRenameSubmit(o.props.file,e)},o.handleNameInputCancel=function(){o.props.onRenameCancel(o.props.file)},o.handleOnClickNameInput=function(e){e.stopPropagation()},o.handleOnClickName=function(e){o.props.isTextSelectable||o.props.isSelectMode||h.shouldHandleClick(e)&&(e.preventDefault(),e.stopPropagation(),o.props.onNavigateToFileOrFolder(o.props.file))},o.handleOnClickLocationLink=function(e){var t=o.props,r=t.file,s=t.onLocationLinkClick,n=!h.shouldHandleClick(e);n||(e.preventDefault(),e.stopPropagation()),s&&s(r,n)},o.updateFilenameCellBufferIfNeeded=function(){var e=o._filenameContainerDiv;if(e){var t=e.getElementsByClassName("brws-file-name-cell-star");if(t&&t.length>0){var r=t.item(0).clientWidth;o.state.filenameCellBuffer!==r&&o.setState({filenameCellBuffer:r})}}},o.handleThumbnailError=function(){o.setState({thumbLoaded:!1})},o._setFilenameRef=function(e){return o._filenameDiv=e},o._setFilenameContainerRef=function(e){return o._filenameContainerDiv=e},o.onStarClick=function(e){var t=o.props,r=t.file,s=t.onStarClick;s&&s(r,e)},o.state={shouldShowTooltip:o.shouldShowTooltip(r),thumbLoaded:t.isThumbLoaded(r),filenameCellBuffer:24},o}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.fetchThumbnail(this.props)},t.prototype.componentDidUpdate=function(e,t){var r=this.shouldShowTooltip(this.props);r!==t.shouldShowTooltip&&this.setState({shouldShowTooltip:r}),this.updateFilenameCellBufferIfNeeded()},t.prototype.componentWillReceiveProps=function(e){var t=this.shouldShowTooltip(e);t!==this.state.shouldShowTooltip&&this.setState({shouldShowTooltip:t}),e.file.thumbnail_url_tmpl!==this.props.file.thumbnail_url_tmpl&&(this.unbindThumbnailIfNeeded(),this.fetchThumbnail(e))},t.prototype.componentWillUnmount=function(){this.unbindThumbnailIfNeeded()},t.prototype.shouldShowTooltip=function(e){var t=this._filenameDiv,r=i.filename(e.file.fq_path);return!!(e.showTooltip&&t&&(t.offsetWidth<t.scrollWidth||t.textContent!==r))},t.isThumbLoaded=function(e){var t=e.file,r=e.thumbStore,o=t.thumbnail_url_tmpl;return!(!o||!r.get_thumb(o))},t.prototype.fetchThumbnail=function(e){var t=this,r=e.file,o=e.thumbStore,s=r.thumbnail_url_tmpl;s&&(this._thumbRequestId=o.bind_url(s,{onSuccess:function(){t.setState({thumbLoaded:!0})},onError:function(){t.handleThumbnailError()}}))},t.prototype.unbindThumbnailIfNeeded=function(){var e=this.props.thumbStore;this._thumbRequestId&&(e.unbind_url(this._thumbRequestId),this._thumbRequestId=null),this.setState({thumbLoaded:!1})},t.prototype.renderThumbnail=function(){var e=this.props,t=e.file,r=e.thumbStore,s=t.thumbnail_url_tmpl,a=t.fq_path;if(this.state.thumbLoaded&&s){var i=r.get_thumb(s);if(i)return n.default.createElement("img",{alt:a,draggable:!1,className:o.default("brws-file-name-cell-icon","brws-file-name-cell-thumb"),src:i,onError:this.handleThumbnailError})}return this.renderFileIcon()},t.prototype.renderFileIcon=function(){var e=this.props,t=e.file,r=e.showCDMUserEducationEffects,o=n.default.createElement(m.FileOrFolderIcon,{className:"brws-file-name-cell-icon",ref:"icon",file:t,onClick:this.handleOnClickName,showPreview:!1});return r?n.default.createElement(S.UserEducationEffect,{containerName:"FileItemRow",name:"TMFIcon",useSpan:!0},o):o},t.prototype.renderScreenReaderExtraInfo=function(){var e=[],t=this.props,r=t.file,o=t.isSelected;if(r.isDeleted&&e.push(g._("Deleted")),o&&e.push(g._("Selected")),r.is_dir&&(r.type===l.FileTypes.SHARED_FOLDER?f.File.isReadOnlySharedFolder(r)?e.push(g._("Read-only shared folder")):e.push(g._("Shared folder")):r.type===l.FileTypes.TEAM_SHARED_FOLDER?f.File.isReadOnlySharedFolder(r)?e.push(g._("Read-only team shared folder")):e.push(g._("Team shared folder")):e.push(g._("Folder"))),e.length>0)return n.default.createElement("span",{className:"ax-visually-hidden"},""+e.join(" "))},t.prototype.splitTruncatedParts=function(e,t){for(var r=0;r<e.length&&e.charAt(r)===t.charAt(r);)++r;return r===e.length||"…"!==e.charAt(r)?[e]:[e.substring(0,r),e.substring(r+1)]},t.prototype.getHighlightedSpan=function(e,t){var r=i.filename(t.fq_path),o=this.splitTruncatedParts(e,r);if(1===o.length)return t.highlight_spans?_.highlightReactFromHighlightSpans(e,t.highlight_spans):_.highlightMatchReact(e,t.filename_highlights);var s,a;return t.highlight_spans?(s=_.highlightReactFromHighlightSpans(r,t.highlight_spans,0,o[0].length),a=_.highlightReactFromHighlightSpans(r,t.highlight_spans,r.lastIndexOf(o[1]))):(s=_.highlightMatchReact(r,t.filename_highlights,0,o[0].length),a=_.highlightMatchReact(r,t.filename_highlights,r.lastIndexOf(o[1]))),n.default.createElement("span",null,s,"…",a)},t.prototype.renderTitle=function(e){var t=this.props,r=t.file,o=t.renameState,s=t.user,a=t.hrefForFile;if(o===d.RenameState.SAVING_INPUT)return n.default.createElement("span",{role:"status"},g._("Renaming…"));var l,u=i.filename(r.fq_path),p=this.truncateTextInFilenameCell(u,14,4,e);if(l=this.props.showHighlights&&(r.filename_highlights||r.highlight_spans)?this.getHighlightedSpan(p,r):n.default.createElement("span",null,p),l=n.default.createElement("div",{className:"brws-file-name-element",ref:this._setFilenameRef},l),this.state.shouldShowTooltip){var h=u.length<=c.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH?u:n.default.createElement("div",{className:"brws-file-name-cell-tooltip"},u);l=n.default.createElement(E.TitleBubble,{content:h,position:E.TitleBubble.POSITIONS.BOTTOM,className:"list-label__title-bubble"},l)}if(!r.is_unmounted&&!r.isDeleted){var f=a(s,r);l=n.default.createElement("a",{className:"brws-file-name-cell-filename",href:f,onClick:this.handleOnClickName},l)}return this.props.showUserEducationEffects?n.default.createElement(S.UserEducationEffect,{containerName:"FileItemRow",name:this.props.userEducationEffectName||"FileNameLabel",useSpan:!0},l):l},t.prototype.renderSubtitle=function(e){var t=this.props,r=t.file,o=t.isSelectMode,s=t.renameState,l=t.renderLocationAsLink,c=t.showLocation,d=t.user;if(s||!c)return null;var u=i.parent_dir(r.fq_path),p="/"===u?a.get_browse_root_name(d):u.slice(1);if(r.is_unmounted)return g._("not added yet, in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:p});var h=g._("in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:p}),f=this.truncateTextInFilenameCell(h,12,6,e);if(!l||o||r.isDeleted)return f;var m=a.browse_uri_for_fq_path(d,u);return n.default.createElement("a",{className:"brws-file-name-cell-location",href:m.toString(),onClick:this.handleOnClickLocationLink},f)},t.prototype.truncateTextInFilenameCell=function(e,t,r,o){if(o&&o>this.state.filenameCellBuffer){var s=(o-this.state.filenameCellBuffer)/t,n=Math.max(r,s-r);return v.Emstring.em_snippet(e,Math.floor(n),.5)}return e},t.prototype.renderContent=function(e){var t,r=this.props,o=r.file,a=r.renameState;if(a===d.RenameState.PENDING_INPUT){var l=o.is_dir?g._("Rename directory…"):g._("Rename file…");t=n.default.createElement(u.NameInput,{defaultValue:i.filename(o.fq_path),label:l,onClick:this.handleOnClickNameInput,onSubmit:this.handleNameInputSubmit,onCancel:this.handleNameInputCancel,isDir:o.is_dir})}else t=[n.default.createElement(s.MediaCellText,{key:"title",highlight:this.props.isHovered},this.renderTitle(e),this.renderScreenReaderExtraInfo()),n.default.createElement(s.MediaCellText,{highlight:this.props.isHovered,key:"subtitle",variant:"subtitle"},this.renderSubtitle(e))];return t},t.prototype.renderStar=function(){var e=this.props,t=e.file,r=e.renameState,o=e.user,s=e.showStar,a=e.isSelectMode,i=e.isTabbing;return s&&!r?n.default.createElement(p.StarContainer,{item:t,user:o,className:"brws-file-name-cell-star brws-vertically-center",onStarClick:this.onStarClick,isReadOnly:a,isTabbing:i}):null},t.prototype.render=function(){var e=this,t=this.props.mediaActions,r=o.default("brws-file-name-cell-text","brws-vertically-center",{"brws-file-name-cell-text-rename":!!this.props.renameState});return this.props.shouldTruncateMiddleFilename?n.default.createElement(s.MediaCell,{icon:this.renderThumbnail()},n.default.createElement(w.Dimensions,{className:"brws-file-name-container"},function(t){var o=t.width;return n.default.createElement("div",{className:"brws-file-name-container",ref:e._setFilenameContainerRef},n.default.createElement("div",{className:r},e.renderContent(o)),e.renderStar())}),t):n.default.createElement(s.MediaCell,{icon:this.renderThumbnail()},n.default.createElement("div",{className:r},this.renderContent()),this.renderStar(),t)},t.defaultProps={renderLocationAsLink:!0},t})(n.default.Component);t.FileNameCell=F}),define("modules/clean/react/files_view/file_row",["require","exports","tslib","external/classnames","spectrum/button","spectrum/icon_table","spectrum/checkbox","spectrum/media_table","react","external/react-dom","modules/clean/react/files_view/file_name_cell","modules/clean/react/files_view/overflow_menu","modules/clean/react/files_view/types","modules/clean/react/files_view/share_button","modules/clean/react/files_view/util","modules/clean/react/browse/models","modules/clean/user_education/react/user_education_effect","modules/core/i18n","modules/clean/react/title_bubble","modules/core/browser","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/extensions/client","modules/core/exception"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S,g,E,v,w,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),l=r.__importDefault(l),c=r.__importStar(c),E=r.__importStar(E),F=r.__importStar(F);var T=function(){return l.default.createElement("span",{"aria-hidden":!0},"--")},b=function(e){var t=e.isVisible,r=e.onClick;return l.default.createElement(s.Button,{className:"brws-file-row-view-file-button","aria-label":S._("View File"),onClick:r,tabIndex:t?void 0:-1,variant:t?"secondary":"invisible"},l.default.createElement(n.IconTable,{name:"view"}))},y=function(){return l.default.createElement("svg",{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1"},l.default.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},l.default.createElement("g",{id:"Group",transform:"translate(2.000000, 2.000000)"},l.default.createElement("circle",{id:"Oval-65",cx:"8",cy:"8",r:"8"}),l.default.createElement("path",{d:"M8,13 L8,14.5 L5.5,12.5 L8,10.5 L8,12 C10.209139,12 12,10.209139 12,8 C12,6.93104698 11.5806921,5.96002857 10.8975817,5.24245012 L11.4674192,4.39763124 C12.4121861,5.30722218 13,6.58496544 13,8 C13,10.7614237 10.7614237,13 8,13 Z M8,3 L8,1.5 L10.5,3.5 L8,5.5 L8,4 C5.790861,4 4,5.790861 4,8 C4,8.96511539 4.34180174,9.8503987 4.91095749,10.5414022 L4.33270318,11.3986995 C3.5056268,10.5066799 3,9.3123877 3,8 C3,5.23857625 5.23857625,3 8,3 Z",id:"Oval-67",fill:"#637282"}))))},C=function(){return l.default.createElement("svg",{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1"},l.default.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},l.default.createElement("g",{id:"icon-warning",fill:"#637282"},l.default.createElement("path",{d:"M13.9298189,16.125 C16.4624689,16.125 17.5138484,14.3377448 16.2785476,12.1337797 L12.238298,4.92535765 C11.002815,2.72106753 8.99951926,2.72139251 7.76421846,4.92535765 L3.7239688,12.1337797 C2.48848585,14.3380698 3.54098311,16.125 6.07269759,16.125 L13.9298189,16.125 Z M11.002944,14.0995516 L8.99957244,14.0995516 L8.99957244,12.0741033 L11.002944,12.0741033 L11.002944,14.0995516 L11.002944,14.0995516 Z M11.002944,11.0613791 L8.99957244,11.0613791 L8.99957244,7.01048239 L11.002944,7.01048239 L11.002944,11.0613791 L11.002944,11.0613791 Z",id:"Shape"}))))},I=function(){return l.default.createElement("div",{className:"error-tooltip"},l.default.createElement("div",{className:"error-tooltip__title"},S._("This folder is too large")),S._("We can’t calculate the full size of this folder right now. This can happen when there are a large number of files inside of the folder or if the request takes too long."))},R=function(e){var t=e.file;if(!t.is_dir)return l.default.createElement("span",null,t.size);switch(t.fetchFolderSizesStatus){case p.FetchFolderSizeState.LOADING:return l.default.createElement("span",{className:"item-cell-title item-cell-title--loading"},l.default.createElement("span",{className:"ax-visually-hidden"},S._("Calculating folder sizes...")),l.default.createElement(y,null),S._("Calculating..."));case p.FetchFolderSizeState.ERROR:return l.default.createElement("span",{className:"item-cell-title"},l.default.createElement(g.TitleBubble,{content:l.default.createElement(I,null),position:g.TitleBubble.POSITIONS.TOP,isTargetPositionFixed:!1},l.default.createElement("span",{className:"item-cell-title item-cell-title--error"},l.default.createElement("span",{className:"ax-visually-hidden"},S._("Error in calculating folder sizes")),l.default.createElement(C,null))));case p.FetchFolderSizeState.COMPLETE:return l.default.createElement("span",{className:"item-cell-title"},t.size);default:return l.default.createElement(T,null)}},D=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isActionDropdownOpen:!1},t.checkboxRef=null,t.handleClick=function(e){if(t.checkboxRef&&c.findDOMNode(t.checkboxRef).contains(e.target))return void e.preventDefault();if(t.props.isSelectMode&&t.props.onDeselect&&t.props.onSelect){e.preventDefault();var r=t.props.file.fq_path;return void(t.props.isSelected?t.props.onDeselect(r,e.shiftKey):t.props.onSelect(r,e.shiftKey))}t.handleOpenNewTabOrNavigate(e)},t.handleOpenNewTabOrNavigate=function(e){if(0===e.button){if(e.preventDefault(),e.stopPropagation(),f.hasModifierKey(e)){var r=t.props,o=r.file,s=r.user,n=r.hrefForFile;return void E.open_tab(n(s,o))}t.props.onNavigateToFileOrFolder(t.props.file)}},t.handleChangeCheckbox=function(e,r){if(t.props.onSelect&&t.props.onDeselect){var o=t.props.file.fq_path;"checked"===e?t.props.onSelect(o,r.shiftKey):t.props.onDeselect(o,r.shiftKey)}},t.handleDragEnter=function(e){var r=t.props,o=r.file,s=r.isSelected,n=r.isActiveDropTarget;t.props.onDragEnter(e,o,!!s,!!n)},t.handleDragStart=function(e){var r=t.props,o=r.file,s=r.isSelected,n=r.onDragStart,a=r.onSelect;n&&(s?n(e):(a&&a(o.fq_path),n(e,[o])))},
t.setCheckboxRef=function(e){t.checkboxRef=e},t.onActionDropdownOpen=function(){t.setState({isActionDropdownOpen:!0})},t.onActionDropdownClose=function(){t.setState({isActionDropdownOpen:!1})},t.rowChildFn=function(e){var r,s=e.isHovered,n=t.props,c=n.isCompactMode,d=n.isPinned,u=n.isSelectMode,p=n.isSelected,h=n.showUserEducationEffects,f=n.isTabbing,m=n.visibleColumns;if(!d){var S=!(f||s||p||u||c);r=l.default.createElement(a.Checkbox,{disabled:t.props.isCheckboxDisabled,checked:p?"checked":"unchecked",className:o.default("brws-checkbox",{"brws-checkbox-checked":p}),onChange:t.handleChangeCheckbox,ref:t.setCheckboxRef,variant:S?"invisible":"default"}),h&&(r=l.default.createElement(_.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox",useSpan:!0},r))}return[l.default.createElement(i.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},l.default.createElement("div",{className:"brws-vertically-center"},r))].concat(m.map(function(e,r){return t.renderCell({isHovered:s,isLastCell:r===m.length-1,sortField:e.sortField,renderCell:e.renderCell})}))},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(e){var t=this;(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected)&&this.checkboxRef&&Promise.resolve().then(function(){if(t.checkboxRef){var e=c.findDOMNode(t.checkboxRef);e&&e.focus()}})},t.prototype.renderMediaActions=function(e){var t=this.props,o=t.file,s=t.isCompactMode,n=t.isSelected,a=t.isSelectMode,c=t.isSearchMode,d=t.isSharingDisabled,p=t.isTabbing,f=t.getOverflowMenuActions,m=t.canDisplayFolderSizes,_=t.arePostTTIModulesLoaded,g=t.onShowShare,E=t.shareButtonLabel,w=t.showShareButton,F={file:o,onShowShare:g,shareButtonLabel:E,showShareButton:w},T=c?"search":"browse";if(a)return l.default.createElement(i.MediaActions,null,!d&&l.default.createElement(h.ShareButton,r.__assign({},F,{isVisible:!s&&(n||e),isSearchMode:this.props.isSearchMode,useSearchSuccessBanner:this.props.useSearchSuccessBanner})),!s&&(e||n)&&this.props.extensionsConfig.showMenu?l.default.createElement(v.AppActionsMenu,{buttonText:S._("Open with ▾"),extensionsConfig:this.props.extensionsConfig,file:this.props.file,onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,user:this.props.user,telemetryContext:{surface:T}}):null,l.default.createElement(b,{isVisible:n||s||e,onClick:this.handleOpenNewTabOrNavigate}));var y=null;return _&&(y=l.default.createElement(u.FilesViewOverflowMenu,{file:o,getOverflowMenuActions:f,showBorders:p||e,canDisplayFolderSizes:m,viewportTopOffset:this.props.viewportTopOffset})),l.default.createElement(i.MediaActions,null,!d&&l.default.createElement(h.ShareButton,r.__assign({},F,{isVisible:p||e&&!s||this.state.isActionDropdownOpen,isSearchMode:this.props.isSearchMode,useSearchSuccessBanner:this.props.useSearchSuccessBanner})),(p||e&&!s||this.state.isActionDropdownOpen)&&this.props.extensionsConfig.showMenu?l.default.createElement(v.AppActionsMenu,{buttonText:S._("Open with ▾"),extensionsConfig:this.props.extensionsConfig,file:this.props.file,onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,user:this.props.user,telemetryContext:{surface:T}}):null,y)},t.prototype.renderModifiedCell=function(e,t){var r=e.is_dir&&!this.props.isSearchMode?void 0:e.ago,o=e.last_modified_name||void 0,s=o&&S._("by %(modified_by)s",{comment:"name of the person that modified the file"}).format({modified_by:o});return l.default.createElement(i.MediaCell,{className:"brws-file-modified-at-cell",key:"modifiedAt",subtitle:s,title:r||l.default.createElement(T,null)},t)},t.prototype.renderCell=function(e){var t=e.isHovered,r=e.isLastCell,o=e.sortField,s=e.renderCell,n=this.props,a=n.file,c=n.user,u=n.isCompactMode,h=n.isSearchMode,f=n.isSelectMode,_=n.isTabbing,S=n.arePostTTIModulesLoaded,g=n.renameState,E=n.showCDMUserEducationEffects,v=n.showUserEducationEffects,w=n.userEducationEffectName,b=n.onLocationLinkClick,y=n.onNavigateToFileOrFolder,C=n.onRenameCancel,I=n.onRenameSubmit,D=n.onStarClick,N=n.thumbStore,P=n.hrefForFile,A=r&&!(u&&g),O=A?this.renderMediaActions(t):void 0;if(s)return s({file:a,mediaActions:O});switch(o){case p.SortField.FILENAME:return l.default.createElement(d.FileNameCell,{key:"fileName",user:c,file:a,isHovered:t,isSelectMode:f,isTabbing:_,mediaActions:O,onNavigateToFileOrFolder:y,onLocationLinkClick:b,onRenameCancel:C,onRenameSubmit:I,renameState:g,showCDMUserEducationEffects:E,showTooltip:S,showHighlights:h,showLocation:h,showUserEducationEffects:v,userEducationEffectName:w,showStar:S&&!m.File.isNoAccessSharedFolder(a),onStarClick:D,thumbStore:N,shouldTruncateMiddleFilename:S,hrefForFile:P});case p.SortField.MODIFIED:return this.renderModifiedCell(a,O);case p.SortField.SHARED_WITH:return l.default.createElement(i.MediaCell,{className:"brws-file-shared-with-cell",key:"sharedWith"},this.props.renderSharedWithController(a),O);case p.SortField.CATEGORY:return l.default.createElement(i.MediaCell,{className:"brws-file-category-cell",key:"category",title:m.File.getCategoryDescription(a)},O);case p.SortField.EXTENSION:return l.default.createElement(i.MediaCell,{className:"brws-file-extension-cell",key:"extension",title:m.File.getExtension(a)},O);case p.SortField.SIZE:return l.default.createElement(i.MediaCell,{className:"brws-file-size-cell",key:"size",title:l.default.createElement(R,{file:a})},O);default:return F.reportException({err:new Error("renderCell function for "+o+"is not implemented"),severity:F.SEVERITY.NONCRITICAL,tags:["js:browse"]}),l.default.createElement(T,null)}},t.prototype.render=function(){var e=this.props,t=e.file,s=e.isActiveDropTarget,n=e.isAvailableDropTarget,a=e.isPinned,c=e.isSearchMode,d=e.isSelected,u=e.renameState,p=e.rowIndex,h=e.tabIndex,f=e.topOffset,_=o.default("brws-file-row",{"brws-file-row-selected":d,"brws-file-row-deleted":t.isDeleted,"brws-file-row-droppable":n&&!s,"brws-file-row-dragover":s,"brws-file-row-no-access":m.File.isNoAccessSharedFolder(t),"brws-file-row-pinned":a}),S=s?"dragover":n&&!s?"droppable":d?"selected":"default",g=!(u||c||m.File.isTeamMemberFolder(t)||m.File.isReadOnlySharedFolder(t)||m.File.isNoAccessSharedFolder(t)),E={"aria-rowindex":void 0!==p?p+1:void 0,className:_,"data-filename":t.fq_path.split("/").slice(-1),onClick:this.handleClick,onDragEnter:this.handleDragEnter,tabIndex:h,variant:S};return a?l.default.createElement(i.MediaRow,r.__assign({},E),this.rowChildFn):l.default.createElement(i.CulledMediaRow,r.__assign({},E,{draggable:g,topOffset:f,onDragStart:this.handleDragStart}),this.rowChildFn)},t.defaultProps={isSelectionEmpty:!0,topOffset:0,extensionsConfig:w.emptyExtensionsConfig()},t})(l.default.PureComponent);t.FileRow=D}),define("modules/clean/react/files_view/fixed_table_head",["require","exports","tslib","spectrum/vertically_fixed","spectrum/table","react"],function(e,t,r,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),t.FixedTableHead=function(e){var t=e.children,a=e.offsetHeight,i=r.__rest(e,["children","offsetHeight"]);return n.default.createElement("thead",r.__assign({className:"mc-table-head mc-table-head-fixed brws-column-header"},i),n.default.createElement(o.VerticallyFixed,{tag:function(e){var o=e.style;return n.default.createElement(s.TableRow,{className:"mc-table-head-row mc-table-head-row-fixed",style:r.__assign({height:a},o)},t)}}))}}),define("modules/clean/react/files_view/internal_drag_status",["require","exports","tslib","external/classnames","react","modules/clean/react/icon/file_folder_icon"],function(e,t,r,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),s=r.__importDefault(s);var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,r=e.files,a=o.default("active",t);return s.default.createElement("div",{id:"drag-status",className:a},s.default.createElement("div",{id:"drag-selection-status"},r.slice(0,4).map(function(e,t){return e.thumbnail_url_tmpl?s.default.createElement("img",{key:t,src:e.thumbnail_url_tmpl,className:"icon icon"+t,alt:""}):s.default.createElement(n.FileOrFolderIcon,{key:t,file:e,className:"icon icon"+t})}),s.default.createElement("span",{className:"badge"},r.length)))},t})(s.default.PureComponent);t.InternalDragStatus=a}),define("modules/clean/react/files_view/list",["require","exports","tslib","react","modules/clean/react/files_view/drag_and_drop","modules/clean/react/files_view/constants","modules/clean/react/files_view/culled_table_body","modules/clean/react/files_view/file_row","modules/clean/react/files_view/new_folder_row","modules/clean/react/files_view/paper_row","modules/clean/react/files_view/selectors","modules/clean/react/files_view/keyboard_shortcuts","modules/clean/react/browse/models","modules/clean/react/extensions/client"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var f=function(){},m=(function(t){function m(){var r=null!==t&&t.apply(this,arguments)||this;return r.state={scrollToRow:0},r.handleFileViewerUnmount=function(){var e=r.props.selectedFiles.first();e&&r.props.onFocusFile(e.fq_path)},r.getIsListEvent=function(e){return r.props.isSelectableListEvent()&&(!(e.target instanceof Element)||"BUTTON"!==e.target.tagName)},r.getSelectedFiles=function(){return r.props.selectedFiles},r.handleNavigateToFileOrFolder=function(e){r.props.onNavigateToFileOrFolder(e,r.handleFileViewerUnmount)},r.enableContextMenu=function(){return!1},r.getActiveDropTarget=function(){return r.props.activeDropTarget},r.getIsDraggingInternalFiles=function(){return!!r.props.isDraggingInternalFiles},r.getIsDraggingExternalFiles=function(){return!!r.props.isDraggingExternalFiles},r.renderRow=function(t,s,n){if("NewFolderRow"===t.type)return o.default.createElement(l.NewFolderRow,{createNewFolderState:t.props.createNewFolderState,isInsideMyTeamFolderTree:t.props.isInsideMyTeamFolderTree,onCancel:r.props.onNewFolderCancel,onSubmit:r.props.onNewFolderSubmit,rowIndex:s,topOffset:n});if("PaperRow"===t.type)return o.default.createElement(c.PaperRow,{paper:t.props.paper,rowIndex:s,topOffset:n,user:r.props.user,visibleColumns:t.props.visibleColumns,onOpenPaper:r.props.onOpenPaper,arePostTTIModulesLoaded:t.props.arePostTTIModulesLoaded});var a=r.props,d=a.selection,u=a.starredState,f=t.props.file,m=d.selected.last()===t.props.file.fq_path||!d.selected.size&&0===s?0:void 0,_=0===s||r.props.user.is_cdm_member&&(2===s||1===s),S=t.props.extensionsConfig;S||(S=h.emptyExtensionsConfig());var g=void 0;if(u){g=u[e("modules/clean/react/starred/browse_exports").HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID+":"+f.file_id]}return o.default.createElement(i.FileRow,{extensionsConfig:S,context:r.props.context,file:f,getOverflowMenuActions:r.props.getOverflowMenuActions,isActiveDropTarget:t.props.isActiveDropTarget,isCheckboxDisabled:t.props.isCheckboxDisabled,isAvailableDropTarget:t.props.isAvailableDropTarget,isCompactMode:t.props.isCompactMode,isFocused:t.props.isFocused,isSearchMode:t.props.isSearchMode,isSelectMode:t.props.isSelectMode,isSelected:t.props.isSelected,arePostTTIModulesLoaded:t.props.arePostTTIModulesLoaded,isSharingDisabled:t.props.isSharingDisabled,isTabbing:t.props.isTabbing,key:f.fq_path,onDeselect:r.props.onDeselectFile,onDragStart:r.props.onDragStart,onDragEnter:r.props.onDragEnter,onLocationLinkClick:r.props.onLocationLinkClick,onNavigateToFileOrFolder:r.handleNavigateToFileOrFolder,onRenameCancel:r.props.onRenameCancel,onRenameSubmit:r.props.onRenameSubmit,onSelect:r.props.onSelectFile,onStarClick:r.props.onStarClick,renameState:t.props.renameState,rowIndex:s,showUserEducationEffects:_,userEducationEffectName:_?"FileNameLabel-"+s:void 0,showCDMUserEducationEffects:p.File.isTeamMemberFolder(f),tabIndex:m,topOffset:n,user:r.props.user,visibleColumns:r.props.visibleColumns,canDisplayFolderSizes:r.props.canDisplayFolderSizes,thumbStore:r.props.thumbStore,renderSharedWithController:r.props.renderSharedWithController,hrefForFile:r.props.hrefForFile,onShowShare:r.props.onShowShare,shareButtonLabel:r.props.shareButtonLabel,showShareButton:r.props.showShareButton,starredLoadingState:g,viewportTopOffset:r.props.viewportTopOffset,useSearchSuccessBanner:r.props.useSearchSuccessBanner})},r}return r.__extends(m,t),m.prototype.componentDidMount=function(){var e=this.props.onTTI;e&&e(),this.setupKeyboardShortcuts(),this.setupExternalDragHandler(),this.props.selectedFiles.size&&!this.props.isFileViewerShown()&&this.setState({scrollToRow:this.getRowIndexForFile(this.props.selectedFiles.first())})},m.prototype.componentWillReceiveProps=function(e){this.props.scrollToRow!==e.scrollToRow&&this.setState({scrollToRow:e.scrollToRow})},m.prototype.componentDidUpdate=function(e){e.createNewFolderState===this.props.createNewFolderState||"PENDING_INPUT"!==this.props.createNewFolderState||this.props.isFileViewerShown()||this.setState(function(e){return 0===e.scrollToRow?(window.scrollTo(0,0),{scrollToRow:e.scrollToRow}):{scrollToRow:0}})},m.prototype.componentWillUnmount=function(){this.cleanupKeyboardShortcuts(),s.cleanupExternalDragHandler(this.props.keyScope)},m.prototype.getRowIndexForFile=function(e){return this.props.items.indexOf(e)},m.prototype.cleanupKeyboardShortcuts=function(){u.resetFilesViewKeyboardShortcuts(this.props.keyScope),u.resetFileJumpKeyboardShortcuts(this.props.keyScope)},m.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props,r=t.onDelete,o=t.onShowRename,s=t.getIsFileJumping,n=t.onAddFileJumpKeyCode,a=t.onResetFileJump,i=t.keyScope,l=t.onCopyToClipboard,c=t.onNavigateToParentFolder,d=t.onPasteFromClipboard;u.setupFileJumpKeyboardShortcuts({scope:i,getIsFileJumping:s,onAddFileJumpKeyCode:n,onResetFileJump:a}),u.setupFilesViewListKeyboardShortcuts({getIsGlobalEvent:this.getIsGlobalEvent(),getIsItemEvent:this.getIsListEvent,getSelectedFiles:this.getSelectedFiles,isCurrentPathWriteable:this.props.getIsCurrentPathWriteable,enableContextMenu:this.enableContextMenu,selectAllAction:f,deselectAllAction:f,onCopyToClipboard:l,onDelete:r,onFocusSearchBar:this.props.onFocusSearchBar,onNavigateToFileOrFolder:this.handleNavigateToFileOrFolder,onNavigateToParentFolder:c,onPasteFromClipboard:d,onShowRename:o,openContextMenuAtPosition:f,scope:i,onShowHelpMenu:function(){return e.props.onOpenKeyboardShortcutModal()}})},m.prototype.setupExternalDragHandler=function(){s.setupExternalDragHandler(this.props.keyScope,this.getIsDraggingInternalFiles,this.getIsDraggingExternalFiles,this.props.onSetFileUploaderPath,".brws-file-row",this.getActiveDropTarget,this.props.onSetDropTarget)},m.prototype.getIsGlobalEvent=function(){return u.generateGetIsGlobalEvent(this)},m.prototype.render=function(){var e=this.props,t=e.scrollPositionOffset,r=e.viewportTopOffset;return o.default.createElement(a.CulledTableBodyWithScrollToRow,{items:d.getFilesViewListRowItems(this.props),listItemHeight:n.DEFAULT_ROW_HEIGHT,renderRow:this.renderRow,scrollPositionOffset:t,scrollToRow:this.state.scrollToRow,shouldUseWindowAsScrollContainer:!0,viewportTopOffset:r})},m.defaultProps={isFileViewerShown:function(){return!1}},m})(o.default.PureComponent);t.FilesViewList=m}),define("modules/clean/react/files_view/new_folder_row",["require","exports","tslib","spectrum/media_table","spectrum/table","react","spectrum/icon_content","modules/clean/react/files_view/name_input","modules/core/i18n"],function(e,t,r,o,s,n,a,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),t.NewFolderRow=function(e){var r,a=e.createNewFolderState,c=e.isInsideMyTeamFolderTree,d=void 0!==c&&c,u=e.onCancel,p=e.onSubmit,h=e.rowIndex,f=e.topOffset;r="SAVING_INPUT"===a?n.default.createElement("p",{className:"brws-new-folder-row-status",role:"status","aria-live":"polite"},l._("Creating new folder…")):n.default.createElement(i.NameInput,{defaultValue:"",label:l._("Folder name"),onSubmit:p,onCancel:u});var m=n.default.createElement(t.NewFolderIcon,{isInsideMyTeamFolderTree:d});return n.default.createElement(o.CulledMediaRow,{"aria-rowindex":void 0!==h?h+1:void 0,className:"brws-new-folder-row",topOffset:f},n.default.createElement(s.TableCell,{className:"brws-checkbox-cell"}),n.default.createElement(o.MediaCell,{icon:m},n.default.createElement("div",{className:"brws-new-folder-row-content brws-vertically-center"},r)),n.default.createElement(s.TableCell,null),n.default.createElement(s.TableCell,null))},t.NewFolderIcon=function(e){var t=e.isInsideMyTeamFolderTree,r=e.className||"";return n.default.createElement(a.IconContent,{className:r,name:t?"folder_team-small":"folder-small"})}}),define("modules/clean/react/files_view/paper_row",["require","exports","tslib","react","spectrum/media_table","modules/clean/paper_formatting_utils","modules/clean/react/files_view/star","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/core/i18n","modules/core/browser"],function(e,t,r,o,s,n,a,i,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),d=r.__importStar(d);var u=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleClick=function(e){if(0===e.button){e.preventDefault(),e.stopPropagation();var t=r.props.paper;if(l.hasModifierKey(e))return void d.open_tab(t.url);r.props.onOpenPaper(t)}},r.state=r.calcState(t),r}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.paper.title!==e.paper.title||this.props.paper.highlight_spans!==e.paper.highlight_spans){var t=this.calcState(e);this.setState(t)}},t.prototype.calcState=function(e){return{titleParts:n.getPaperDocTitleParts(e.paper,"brws-file-name-cell-icon","brws-file-name-cell-icon-emoji")}},t.prototype.renderDocName=function(e){var t=this.props,r=t.paper,n=t.showHighlights,i=t.user,l=t.arePostTTIModulesLoaded,d=this.state.titleParts,u=d.title,p=d.highlightedTitle,h=d.icon,f=o.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:r.url,onClick:this.handleClick},n?p:o.default.createElement("span",null,u)),m=l?o.default.createElement(a.StarContainer,{item:r,user:i,key:"paperStar",className:"brws-file-name-cell-star brws-vertically-center"}):null;return o.default.createElement(s.MediaCell,{highlight:e,icon:h,key:"docName"},o.default.createElement("div",{className:"brws-paper-doc-name-cell-content brws-vertically-center"},o.default.createElement(s.MediaCellText,{highlight:e},f),o.default.createElement(s.MediaCellText,{highlight:e,variant:"subtitle"},c._("in Paper",{comment:"The Dropbox Paper page"}))),m)},t.prototype.renderDocInfo=function(){var e=this.props.paper,t=e.last_modified_date||"",r=c._("by %(modified_by)s",{comment:"name of the person that modified the file"}).format({modified_by:e.last_editor_name||e.creator_name});return o.default.createElement(s.MediaCell,{key:"docInfo",subtitle:r,title:t})},t.prototype.renderCell=function(e){var t=e.isHovered,r=e.sortField;switch(r){case i.SortField.FILENAME:return this.renderDocName(t);case i.SortField.MODIFIED:return this.renderDocInfo();default:return o.default.createElement(s.MediaCell,{key:r,title:o.default.createElement("span",{"aria-hidden":!0},"--")})}},t.prototype.render=function(){var e=this,t=this.props,r=t.rowIndex,n=t.topOffset,a=t.visibleColumns;return o.default.createElement(s.CulledMediaRow,{"aria-rowindex":void 0!==r?r+1:void 0,className:"brws-paper-row",draggable:!1,onClick:this.handleClick,topOffset:n,variant:"default"},function(t){var r=t.isHovered;return[o.default.createElement(s.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"})].concat(a.map(function(t){return e.renderCell({isHovered:r,sortField:t.sortField})}))})},t.defaultProps={showHighlights:!0},t})(o.default.PureComponent);t.PaperRow=u}),define("modules/clean/react/files_view/pinned_team_folder_view",["require","exports","tslib","external/classnames","spectrum/table","modules/clean/browse_uri_interface","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/file_list_utils","modules/clean/react/files_view/file_row","react","modules/clean/react/sprite","modules/constants/trademark","modules/core/i18n","modules/clean/react/tooltip","modules/clean/user_education/user_education_client","modules/clean/user_education/react/user_education_effect"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),d=r.__importDefault(d);var S=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.displayName="PinnedTeamFolderView",t.renderTeamFolderRow=function(e,r){var o=t.props,s=o.activeDropTarget,u=o.context,p=o.dropTargetHighlightMode,h=o.getOverflowMenuActions,f=o.isTabbing,m=o.onDragEnter,S=o.onNavigateToFileOrFolder,g=o.onRenameCancel,E=o.onRenameSubmit,v=o.user,w=o.arePostTTIModulesLoaded,F=o.thumbStore,T=o.onShowShare,b=o.renderSharedWithController,y=l.shouldFileBeHighlightedDropTarget({dropTargetHighlightMode:p,file:e,isSelected:!1}),C=d.default.createElement(c.FileRow,{context:u,file:e,getOverflowMenuActions:h,key:encodeURI(e.fq_path),isAvailableDropTarget:y,isActiveDropTarget:e===s,isPinned:!0,arePostTTIModulesLoaded:w,isTabbing:f,onDragEnter:m,onNavigateToFileOrFolder:S,onRenameCancel:g,onRenameSubmit:E,showUserEducationEffects:0===r,showCDMUserEducationEffects:a.File.isTeamMemberFolder(e),user:v,visibleColumns:i.LIST_VIEW_COLUMNS.slice(0,1),canDisplayFolderSizes:!1,thumbStore:F,onShowShare:T,renderSharedWithController:b,hrefForFile:n.href_for_file});return r>0?C:d.default.createElement(_.UserEducationEffect,{containerName:"PinnedTeamFolder",name:"TeamFolder",key:encodeURI(e.fq_path)+"-UserEducationEffect"},C)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){m.UEClient.sendEvent(this.displayName,"componentDidMount",JSON.stringify(this.props.context))},t.prototype.renderHeaderTitle=function(e,t){var r=t?d.default.createElement("div",{className:"brws-pinned-team-folder-info-button"},d.default.createElement(f.Tooltip,{position:f.TooltipPosition.RIGHT,tooltip_contents:d.default.createElement("div",null,t),tooltip_classname:"brws-pinned-team-folder-tooltip"},d.default.createElement(u.Sprite,{group:"web",name:"info",alt:h._("File section information")}))):null;return d.default.createElement("div",{className:"brws-pinned-team-folder-header-title-button-group"},d.default.createElement("h2",{className:"brws-pinned-team-folder-header-title"},e),r)},t.prototype.render=function(){var e=this.props,t=e.columnFlex,r=e.isCompactMode,n=e.teamFolders,a=h.ungettext("Team folder","Team folders",n.size);return d.default.createElement("div",{className:"brws-pinned-team-folder-view"},d.default.createElement(s.Table,{columnFlex:t},d.default.createElement(s.TableHead,{className:o.default("brws-column-header","brws-pinned-team-folder-header",{"brws-column-header-compact brws-pinned-team-folder-header-compact ":r})},d.default.createElement(s.TableHeadCell,{className:"brws-checkbox-cell"}),d.default.createElement(s.TableHeadCell,{className:"brws-vertically-center"},this.renderHeaderTitle(a,h._("Team folders are the hub of content for a team and contents are                 automatically shared with team folder members. %(trademark_business)s                 team admins own and manage team folders.").format({trademark_business:p.TRADEMARK_BUSINESS})))),d.default.createElement(s.TableBody,null,n.map(this.renderTeamFolderRow))),d.default.createElement(s.Table,{columnFlex:t},d.default.createElement(s.TableHead,{className:o.default("brws-column-header","brws-pinned-team-folder-header","brws-pinned-team-folder-header-secondary",{"brws-column-header-compact brws-pinned-team-folder-header-compact ":r})},d.default.createElement(s.TableHeadCell,{className:"brws-checkbox-cell"}),d.default.createElement(s.TableHeadCell,{className:"brws-vertically-center"},this.renderHeaderTitle(h._("Everything else"))))))},t})(d.default.Component);t.PinnedTeamFolderView=S}),define("modules/clean/react/files_view/selectors",["require","exports","tslib","external/reselect","modules/clean/react/files_view/file_list_utils","modules/clean/react/browse/models"],function(e,t,r,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.createSelector(function(e){return e.isCompactMode},function(e){return e.isSelectMode},function(e){return e.arePostTTIModulesLoaded},function(e){return e.isSearchMode},function(e){return e.isTabbing},function(e){return e.canDisplayFolderSizes},function(e){return e.starredState},function(e){return e.disabledMultiselect},function(e,t,r,o,s,n,a,i){return{isCompactMode:e,isSelectMode:t,arePostTTIModulesLoaded:r,isSearchMode:o,isTabbing:s,canDisplayFolderSizes:n,starredState:a,isCheckboxDisabled:i}});t.getFilesViewListRowItems=o.createSelector(a,function(e){return e.activeDropTarget},function(e){return e.context},function(e){return e.createNewFolderState},function(e){return e.dropTargetHighlightMode},function(e){return e.items},function(e){return e.fileRename},function(e){return e.focusedFileId},function(e){return e.selection},function(e){return e.user},function(e){return e.visibleColumns},function(e){return e.fileExtensionsConfigs},function(e,t,o,a,i,l,c,d,u,p,h,f){var m=l.toArray().map(function(a){if(a instanceof n.Paper)return{type:"PaperRow",props:{isSearchMode:e.isSearchMode,paper:a,visibleColumns:h,arePostTTIModulesLoaded:e.arePostTTIModulesLoaded}};var l=u.selected.has(a.fq_path),m=s.shouldFileBeHighlightedDropTarget({file:a,isSelected:l,dropTargetHighlightMode:i});return{type:"FileRow",props:r.__assign({},e,{file:a,isActiveDropTarget:m&&t===a,isAvailableDropTarget:m,isFocused:a.fq_path===d,isSelected:l,isSharingDisabled:s.isSharingDisabledForFile({context:o,file:a,user:p}),renameState:c&&c.file.fq_path===a.fq_path?c.state:void 0,visibleColumns:h,extensionsConfig:f?f[a.file_id]:void 0})}});return a&&"CREATE_FOLDER_INACTIVE"!==a&&m.unshift({type:"NewFolderRow",props:{createNewFolderState:a,isInsideMyTeamFolderTree:o.isInsideTeamFolderTree}}),m}),t.getItemIds=o.createSelector(function(e){return e.items},function(e){return e.toArray().map(function(e){return e.fq_path})})}),define("modules/clean/react/files_view/share_button",["require","exports","tslib","spectrum/button","react","modules/clean/react/search_success_banner/util","modules/core/i18n"],function(e,t,r,o,s,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importDefault(s);var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){t.props.useSearchSuccessBanner&&t.props.isSearchMode&&n.doSearchResultActionClickBroadcast(!0),e.preventDefault();var r=t.props,o=r.file;(0,r.onShowShare)(o,"BROWSE_FILE_ROW"),e.stopPropagation()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.isVisible,r=e.shareButtonLabel,n=e.showShareButton;return s.default.createElement(o.Button,{"aria-label":r,className:"inline-share-button",onClick:this.handleClick,tabIndex:t&&n?void 0:-1,variant:t&&n?"secondary":"invisible"},r)},t.defaultProps={isVisible:!0,shareButtonLabel:a._("Share"),showShareButton:!0},t})(s.default.PureComponent);t.ShareButton=i}),define("modules/clean/react/files_view/sticky_table_head",["require","exports","tslib","spectrum/dimensions","spectrum/table","react","modules/clean/react/sticky/sticky","modules/clean/react/sticky/container"],function(e,t,r,o,s,n,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),t.StickyTableHead=function(e){var t=e.children,l=e.columnFlex,c=e.offsetHeight,d=e.offsetTop,u=r.__rest(e,["children","columnFlex","offsetHeight","offsetTop"]);return n.default.createElement("thead",{className:"brws-sticky-table-head"},n.default.createElement(o.Dimensions,{tagName:"tr"},function(e){var o=e.width;return n.default.createElement("td",{className:"brws-sticky-table-cell"},n.default.createElement(i.StickyContainer,{offsetTop:d,useNativeSticky:!0,useWindowToDetermineBottom:!0},n.default.createElement(a.Sticky,{offsetHeight:c},n.default.createElement(s.Table,{columnFlex:l,style:{width:o}},n.default.createElement(s.TableHead,r.__assign({},u),t)))))}))}}),define("modules/clean/react/files_view/view_type_column_header_menu",["require","exports","tslib","react","spectrum/icon_form","spectrum/icon_mode","spectrum/popover","modules/clean/react/files_view/types","modules/core/i18n"],function(e,t,r,o,s,n,a,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelection=function(e){e!==t.props.viewType&&t.props.onSwitchViewType(e)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTTI()},t.prototype.viewTypeIcon=function(e){switch(e){case i.ViewType.List:return"list";case i.ViewType.Grid:return"grid";case i.ViewType.LargeGrid:return"tiles"}return"list"},t.prototype.render=function(){var e=this,t=this.props,r=t.viewType,i=t.viewTypes,c=t.viewTypeLabels;return 1===i.length?null:o.default.createElement(a.Popover,{className:"brws-view-type-column-header-menu",onSelection:this.handleSelection},o.default.createElement(a.PopoverTrigger,{className:"brws-view-type-column-header-menu-trigger","aria-label":l._("Select view type")},o.default.createElement(n.IconMode,{name:this.viewTypeIcon(r)}),o.default.createElement(s.IconForm,{name:"caret-down"})),o.default.createElement(a.PopoverContent,{attachment:"right",className:"brws-view-type-column-header-menu-content"},o.default.createElement(a.PopoverItemGroup,null,o.default.createElement(a.PopoverItemGroupTitle,null,l._("View As")),i.map(function(t){return o.default.createElement(a.PopoverSelectableItem,{"data-viewtype":t,key:t,icon:o.default.createElement(n.IconMode,{name:e.viewTypeIcon(t)}),selected:r===t,value:t},c[t])}))))},t})(o.default.PureComponent);t.ViewTypeColumnHeaderMenu=c});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/folder_dialog/async",["require","exports","modules/clean/css"],function(e,t,r){"use strict";function o(t){new Promise(function(t,r){e(["modules/clean/react/folder_dialog/folder_dialog"],t,r)}).then(__importStar).then(function(e){return e.FolderDialog.show(t)})}function s(){new Promise(function(t,r){e(["modules/clean/react/folder_dialog/folder_dialog"],t,r)}).then(__importStar).then(function(){r.require_css("/static/css/react/folder_picker-vflPoBeWL.css")})}Object.defineProperty(t,"__esModule",{value:!0}),t.showFolderDialog=o,t.prewarmFolderDialog=s}),define("modules/clean/react/folder_overview/api",["require","exports","tslib","modules/clean/api_v2/user_client"],function(e,t,r,o){"use strict";var s=this;Object.defineProperty(t,"__esModule",{value:!0});var n=new o.UserApiV2Client;t.getFileId=function(e,t){return r.__awaiter(s,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return[4,n.ns("files").rpc("get_metadata",{path:t},{subjectUserId:e}).then(function(e){return e.id})];case 1:return[2,r.sent()]}})})},t.getDescription=function(e,t){return r.__awaiter(s,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return[4,n.ns("files").rpc("get_description_batch",{file_ids:t instanceof Array?t:[t]},{subjectUserId:e})];case 1:return[2,r.sent()]}})})},t.setDescription=function(e,t,o,a){return r.__awaiter(s,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return[4,n.ns("files").rpc("set_description",{file_id:t,current_revision_id:o,text:a},{subjectUserId:e})];case 1:return[2,r.sent()]}})})},t.getContentReferences=function(e,t){return r.__awaiter(s,void 0,void 0,function(){
return r.__generator(this,function(r){switch(r.label){case 0:return[4,n.ns("files").rpc("get_content_references_info",{file_id:t},{subjectUserId:e})];case 1:return[2,r.sent()]}})})},t.removeContentReferences=function(e,t,o,a){return r.__awaiter(s,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return[4,n.ns("files").rpc("remove_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,current_revision_id:a,file_ids:o},{subjectUserId:e})];case 1:return[2,r.sent()]}})})},t.addContentReferences=function(e,t,o,a){return r.__awaiter(s,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return[4,n.ns("files").rpc("add_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,current_revision_id:a,file_ids:o},{subjectUserId:e})];case 1:return[2,r.sent()]}})})},t.isNotFoundError=function(e){try{return"NOT_FOUND"===JSON.parse(e.raw.responseBody).user_message}catch(e){return!1}},t.isConflictError=function(e){return e.error&&e.error.status&&"conflict"===e.error.status[".tag"]}}),define("modules/clean/react/folder_overview/connected",["require","exports","tslib","react","external/react-redux","modules/clean/react/browse/data/selectors","modules/clean/react/css","modules/clean/react/folder_overview/controller","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store"],function(e,t,r,o,s,n,a,i,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),l=r.__importStar(l),c=r.__importStar(c);var u=d.getStoreForFolderOverview(),p=function(e){return{path:n.context(e).currentFQPath,folderFileId:c.folderFileId(e),isOpen:!c.isCollapsed(e),descriptionContent:c.descriptionContent(e),pinnedItems:c.pinnedItems(e),hasUnsavedDescriptionDraft:c.hasUnsavedDescriptionDraft(e),user:n.user(e),descriptionAuthor:c.descriptionAuthor(e),haveAllComponentsLoaded:c.haveAllComponentsLoaded(e),descriptionBaseRevision:c.descriptionBaseRevision(e),hasFailedToLoad:c.hasFailedToLoad(e)}},h={updateFolderData:l.updateFolderDataCache,removeContentReferences:l.removeContentReferences,saveFolderData:l.saveFolderData,addLoadedComponent:l.addLoadedComponent,saveDescriptionDraft:l.saveDescriptionDraft,setFailedToLoad:l.setFailedToLoad,fetchDataForFolder:l.fetchDataForFolder},f=s.connect(p,h)(i.FolderOverviewController),m=function(e){return o.default.createElement(s.Provider,{store:u},o.default.createElement(f,r.__assign({},e)))};t.FolderOverview=a.requireCssWithComponent(m,["/static/css/browse/folder_overview-vflSdK2Nw.css","/static/js/spectrum_comments/index.web-vfl9XDK1R.css","/static/js/retrieval-components/index.web-vfldIluAG.css"])}),define("modules/clean/react/folder_overview/constants",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DESCRIPTION_PLACEHOLDER=r._("Add notes here, then select text to create lists and links"),t.NUM_COMPONENTS=3,t.ERROR_DESCRIPTION_CONFLICT=r._("Description failed to save due to a conflict. Click reload to update to latest version."),t.ERROR_DESCRIPTION_SAVE=r._("Description failed to save."),t.DESCRIPTION_SAVE_DELAY_MS=500,t.DESCRIPTION_SAVE_ERROR_DELAY_MS=5e3}),define("modules/clean/react/folder_overview/content_references",["require","exports","tslib","react","retrieval-components/pinned-item","modules/clean/browse_uri_interface","modules/clean/react/browse/models","modules/clean/react/files_view/tile_grid","modules/clean/react/icon/folder_icon"],function(e,t,r,o,s,n,a,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.FolderOverviewContentReferences=function(e){var t=e.user,c=e.pinnedItems,d=e.isReadOnly,u=e.onPinnedItemClick,p=e.onPinnedItemUnpin;return c&&c.length?o.default.createElement("div",{className:"folder-overview__content-references"},c.map(function(e){var c={className:"folder-overview__content-reference",filename:a.File.getFilename(e),onClick:function(){return u(e)},url:n.href_for_file(t,e)};if(d||(c=r.__assign({},c,{menuOptions:d?void 0:[{key:"unpin",label:"Unpin"}],onMenuOptionClick:function(t){switch(t){case"unpin":p(e)}},menuLabel:""})),e.is_dir)return o.default.createElement(s.PinnedItem,r.__assign({},c,{key:e.file_id,isFolder:!0,folderIcon:l.convertLegacyFolderIconToSpectrum(e.icon,"large")}));var h=r.__assign({},c,{thumbnailUrl:i.getThumbnailUrlForItem(e,256)});return o.default.createElement(s.PinnedItem,r.__assign({key:e.file_id},h))})):null}}),define("modules/clean/react/folder_overview/controller",["require","exports","tslib","external/classnames","external/lodash","react","retrieval-components/collapsable-section","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/react/async/loadable","modules/clean/react/files_view/types","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/content_references","modules/core/browser","modules/core/i18n"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),s=r.__importStar(s),n=r.__importDefault(n),l=r.__importStar(l),h=r.__importStar(h),t.AsyncFolderOverviewDescription=c.Loadable({loader:function(){return new Promise(function(t,r){e(["modules/clean/react/folder_overview/description"],t,r)}).then(r.__importStar).then(function(e){return e.FolderOverviewDescription})},loading:function(){return n.default.createElement("div",{className:"folder-overview__description folder-overview__description--placeholder"},u.DESCRIPTION_PLACEHOLDER)}});var m=(function(e){function c(t){var r=e.call(this,t)||this;return r.handleHeaderClick=function(){var e=r.props,t=e.folderFileId,o=e.isOpen;t&&(r.props.updateFolderData({fileId:t,folderData:{isCollapsed:o}}),r.props.saveFolderData({folderFileId:t}))},r.handleBeforeUnload=function(e){r.immediatelySaveDescriptionDraft(),r.props.hasUnsavedDescriptionDraft&&(e.preventDefault(),e.returnValue="")},r.immediatelySaveDescriptionDraft=function(){r.delayedSaveDescriptionDraft.cancel(),r.saveDescriptionDraft()},r.saveDescriptionDraft=function(){r.props.folderFileId&&r.props.hasUnsavedDescriptionDraft&&r.props.saveDescriptionDraft({folderFileId:r.props.folderFileId})},r.handlePinnedItemUnpin=function(e){var t=r.props.folderFileId;t&&r.props.removeContentReferences({folderFileId:t,fileIds:[e.file_id]})},r.handleDescriptionUpdated=function(e){r.props.folderFileId&&(r.props.updateFolderData({fileId:r.props.folderFileId,folderData:{descriptionDraft:e?JSON.stringify(e):void 0}}),r.delayedSaveDescriptionDraft())},r.handleDescriptionMount=function(){r.props.addLoadedComponent({component:"draftjs"})},r.handlePinnedItemClick=function(e){void 0!==e.ns_id?r.props.onNavigateToFileOrFolder(e):h.redirect(i.href_for_file(r.props.user,e))},r.setContainerRef=function(e){return r.container=e},r.delayedSaveDescriptionDraft=s.debounce(r.saveDescriptionDraft,u.DESCRIPTION_SAVE_DELAY_MS),r}return r.__extends(c,e),c.prototype.componentDidMount=function(){this.props.fetchDataForFolder({path:this.props.path}),window.addEventListener("beforeunload",this.handleBeforeUnload)},c.prototype.componentWillReceiveProps=function(e){l.paths_are_equal(e.path,this.props.path)||(this.props.fetchDataForFolder({path:e.path}),this.immediatelySaveDescriptionDraft())},c.prototype.componentDidUpdate=function(){this.container&&this.props.onChangeHeight(this.container.getBoundingClientRect().height)},c.prototype.componentWillUnmount=function(){this.props.folderFileId&&this.props.hasUnsavedDescriptionDraft&&this.immediatelySaveDescriptionDraft(),window.removeEventListener("beforeunload",this.handleBeforeUnload)},c.prototype.render=function(){return n.default.createElement("div",{className:o.default({"folder-overview":!0,"folder-overview--loading":!this.props.haveAllComponentsLoaded||this.props.hasFailedToLoad||this.props.browseLoadingState===d.LoadingState.LOADING_FIRST_PAGE}),ref:this.setContainerRef},n.default.createElement(a.CollapsableSection,{title:f._("Overview"),isOpen:this.props.isOpen,onHeaderClick:this.handleHeaderClick,strings:{buttonClose:f._("Hide"),buttonOpen:f._("Show")}},n.default.createElement(t.AsyncFolderOverviewDescription,{author:this.props.descriptionAuthor,content:this.props.descriptionContent,isReadOnly:this.props.isReadOnly,hasUnsavedDraft:this.props.hasUnsavedDescriptionDraft,onDescriptionUpdated:this.handleDescriptionUpdated,onMount:this.handleDescriptionMount,descriptionKey:[this.props.folderFileId,this.props.descriptionBaseRevision].join("-")}),n.default.createElement(p.FolderOverviewContentReferences,{user:this.props.user,pinnedItems:this.props.pinnedItems,isReadOnly:this.props.isReadOnly,onPinnedItemClick:this.handlePinnedItemClick,onPinnedItemUnpin:this.handlePinnedItemUnpin})))},c})(n.default.PureComponent);t.FolderOverviewController=m}),define("modules/clean/react/folder_overview/data/action_creators",["require","exports","tslib","modules/clean/react/browse/data/selectors","modules/clean/react/folder_overview/api","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/errors","modules/clean/react/folder_overview/utils","modules/clean/storage","modules/core/exception"],function(e,t,r,o,s,n,a,i,l,c,d){"use strict";var u=this;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),n=r.__importStar(n),l=r.__importStar(l),d=r.__importStar(d),t.updateFolderDataCache=function(e){var t=e.fileId,r=e.folderData;return{type:a.ActionTypes.UPDATE_FOLDER_DATA_CACHE,payload:{fileId:t,folderData:r}}};var p=function(e){return"folderFileId"in e};t.fetchDescription=function(e){return function(i,c){return r.__awaiter(u,void 0,void 0,function(){var u,h,f,m,_,S,g,E,v,w;return r.__generator(this,function(r){switch(r.label){case 0:e.isReload||i(t.removeLoadedComponent({component:"description"})),u=o.user(c()).id,r.label=1;case 1:if(r.trys.push([1,3,,4]),h=p(e)?e.folderFileId:n.nsIdCache(c())[l.normalizePath(e.path)],!h)throw new Error("Tried to fetchDescription without an NS ID");return[4,s.getDescription(u,h)];case 2:if(f=r.sent(),!f||!f.items||!f.items.length)throw new Error("Unexpected response from getDescription");if(m=f.items[0],_=m.text,S=m.latest_revision_id,g=m.file_obj_id,!g)throw new Error("Unexpected response from Sprinkle");return E=S||"0000000000000000",p(e)||i({type:a.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:(w={},w[l.normalizePath(e.path)]=g,w)}}),i(t.updateFolderDataCache({fileId:g,folderData:{description:_,descriptionBaseRevision:E,descriptionLatestRevision:E}})),i(t.addLoadedComponent({component:"description"})),[3,4];case 3:return v=r.sent(),e.isReload||i(t.setFailedToLoad({hasFailedToLoad:!0})),d.reportException({err:v,severity:d.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}})})}};var h=function(e){return e.items||e.content_references||[]};t.fetchContentReferences=function(e){var n=e.folderFileId,a=e.isReload;return function(e,i){return r.__awaiter(u,void 0,void 0,function(){var l,c,u,p;return r.__generator(this,function(r){switch(r.label){case 0:a||e(t.removeLoadedComponent({component:"content_references"})),l=o.user(i()).id,c=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.getContentReferences(l,n)];case 2:return u=r.sent(),c=h(u),[3,4];case 3:return p=r.sent(),s.isNotFoundError(p)?c=[]:(a||e(t.setFailedToLoad({hasFailedToLoad:!0})),d.reportException({err:p,severity:d.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]})),[3,4];case 4:return void 0!==c&&e(t.updateFolderDataCache({fileId:n,folderData:{contentReferences:c}})),e(t.addLoadedComponent({component:"content_references"})),[2]}})})}},t.addContentReferencesForCurrentFolder=function(e){var o=e.fileIds;return function(e,s){return r.__awaiter(u,void 0,void 0,function(){var a;return r.__generator(this,function(r){return a=n.folderFileId(s()),a&&e(t.addContentReferences({folderFileId:a,fileIds:o})),[2]})})}},t.addContentReferences=function(e){var n=e.folderFileId,a=e.fileIds;return function(e,i){return r.__awaiter(u,void 0,void 0,function(){var l,c;return r.__generator(this,function(r){switch(r.label){case 0:l=o.user(i()).id,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.addContentReferences(l,n,a,"")];case 2:return r.sent(),e(t.fetchContentReferences({folderFileId:n,isReload:!0})),[3,4];case 3:return c=r.sent(),d.reportException({err:c,severity:d.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}})})}},t.removeContentReferencesForCurrentFolder=function(e){var o=e.fileIds;return function(e,s){return r.__awaiter(u,void 0,void 0,function(){var a;return r.__generator(this,function(r){return a=n.folderFileId(s()),a&&e(t.removeContentReferences({folderFileId:a,fileIds:o})),[2]})})}},t.removeContentReferences=function(e){var n=e.folderFileId,a=e.fileIds;return function(e,i){return r.__awaiter(u,void 0,void 0,function(){var l,c;return r.__generator(this,function(r){switch(r.label){case 0:l=o.user(i()).id,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.removeContentReferences(l,n,a,"")];case 2:return r.sent(),e(t.fetchContentReferences({folderFileId:n,isReload:!0})),[3,4];case 3:return c=r.sent(),d.reportException({err:c,severity:d.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}})})}};var f=function(e){return!!e&&(e.descriptionSaveState!==a.DescriptionSaveState.CONFLICT&&(e.descriptionSaveState!==a.DescriptionSaveState.SAVING&&l.hasUnsavedDescriptionDraft(e)))};t.saveDescriptionDraft=function(e){var l=e.folderFileId;return function(e,c){return r.__awaiter(u,void 0,void 0,function(){function d(r){e(t.updateFolderDataCache({fileId:l,folderData:r}))}var u,p,h,m,_,S,g;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),u=o.user(c()).id,p=n.folderDataCache(c()),h=p[l],f(h)?(d({descriptionSaveState:a.DescriptionSaveState.SAVING}),[4,s.setDescription(u,l,h.descriptionLatestRevision,h.descriptionDraft)]):[2];case 1:return m=r.sent(),_=m.text,S=m.latest_revision_id,d({description:_,descriptionLatestRevision:S,descriptionSaveState:a.DescriptionSaveState.IDLE}),[3,3];case 2:return g=r.sent(),s.isConflictError(g)?(i.showDescriptionConflictError(function(){d({descriptionBaseRevision:void 0,descriptionDraft:void 0}),e(t.fetchDescription({folderFileId:l,isReload:!0}))}),d({descriptionSaveState:a.DescriptionSaveState.CONFLICT})):(i.showDescriptionSaveError(),d({descriptionSaveState:a.DescriptionSaveState.ERROR})),[3,3];case 3:return[2]}})})}},t.saveFolderData=function(e){var t=e.folderFileId;return function(e,s){return r.__awaiter(u,void 0,void 0,function(){var e,a;return r.__generator(this,function(r){return e=o.user(s()).id,c.UserLocalStorage.clearOtherUsers([e]),(a=n.folderDataCache(s())[t])?(c.UserLocalStorage.set(e,"folder-overview-"+t,{isCollapsed:a.isCollapsed}),[2]):[2]})})}},t.loadFolderData=function(e){var s=e.folderFileId;return function(e,n){return r.__awaiter(u,void 0,void 0,function(){var a,i;return r.__generator(this,function(r){return a=o.user(n()).id,c.UserLocalStorage.clearOtherUsers([a]),(i=c.UserLocalStorage.get(a,"folder-overview-"+s))?(e(t.updateFolderDataCache({fileId:s,folderData:i})),[2]):[2]})})}},t.removeLoadedComponent=function(e){var t=e.component;return{type:a.ActionTypes.REMOVE_LOADED_COMPONENT,payload:{component:t}}},t.addLoadedComponent=function(e){var t=e.component;return{type:a.ActionTypes.ADD_LOADED_COMPONENT,payload:{component:t}}},t.setFailedToLoad=function(e){var t=e.hasFailedToLoad;return{type:a.ActionTypes.SET_FAILED_TO_LOAD,payload:{hasFailedToLoad:t}}},t.fetchDataForFolder=function(e){var o=e.path;return function(e,s){return r.__awaiter(u,void 0,void 0,function(){var a;return r.__generator(this,function(r){switch(r.label){case 0:return e(t.setFailedToLoad({hasFailedToLoad:!1})),a=n.fileIdCache(s())[l.normalizePath(o)],a?[4,e(t.fetchDescription({folderFileId:a}))]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,e(t.fetchDescription({path:o}))];case 3:r.sent(),r.label=4;case 4:return(a=n.fileIdCache(s())[l.normalizePath(o)])?(e(t.fetchContentReferences({folderFileId:a})),e(t.loadFolderData({folderFileId:a})),[2]):(e(t.setFailedToLoad({hasFailedToLoad:!0})),[2])}})})}}}),define("modules/clean/react/folder_overview/data/reducer",["require","exports","tslib","modules/clean/react/browse/data/types","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/utils"],function(e,t,r,o,s,n){"use strict";function a(e,r){switch(void 0===e&&(e=t.defaultFolderOverviewState),r.type){case s.ActionTypes.UPDATE_FOLDER_DATA_CACHE:return c(e,r.payload);case s.ActionTypes.UPDATE_FILE_ID_CACHE:return l(e,r.payload);case o.ActionTypes.SET_CONTEXT:return i(e,r.payload);case s.ActionTypes.REMOVE_LOADED_COMPONENT:return d(e,r.payload);case s.ActionTypes.ADD_LOADED_COMPONENT:return u(e,r.payload);case s.ActionTypes.SET_FAILED_TO_LOAD:return p(e,r.payload);case o.ActionTypes.SET_UNSORTED_FILES:return h(e,r.payload)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFolderOverviewState={folderDataCache:{},fileIdCache:{},hasFailedToLoad:!1,nsIdCache:{},loadedComponents:[]};var i=function(e,t){var o=t.context;return r.__assign({},e,{nsIdCache:r.__assign({},e.nsIdCache,(s={},s[n.normalizePath(o.currentFQPath)]="ns:"+o.currentNSID+"/"+o.currentNSPath,s))});var s},l=function(e,t){var o=t.fileIdCache;return r.__assign({},e,{fileIdCache:r.__assign({},e.fileIdCache,o)})},c=function(e,t){var o=t.fileId,s=t.folderData;return r.__assign({},e,{folderDataCache:r.__assign({},e.folderDataCache,(n={},n[o]=r.__assign({},e.folderDataCache[o],s),n))});var n},d=function(e,t){var o=t.component;return r.__assign({},e,{loadedComponents:e.loadedComponents.filter(function(e){return e!==o})})},u=function(e,t){var o=t.component;return r.__assign({},e,{loadedComponents:e.loadedComponents.includes(o)?e.loadedComponents:e.loadedComponents.concat([o])})},p=function(e,t){var o=t.hasFailedToLoad;return r.__assign({},e,{hasFailedToLoad:o})},h=function(e,t){var o=t.unsortedFiles,s={};return o.forEach(function(e){s[n.normalizePath(e.fq_path)]=e.target_ns?"ns:"+e.target_ns+"/":"ns:"+e.ns_id+"/"+e.ns_path}),r.__assign({},e,{nsIdCache:r.__assign({},e.nsIdCache,s)})};t.folderOverviewReducer=a}),define("modules/clean/react/folder_overview/data/selectors",["require","exports","tslib","external/reselect","modules/clean/filepath","modules/clean/react/browse/data/reducer","modules/clean/react/browse/models","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/reducer","modules/clean/react/folder_overview/utils","modules/clean/redux/selectors","modules/clean/redux/types"],function(e,t,r,o,s,n,a,i,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),c=r.__importStar(c);var p=function(e){return d.getStateAtNamespace(e,u.BROWSE_NAMESPACE_KEY)||n.defaultBrowseState},h=function(e){return p(e).path},f=function(e){return d.getStateAtNamespace(e,u.FOLDER_OVERVIEW_NAMESPACE_KEY)||l.defaultFolderOverviewState};t.folderDataCache=function(e){return f(e).folderDataCache},t.fileIdCache=function(e){return f(e).fileIdCache},t.nsIdCache=function(e){return f(e).nsIdCache};var m=function(e){return e.BROWSE.user};t.loadedComponents=function(e){return f(e).loadedComponents},t.haveAllComponentsLoaded=function(e){return t.loadedComponents(e).length===i.NUM_COMPONENTS},t.hasFailedToLoad=function(e){return f(e).hasFailedToLoad},t.folderFileId=o.createSelector(t.fileIdCache,h,function(e,t){return e[c.normalizePath(t)]}),t.descriptionAuthor=o.createSelector(m,c.convertDbxUserToIUser);var _=o.createSelector(t.folderDataCache,t.folderFileId,function(e,t){return e[t]});t.isCollapsed=o.createSelector(_,function(e){return!!e&&!!e.isCollapsed}),t.descriptionBaseRevision=o.createSelector(_,function(e){return e?e.descriptionBaseRevision:void 0}),t.descriptionContent=o.createSelector(_,function(e){if(e&&e.description)try{return JSON.parse(e.description)}catch(e){return}}),t.hasUnsavedDescriptionDraft=o.createSelector(_,c.hasUnsavedDescriptionDraft),t.pinnedItems=o.createSelector(_,function(e){if(void 0!==e&&void 0!==e.contentReferences){var t=[];return e.contentReferences.forEach(function(e){var r={file_id:e.file_id,fq_path:e.fq_path,href:e.href,icon:e.icon,is_cloud_doc:e.is_cloud_doc,is_dir:e.is_dir,thumbnail_url_tmpl:e.thumbnail_url_tmpl,ns_id:e.ns_id,ns_path:e.ns_path,sjid:e.sjid},o=new a.File(r);t.push(o)}),t.sort(function(e,t){var r=s.filename(e.fq_path).toLowerCase(),o=s.filename(t.fq_path).toLowerCase();return r<o?-1:r>o?1:0})}})}),define("modules/clean/react/folder_overview/data/store",["require","exports","modules/clean/react/folder_overview/data/reducer","modules/clean/redux/store","modules/clean/redux/types"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;t.getStoreForFolderOverview=function(){return n||(n=o.getStoreAndRegisterReducers((e={},e[s.FOLDER_OVERVIEW_NAMESPACE_KEY]=r.folderOverviewReducer,e))),n;var e}}),define("modules/clean/react/folder_overview/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.UPDATE_FOLDER_DATA_CACHE="FOLDER_OVERVIEW/UPDATE_FOLDER_DATA_CACHE",e.UPDATE_FILE_ID_CACHE="FOLDER_OVERVIEW/UPDATE_FILE_ID_CACHE",e.REMOVE_LOADED_COMPONENT="FOLDER_OVERVIEW/REMOVE_LOADED_COMPONENT",e.ADD_LOADED_COMPONENT="FOLDER_OVERVIEW/ADD_LOADED_COMPONENT",e.SET_FAILED_TO_LOAD="FOLDER_OVERVIEW/SET_FAILED_TO_LOAD"})(t.ActionTypes||(t.ActionTypes={}));(function(e){e.IDLE="IDLE",e.SAVING="SAVING",e.CONFLICT="CONFLICT",e.ERROR="ERROR"})(t.DescriptionSaveState||(t.DescriptionSaveState={}))}),define("modules/clean/react/folder_overview/errors",["require","exports","tslib","react","modules/clean/react/folder_overview/constants","modules/clean/react/snackbar","modules/core/i18n"],function(e,t,r,o,s,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.showDescriptionConflictError=function(e){var t=function(){e(),n.Snackbar.close()};n.Snackbar.show(o.default.createElement(n.Snackbar,{actionButtonText:a._("Reload"),onActionClick:t,title:s.ERROR_DESCRIPTION_CONFLICT,variant:"fail"}))},t.showDescriptionSaveError=function(){n.Snackbar.fail(s.ERROR_DESCRIPTION_SAVE)}}),define("modules/clean/react/folder_overview/utils",["require","exports","tslib","modules/clean/filepath"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.convertDbxUserToIUser=function(e){return{id:e.id.toString(),name:{display:e.display_name,initials:[e.fname.substr(0,1),e.lname.substr(0,1)].join(""),public:e.familiar_name},photoUrl:e.initials_url}},t.normalizePath=function(e){return o.normalize(e).toLowerCase()},t.hasUnsavedDescriptionDraft=function(e){return!!e&&(!!e.descriptionDraft&&e.description!==e.descriptionDraft)}}),define("modules/clean/react/path_breadcrumbs",["require","exports","tslib","external/classnames","react","spectrum/icon_arrow","spectrum/icon_content","spectrum/popover","modules/clean/em_string","modules/clean/filepath","modules/core/i18n","modules/clean/user_education/react/user_education_effect","modules/clean/user_education/user_education_client","modules/clean/react/icon/icon_helper","modules/clean/react/title_bubble","modules/clean/react/search_success_banner/util"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m){"use strict";function _(e,t){return 20-(t?2.625:new l.Emstring(e).length)}function S(e,t,r,o){for(var s=e.split("/").filter(Boolean),n=[{path:"",icon:"folder_dropbox-small",folderName:t,alt:r}],a=h.spectrumFolderIcon({size:h.SpectrumIconSize.Small}),i=0;i<s.length;i++)e="/"+s.slice(0,i+1).join("/"),n.push({path:e,folderName:c.filename(e),icon:a,alt:d._("Folder")});if(n.length<3)return{dropdownCrumbs:[],inlineCrumbs:n,root:n[0]};for(var u=n[0]&&n[0].folderName||"",p=_(u,!1),f=n.map(function(e){return new l.Emstring(e.folderName||"").length}),m=1,S=f[n.length-1],i=n.length-2;i>=1&&(S+=1.64,S+=f[i],!(S>p));i--)m+=1;n.length===m+1&&(m+=1),1===m&&o===E.SMALL&&m++;var g=n.length-m;return{dropdownCrumbs:n.slice(0,g),inlineCrumbs:n.slice(g),root:n[0]}}function g(e){switch(e){case E.LARGE:return"right";case E.SMALL:return"right-small"}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),s=r.__importDefault(s),c=r.__importStar(c);t.generateBreadcrumbData=S;var E;(function(e){e.LARGE="LARGE",e.SMALL="SMALL"})(E=t.PathBreadcrumbsSize||(t.PathBreadcrumbsSize={}));var v=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.path,t=this.props,n=t.firstBreadcrumbName,a=t.firstBreadcrumbAlt,i=t.isDraggingInternalFiles,l=t.shouldHighlightDropTargets,p=t.setFileUploaderPath,h=t.getUrlForPath,f=t.setUrl,m=t.size,g=t.disableDragging,v=S(e,n,a,m),F=v.dropdownCrumbs,b=v.inlineCrumbs,y=v.root,C=_(y&&y.folderName||"",F.length>0),I=o.default({"brws-path-breadrumbs":!0,"brws-path-breadrumbs--small":this.props.size===E.SMALL}),R="page-header-text u-l-fl";return b.length>1||F.length>0?s.default.createElement("span",{className:I},s.default.createElement("h1",{className:"ax-visually-hidden"},c.filename(e)),s.default.createElement("nav",{className:R,id:"path-breadcrumbs","aria-label":d._("Folder hierarchy"),role:"navigation"},F.length>0&&s.default.createElement(T,{crumbs:F,currentPath:e,isDraggingInternalFiles:i,shouldHighlightDropTargets:l,setFileUploaderPath:p,setUrl:f,size:m,disableDragging:g}),b.map(function(t,o){return s.default.createElement(w,r.__assign({},t,{key:encodeURI(t.path),isOnlyCrumb:0===o&&1===b.length&&0===F.length,index:o,isLastCrumb:o===b.length-1,maxWidth:C,currentPath:e,isDraggingInternalFiles:i,isHighlightedDropTarget:l,setFileUploaderPath:p,getUrlForPath:h,setUrl:f,size:m,disableDragging:g}))}))):s.default.createElement("span",{className:I},s.default.createElement("h1",{className:R},s.default.createElement(u.UserEducationEffect,{containerName:"PathBreadcrumbs",name:"HomeTitle",useSpan:!0},n)))},t.defaultProps={path:"/",isDraggingInternalFiles:!1,shouldHighlightDropTargets:!1,setFileUploaderPath:function(){},size:E.LARGE,disableDragging:!1},t})(s.default.PureComponent);t.PathBreadcrumbs=v;var w=(function(e){function t(t){var r=e.call(this,t)||this;return r.onDragEnterBreadcrumb=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&(r.props.disableDragging||(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.isLastCrumb||r.props.setFileUploaderPath({path:r.props.path})))},r.onDragLeaveBreadcrumb=function(e){e.preventDefault(),r.props.disableDragging||(r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1}))))},r.onDropBreadcrumb=function(){r.setState({isDraggedOver:!1})},r.onDragOverBreadcrumb=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.isDraggingInternalFiles&&r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.navigateToFolder=function(e){m.resetSearchSuccessBannerSettings();var t=r.props.path;p.UEClient.sendEvent("BreadCrumbSegment","linkClicked",{path:t}),e.preventDefault(),r.props.setUrl({path:t})},r.eventHandlers={onDragEnter:r.onDragEnterBreadcrumb,onDragLeave:r.onDragLeaveBreadcrumb,onDrop:r.onDropBreadcrumb,onDragOver:r.onDragOverBreadcrumb,onMouseEnter:r.handleMouseEnter,onMouseLeave:r.handleMouseLeave,onMouseUp:r.handleMouseUp},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e,t=this.props,a=t.getUrlForPath,i=t.path,c=t.index,d=t.isOnlyCrumb,p=t.maxWidth,h=t.isLastCrumb,m=t.isHighlightedDropTarget,_=t.size,S=d?this.props.folderName:l.Emstring.em_snippet(this.props.folderName,p),E={"breadcrumb-segment":!0,"breadcrumb-segment--is-drop-target":!h&&m,"breadcrumb-segment--file-dragged-over":!h&&this.state.isDraggedOver},v=g(_);return e=h?s.default.createElement("span",r.__assign({},this.eventHandlers),S):s.default.createElement("span",r.__assign({className:"breadcrumb-segment__wrapper"},this.eventHandlers),s.default.createElement(u.UserEducationEffect,{containerName:"BreadCrumbSegment",name:"link-"+c,useSpan:!0},s.default.createElement("a",{href:a(i).toString(),onClick:this.navigateToFolder,className:o.default(E)},S)),s.default.createElement(n.IconArrow,{name:v})),this.props.folderName!==S?s.default.createElement(f.TitleBubble,{content:this.props.folderName,position:f.TitleBubble.POSITIONS.BOTTOM,className:"list-label__title-bubble"},e):e},t.defaultProps={isOnlyCrumb:!1,isDraggingInternalFiles:!1,isHighlightedDropTarget:!1,disableDragging:!1},t})(s.default.Component),F=(function(e){function t(t){var r=e.call(this,t)||this;return r.onDragEnter=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&(r.props.disableDragging||(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.setFileUploaderPath({path:r.props.path})))},r.onDragLeave=function(e){e.preventDefault(),r.props.disableDragging||(r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1}))))},r.onDrop=function(e){r.setState({isDraggedOver:!1}),r.dragEnterCount=0,r.props.closeFunc()},r.onDragOver=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.isDraggingInternalFiles&&r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&(r.setState({isDraggedOver:!1}),r.props.closeFunc())},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1}),r.props.isDraggingInternalFiles&&!r.props.isLastCrumb&&r.props.closeFunc()},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e=this.props,t=e.icon,n=e.alt,l=e.folderName,c={"breadcrumb-menu-item":!0,"breadcrumb-menu-item--is-drop-target":this.props.isHighlightedDropTarget,"breadcrumb-menu-item--file-dragged-over":this.state.isDraggedOver},d=s.default.createElement("span",{title:l,className:"breadcrumb-menu-item-wrapper"},s.default.createElement("span",{className:"breadcrumb-menu-item-icon"},s.default.createElement(a.IconContent,{name:t,"aria-label":n,role:"img"})),s.default.createElement("span",{className:"breadcrumb-menu-item-text"},l));return s.default.createElement(i.PopoverContentItem,r.__assign({value:this.props.path,className:o.default(c)},{onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDrop:this.onDrop,onDragOver:this.onDragOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseUp:this.handleMouseUp}),d)},t.defaultProps={isHighlightedDropTarget:!1,closeFunc:function(){},alt:"",isDraggingInternalFiles:!1,disableDragging:!1},t})(s.default.Component),T=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={menuVisible:!1},t.onDragEnter=function(e){t.props.disableDragging||(e.preventDefault(),t.setState({menuVisible:!0}))},t.onInnerDragEnter=function(e){e.preventDefault(),t.dragEnterCount++},t.onDragLeave=function(e){e.preventDefault(),t.dragEnterCount--,t.dragEnterCount<1&&(t.dragEnterCount=0,t.state.menuVisible&&t.setState({menuVisible:!1}))},t.onMouseEnter=function(e){t.props.disableDragging||t.props.isDraggingInternalFiles&&!t.props.disableDragging&&(e.preventDefault(),t.setState({menuVisible:!0}))},t.onCrumbSelected=function(e){t.props.setUrl({path:e})
},t.onPopoverToggle=function(e){var r=e.isOpen;t.setState({menuVisible:r})},t.onClose=function(){t.dragEnterCount=0,t.onPopoverToggle({isOpen:!1})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0},t.prototype.render=function(){var e=this,t=this.props.crumbs.slice().reverse(),r=this.props,o=r.currentPath,l=r.shouldHighlightDropTargets,c=r.isDraggingInternalFiles,u=r.setFileUploaderPath,p=r.size,h=r.disableDragging,f=d._("Show parent folders (descending)"),m=s.default.createElement(a.IconContent,{name:"folder_dropdown-small","aria-label":f,role:"img",className:"breadcrumb-menu-icon"}),_=g(p);return s.default.createElement(i.Popover,{onSelection:this.onCrumbSelected,onMenuToggle:this.onPopoverToggle,className:"breadcrumb-dropdown-container"},s.default.createElement(i.PopoverTrigger,{onDragOver:this.onDragEnter,onMouseEnter:this.onMouseEnter},s.default.createElement("span",{className:"u-unbutton breadcrumb-overflow-button u-l-fl"},m)),s.default.createElement(i.PopoverContent,{isRevealed:this.state.menuVisible,onDragEnter:this.onInnerDragEnter,onDragLeave:this.onDragLeave},t.map(function(t){return s.default.createElement(F,{key:encodeURI(t.path),path:t.path,icon:t.icon,alt:t.alt,folderName:t.folderName,currentPath:o,isHighlightedDropTarget:l,isDraggingInternalFiles:c,setFileUploaderPath:u,closeFunc:e.onClose,disableDragging:h})})),s.default.createElement(n.IconArrow,{name:_,className:"breadcrumb__spacer"}))},t.defaultProps={shouldHighlightDropTargets:!1,isDraggingInternalFiles:!1,disableDragging:!1},t})(s.default.Component)}),define("modules/clean/redux/tests/store",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mockExtraArguments=function(){return{}}}),define("modules/clean/search/api",["require","exports","tslib","modules/clean/ajax","modules/clean/analytics","modules/clean/react/browse/models","modules/clean/search/search_helpers","modules/clean/search/constants","modules/clean/search/types","modules/clean/search/models","modules/clean/search/api_helpers","modules/clean/search/search_helpers","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/store"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),a=r.__importStar(a),i=r.__importStar(i);var f=(function(){function e(){this._activeRequest=null}return e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype.loadResults=function(e){var t=e.user,r=e.path,o=e.query,s=e.start,n=e.maxResults,l=e.searchSessionId,c=e.nsid,u=e.fileNameOnly,p=e.loadDeleted,h=e.showPaperResults,f=e.isDropdown,m=e.isAdminConsole,_=e.showSymlinkIcon,S=e.webTimer,g=e.expFolderCalcSize,E=e.onSuccess,v=e.onError,w=e.overrideUrl,F=d.getCurrentTimezoneOffset(),T={query:o,search_token:a.getSearchCsrfToken(),fq_path:r,ns_id:c,filename_only:!!u,max_results:n,deleted:!!p,start:s,show_paper_results:!!h,is_dropdown:!!f,is_admin_console:!!m,show_unmounted_results:!0,timezone_offset:F,show_symlink_icon:_,include_browse_context:!0,calculate_folder_size:g},b=w?w:i.SEARCH_FRONTEND_SERVICE_ENDPOINT;this._fetchResults({requestData:T,user:t,searchSessionId:l,url:b,onSuccess:E,onError:v,webTimer:S})},e.prototype._extractSearchResultsList=function(e){for(var t=[],r=0,o=e;r<o.length;r++){var s=o[r];switch(s.search_result_type){case l.SearchResultTypes.FILE:t.push(n.File.fromServerObject(s));break;case l.SearchResultTypes.PAPER:t.push(n.Paper.fromServerObject(s));break;case l.SearchResultTypes.PAPER_FOLDER:t.push(n.PaperFolder.fromServerObject(s))}}return t},e.prototype._getSearchType=function(e){return e.is_dropdown?"dropdown":e.deleted?"full_page_deleted":"full_page"},e.prototype.loadPartialResults=function(e){var t=e.user,o=e.maxResults,s=e.start,n=e.path,l=e.query,c=e.fileCategories,d=e.searchSessionId,p=e.showSymlinkIcon,h=e.includeBrowseContext,f=e.webTimer,m=e.expFolderCalcSize,_=e.onSuccess,S=e.onError,g=c?u.fileCategoriesToString(c):"",E=r.__assign({query:l,search_token:a.getSearchCsrfToken(),fq_path:n,start:s,max_results:o,show_paper_results:!0,show_symlink_icon:p,include_browse_context:h,search_session_id:d,calculate_folder_size:m},g&&{file_categories:g});this._fetchResults({requestData:E,user:t,searchSessionId:d,url:i.SEARCH_FRONTEND_SERVICE_ENDPOINT,onSuccess:_,onError:S,webTimer:f})},e.prototype._fetchResults=function(e){var t=this,n=e.requestData,a=e.user,i=e.searchSessionId,l=e.url,d=e.onSuccess,f=e.onError,m=e.webTimer;if(null!=this._activeRequest&&this._activeRequest.abort(),""!==n.query){var _=u.fileCategoryStringToLogValue(n.file_categories),S=p.experiments(h.getStoreForSearchBar().getState()),g=r.__assign({path_scoped:"/"!==n.fq_path,search_type:this._getSearchType(n),query_string:n.query,start:n.start,search_session_id:i,timezone_offset:n.timezone_offset},u.isInFileTypeFilterExperiment(S)&&{file_type_filters:_});s.SearchClientActivityLogger.log("query_started",a.id,g);var E=(new Date).getTime();this._activeRequest=o.WebRequest({url:l,data:n,dataType:"json",subject_user:a,success:function(e,r,o){var l;n.include_browse_context&&(l=c.extractBrowseContext(e));var u=e.search_results,p=o.getResponseHeader("x-dropbox-request-id");u.forEach(function(e){return e.request_id=p});var h=t._extractSearchResultsList(u);d({context:l,searchResults:h,deleted:!!n.deleted});var f=s.SearchClientActivityLogger.create_search_log_dict(g,p,E,n.query,h.length,null,i,null);s.SearchClientActivityLogger.log("query_completed",a.id,f),m&&m.end(p?p:void 0)},error:function(e,t,r){"abort"!==t&&"function"==typeof f&&f(r);var o=e.getResponseHeader("x-dropbox-request-id"),l=s.SearchClientActivityLogger.create_search_log_dict(g,o,E,n.query,null,t,i,null);s.SearchClientActivityLogger.log("query_failed",a.id,l),m&&m.abort()},complete:function(){this._activeRequest=null}})}},e.prototype.fetchAdditionalFileMetadata=function(e){var t=e.searchResults,r=e.user,s=e.onSuccess,a=e.onError,l=t.filter(function(e){return e instanceof n.File}),c=l.map(function(e){return[e.ns_id,e.sjid,e.fq_path.substr(0,e.fq_path.length-e.ns_path.length)]});c.length>0&&o.WebRequest({url:i.FILE_INFO_ENDPOINT,data:{nsid_sjid_fq_mount_point_tuples:JSON.stringify(c)},dataType:"json",subject_user:r,success:function(e,t,r){for(var o=e.file_results,n=[],a=0,i=o;a<i.length;a++){var l=i[a];n.push(l)}s(n)},error:function(e,t,r){"abort"!==t&&"function"==typeof a&&a(r)}})},e})();t.SearchApiClient=f,t.searchApiClient=new f}),define("modules/clean/search/search_results/actions",["require","exports","tslib","modules/clean/search/constants","modules/core/i18n","modules/clean/search/search_results/dispatcher","modules/clean/search/api","modules/clean/search/search_results/store","modules/clean/search/types","modules/clean/search/constants","modules/clean/search/store_helpers","modules/clean/search/search_helpers"],function(e,t,r,o,s,n,a,i,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),d=r.__importStar(d);var p=(function(){function e(e,t){void 0===e&&(e=a.searchApiClient),void 0===t&&(t=i.getSearchResultsStore()),this._searchApi=e,this._searchResultsStore=t}return e.prototype.runSearch=function(e){var t=this,r=e.user,s=e.path,a=e.query,i=e.searchSessionId,l=e.webTimer,u=e.logOnceFetchedDataRequiredForTTI,p=e.deletedFiles,h=e.showSymlinkIcon,f=e.expSinglePageSearch,m=e.fileCategories,_=e.isPaperEnabled,S=void 0===_||_,g=e.expFolderCalcSize,E=void 0!==g&&g,v=d.generateRandomId();f&&!this._searchResultsStore.searchResults().isEmpty()||n.SearchResultsDispatcher.dispatch({type:o.CLEAR_SEARCH_ACTION}),n.SearchResultsDispatcher.dispatch({type:o.START_SEARCH_ACTION,data:{query:a,searchSessionId:i,queryId:v,fileCategories:m}});var w=c.MaxResults.MAX_SEARCH_RESULTS;p!==!0?this._searchApi.loadPartialResults({user:r,path:s,query:a,start:0,searchSessionId:i,showSymlinkIcon:h,includeBrowseContext:!0,webTimer:l,maxResults:w,fileCategories:m,expFolderCalcSize:E,onSuccess:function(e){var o=e.searchResults,n=e.context;u(),t._setSearchResults({searchResults:o,context:n,deletedFiles:!!p,queryId:v}),E&&t.setFolderSize(),void 0===p&&t._loadDeletedResults({path:s,user:r,isPaperEnabled:S}),t._searchApi.fetchAdditionalFileMetadata({searchResults:o,user:r,onSuccess:function(e){t._setFullSearchResults({searchResults:e,queryId:v})}})}}):this._searchApi.loadResults({user:r,path:s,query:a,start:0,maxResults:w,showPaperResults:!0,searchSessionId:i,showSymlinkIcon:h,webTimer:l,loadDeleted:p,expFolderCalcSize:E,onSuccess:function(e){var o=e.searchResults,n=e.context;u(),t._setSearchResults({searchResults:o,context:n,deletedFiles:!!p,queryId:v}),E&&t.setFolderSize(),void 0===p&&t._loadDeletedResults({path:s,user:r,isPaperEnabled:S})}})},e.prototype.fetchCompleteSearchResultSRP=function(e){var t=this,r=e.searchResult,o=e.user,n=e.onSuccess,a=e.onError;if(r.isDeleted)return n(r);var l=i.getSearchResultsStore().fullSearchResults().get(r.fq_path,null);if(l){n(this._mergePartialAndCompleteResult({partialResult:r,completeResult:l}))}else this._searchApi.fetchAdditionalFileMetadata({searchResults:[r],user:o,onSuccess:function(e){if(e.length>0){n(t._mergePartialAndCompleteResult({partialResult:r,completeResult:e[0]}))}else if(a){var o=s._("There was a problem completing this request.");a(o)}},onError:a})},e.prototype._mergePartialAndCompleteResult=function(e){var t=e.partialResult,o=e.completeResult;return r.__assign({},t,o)},e.prototype.loadMoreResults=function(e){var t=this,s=e.path,a=e.user,i=e.deletedFiles,d=e.showSymlinkIcon,p=e.isPaperEnabled,h=void 0===p||p,f=e.expFolderCalcSize,m=void 0!==f&&f,_=!1,S=this._searchResultsStore.latestFileCategories(),g=h?!(u.allCategoriesUnchecked(S)||u.allCategoriesChecked(S)):!(u.allCategoriesUnchecked(r.__assign({},S,(F={},F[l.FileCategory.PAPER]="unchecked",F)))||u.allCategoriesChecked(r.__assign({},S,(T={},T[l.FileCategory.PAPER]="checked",T))));if(this._searchResultsStore.loadingState()===o.SearchLoadingState.LOADED){if(void 0===i)if(this._searchResultsStore.hasMoreResults())_=!1;else{if(!this._searchResultsStore.hasMoreResults(!g))return;_=!0}else{if(!this._searchResultsStore.hasMoreResults(i&&!g))return;_=i&&!g}n.SearchResultsDispatcher.dispatch({type:o.CONTINUE_SEARCH_ACTION,data:{didLoadDeletedResults:_}});var E=_?this._searchResultsStore.numDeletedResults():this._searchResultsStore.searchResults().size,v=this._searchResultsStore.queryId();if(_)this._searchApi.loadResults({user:a,path:s,query:this._searchResultsStore.latestQuery(),fileNameOnly:!1,showPaperResults:!0,isDropdown:!1,isAdminConsole:!1,loadDeleted:_,start:E,maxResults:c.MaxResults.MAX_SEARCH_RESULTS,searchSessionId:this._searchResultsStore.searchSessionId(),showSymlinkIcon:d,expFolderCalcSize:m,onSuccess:function(e){var r=e.searchResults,o=(e.context,e.deleted);t._appendSearchResults({searchResults:r,deleted:o}),void 0===i&&t._loadDeletedResults({path:s,user:a,isPaperEnabled:h})}});else{var w=this._searchResultsStore.latestQuery();this._searchApi.loadPartialResults({user:a,path:s,query:w,start:E,showSymlinkIcon:d,includeBrowseContext:!1,searchSessionId:this._searchResultsStore.searchSessionId(),maxResults:c.MaxResults.MAX_SEARCH_RESULTS,fileCategories:S,expFolderCalcSize:m,onSuccess:function(e){var r=e.searchResults;e.context;t._appendSearchResults({searchResults:r,deleted:!1}),m&&t.setFolderSize(),t._searchApi.fetchAdditionalFileMetadata({searchResults:r,user:a,onSuccess:function(e){t._setFullSearchResults({searchResults:e,queryId:v})}}),void 0===i&&t._loadDeletedResults({path:s,user:a,isPaperEnabled:h})}})}var F,T}},e.prototype._setSearchResults=function(e){var t=e.searchResults,r=e.context,s=e.deletedFiles,a=e.queryId;n.SearchResultsDispatcher.dispatch({type:o.SET_SEARCH_RESULTS_ACTION,data:{searchResults:t,context:r,deletedFiles:s,queryId:a}})},e.prototype._setFullSearchResults=function(e){var t=e.searchResults,r=e.queryId;n.SearchResultsDispatcher.dispatch({type:o.SET_FULL_SEARCH_RESULTS_ACTION,data:{searchResults:t,queryId:r}})},e.prototype._appendSearchResults=function(e){var t=e.searchResults,r=e.deleted;n.SearchResultsDispatcher.dispatch({type:o.APPEND_SEARCH_RESULTS_ACTION,data:{searchResults:t,deleted:r}})},e.prototype._loadDeletedResults=function(e){var t=e.path,r=e.user,o=e.isPaperEnabled;this._searchResultsStore.hasMoreResults()||this._searchResultsStore.didLoadDeletedResults()||this.loadMoreResults({path:t,user:r,isPaperEnabled:o})},e.prototype.setSearchSelection=function(e){var t=e.selection;n.SearchResultsDispatcher.dispatch({type:o.SET_SEARCH_SELECTION_ACTION,data:{selection:t}})},e.prototype.clearSearch=function(){n.SearchResultsDispatcher.dispatch({type:o.CLEAR_SEARCH_ACTION})},e.prototype.setFileTypeFilter=function(e){var t=e.fileCategories;n.SearchResultsDispatcher.dispatch({type:o.SET_FILE_TYPE_FILTER_ACTION,data:{fileCategories:t}})},e.prototype.selectFirstFile=function(){n.SearchResultsDispatcher.dispatch({type:o.SELECT_FIRST_FILE_ACTION,data:{}})},e.prototype.setFolderSize=function(){n.SearchResultsDispatcher.dispatch({type:o.SET_FOLDER_SIZE_ACTION,data:{}})},e})();t.SearchResultsActions=p,t.searchResultsActions=new p}),define("modules/clean/search/search_results/controller",["require","exports","tslib","external/lodash","react","external/react-dom","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/react/css","modules/clean/search/constants","modules/clean/search/search_results/actions","modules/clean/search/search_results/log_helper","modules/clean/search/search_results/store","modules/clean/search/search_results/view","modules/clean/web_user_action_events","modules/clean/react/extensions/client"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importDefault(s),n=r.__importStar(n),a=r.__importStar(a),c=r.__importStar(c);var _=(function(t){function l(){var e=null!==t&&t.apply(this,arguments)||this;return e._onSearchResultsStoreChanged=function(){e.setState(e._getStateFromSearchResultsStore()),e.deferredCheckForMissingStarredData&&e.deferredCheckForMissingStarredData()},e._handleScroll=function(){if(n.findDOMNode(e).getBoundingClientRect().bottom<=window.innerHeight){var t=e.props,r=t.path,o=t.user,s=t.shouldShowDeletedFiles,a=t.searchResultsExperiments,i=t.isPaperEnabled,l=a.expShowSymlinkIcon,c=a.expFolderCalcSize;d.searchResultsActions.loadMoreResults({path:r,user:o,showSymlinkIcon:!!l,deletedFiles:s,isPaperEnabled:i,expFolderCalcSize:c})}},e._handleSelectionChange=function(e){d.searchResultsActions.setSearchSelection({selection:e})},e._handleLocationLinkClick=function(t,r){var o=e.props,s=o.user,n=o.viewType;if(u.recordSearchResultsAction({result:t,user:s,action_type:f.WebUserActionLogEvent.CLICK_PATH_LINK,view_type:n}),!r){var i=a.parent_dir(t.fq_path);e.props.onNavigateToPath(i)}},e._handleFilesViewShowShare=function(t,r){var o=e.props,s=o.user,n=o.filesViewActionHandlers,a=o.viewType;u.recordSearchResultsAction({result:t,user:s,action_type:f.WebUserActionLogEvent.SHARE,view_type:a}),n.onShowShare(t,r)},e}return r.__extends(l,t),l.prototype.componentWillMount=function(){this.state=this._getStateFromSearchResultsStore()},l.prototype.componentWillReceiveProps=function(e){e.arePostTTIModulesLoaded&&!this.props.arePostTTIModulesLoaded&&this.enableStarring()},l.prototype.componentDidMount=function(){p.getSearchResultsStore().add_change_listener(this._onSearchResultsStoreChanged),this.props.arePostTTIModulesLoaded&&this.enableStarring(),this.setState(this._getStateFromSearchResultsStore()),window.scrollTo(0,0)},l.prototype.componentWillUnmount=function(){p.getSearchResultsStore().remove_change_listener(this._onSearchResultsStoreChanged)},l.prototype.componentDidUpdate=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(r){switch(r.label){case 0:return this.state.searchResults===t.searchResults?[3,2]:[4,this.getAppActions(this.state.searchResults)];case 1:e=r.sent(),this.setState({fileExtensionsConfigs:e}),r.label=2;case 2:return[2]}})})},l.prototype.enableStarring=function(){var t=this,r=e("modules/clean/react/starred/browse_exports").checkForMissingStarredData;this.deferredCheckForMissingStarredData=function(){o.defer(function(){var e=[];p.getSearchResultsStore().searchResults().forEach(function(t){t instanceof i.File&&e.push(t),(t instanceof i.Paper||t instanceof i.PaperFolder)&&e.push(t)}),r({items:e,user:t.props.user})})},this.deferredCheckForMissingStarredData()},l.prototype._getStateFromSearchResultsStore=function(){var e=p.getSearchResultsStore(),t=e.latestQuery(),r=e.loadingState(),o=this.state?this.state.loadingState!==r&&this.state.loadingState===c.SearchLoadingState.LOADING_FIRST_PAGE?t:this.state.queryForResultsTitle:"";return{context:e.browseContext(),hasMoreResults:e.hasMoreResults(),loadingState:r,latestQuery:t,queryForResultsTitle:o,searchSessionId:e.searchSessionId(),fullSearchResults:e.fullSearchResults(),searchResults:e.searchResults(),selection:e.selection(),selectedFiles:e.selectedFiles()}},l.prototype.getAppActions=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,o;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.toArray().filter(function(e){return e instanceof i.File&&!e.isDeleted}),o=m.getExtensionsClient(),[4,o.getActionsForFileBatch(t,this.props.user.id)];case 1:return[2,r.sent()]}})})},l.prototype.render=function(){var e=this.props,t=e.actionHandlers,n=e.searchResultsExperiments,a=e.searchBarExperiments,i=e.maestroSearchBarProps,l=e.onFocusSearchBar,c=e.onSearch,d=e.onNavigateToFileOrFolder,u=e.setFileUploaderPath,p=e.path,f=e.user,m=e.handleComponentTTI,_=e.ensureFileViewerClosedIfNotPreviewing,S=e.getIsFileJumping,g=e.isFileViewerShown,E=e.fileRename,v=e.arePostTTIModulesLoaded,w=e.getOverflowMenuActions,F=e.filesViewActionHandlers,T=e.onNavigateToParentFolder,b=e.shouldShowDeletedFiles,y=e.browseExperiments,C=e.onOpenPaper,I=e.renderSharedWithController,R=e.hrefForFile,D=e.responsive,N=e.onSearchFiltersChanged,P=e.starredState,A=e.fileCategories,O=e.viewType,L=e.pageHeaderHeight,x=this.state,M=x.context,U=x.hasMoreResults,k=x.loadingState,B=x.latestQuery,q=x.queryForResultsTitle,V=x.searchSessionId,H=x.searchResults,W=x.selection,z=x.selectedFiles,G=x.fileExtensionsConfigs,j=r.__assign({},F,{onShowShare:this._handleFilesViewShowShare});return s.default.createElement(h.SearchResultsView,{filesViewActionHandlers:j,searchResultsExperiments:n,searchBarExperiments:a,browseExperiments:y,maestroSearchBarProps:i,onFocusSearchBar:l,onSearch:c,onScroll:o.throttle(this._handleScroll,200),setFileUploaderPath:u,onSelectionChange:this._handleSelectionChange,path:p,user:f,actionHandlers:t,handleComponentTTI:m,ensureFileViewerClosedIfNotPreviewing:_,getIsFileJumping:S,isFileViewerShown:g,fileRename:E,arePostTTIModulesLoaded:v,getOverflowMenuActions:w,onLocationLinkClick:this._handleLocationLinkClick,onNavigateToFileOrFolder:d,onNavigateToParentFolder:T,onOpenPaper:C,context:M,hasMoreResults:U,loadingState:k,latestQuery:B,queryForResultsTitle:q,searchSessionId:V,searchResults:H,selection:W,selectedFiles:z,viewType:O,shouldShowDeletedFiles:b,renderSharedWithController:I,hrefForFile:R,responsive:D,onSearchFiltersChanged:N,starredState:P,fileCategories:A,pageHeaderHeight:L,onStarClick:this.props.onStarClick,fileExtensionsConfigs:G})},l})(s.default.Component);t.SearchResultsController=l.requireCssWithComponent(_,["/static/css/browse/browse-vflmJk5i5.css","/static/css/search/search_results-vfleih0HW.css","/static/css/scooter/scooter-scoped-vflWuydQl.css"])}),define("modules/clean/search/search_results/dispatcher",["require","exports","tslib","modules/core/exception","modules/clean/flux/dispatcher","modules/clean/search/search_results/store"],function(e,t,r,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.SearchResultsDispatcher={dispatch:function(e){o.assert(n.searchResultsStoreInstantiated(),"Must call getSearchResultsStore() before a dispatch"),s.Dispatcher.dispatch(e)}}}),define("modules/clean/search/search_results/log_helper",["require","exports","tslib","modules/clean/search/logger","modules/clean/search/search_results/store","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/action_creators"],function(e,t,r,o,s,n,a){"use strict";function i(e){var t=e.result,r=e.user,i=e.action_type,l=e.view_type,c=s.getSearchResultsStore().searchSessionId(),d=s.getSearchResultsStore().latestQuery(),u={rawQuery:d,normalizedQuery:d};n.getStoreForSearchBar().dispatch(a.addQueryToHistory({user:r,query:u,searchSessionId:c,requestId:t.request_id||""})),o.logSearchAction({searchSessionId:c,result:t,user:r,action_type:i,search_type:"full_page",viewport:"full-view",view_type:l})}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.recordSearchResultsAction=i}),define("modules/clean/search/search_results/search_filters",["require","exports","tslib","react","modules/core/i18n","spectrum/tertiary_link","spectrum/label","spectrum/radio_button","spectrum/checkbox","modules/clean/filepath","modules/clean/react/folder_dialog/async","modules/clean/react/path_filter_button","modules/clean/search/types","modules/clean/search/search_helpers","modules/clean/search/search_bar/experiments","spectrum/icon_arrow","modules/clean/search/constants","external/classnames","spectrum/icon_content","spectrum/tooltip","modules/clean/search/constants","modules/clean/logging/hive/schemas/web-modal-activity"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S,g,E,v,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),c=r.__importStar(c),S=r.__importDefault(S);var F=(function(e){function t(F){var T=e.call(this,F)||this;T.showFolderFilterModal=function(){var e=T.props,t=e.user,r=e.path,o=e.onFiltersChanged,n=e.deletedFiles;d.showFolderDialog({ariaLabel:s._("Folder selector"),canSelectReadonly:!0,initialPath:r,modalName:w.ModalName.SEARCH_FILTER,primaryActionLabel:s._("Select"),title:s._("Select a folder"),user:t,onSuccess:function(e){o({path:e,deletedFiles:n})}})},T.resetFilters=function(){var e=T.props,t=e.searchBarExperiments,o=e.onFiltersChanged,s={};f.isInDeletedFilterRightRailExperiment(t)&&(s.deletedFiles=!1),s.path="/",h.isInFileTypeFilterExperiment(t)&&(s.fileCategories=r.__assign({},v.FILE_CATEGORIES_UNCHECKED)),o(s)},T.shouldRenderResetButton=function(){var e=T.props,t=e.path,r=e.deletedFiles,o=e.fileCategories,s=e.searchBarExperiments,n=h.fileCategoriesSet(o,s,T.props.isPaperEnabled);return!c.paths_are_equal(t,"/")||!!r||n},T.renderResetButton=function(){return o.default.createElement(n.TertiaryLink,{onClick:T.resetFilters,className:"search-filters__reset"},s._("Reset filters"))},T.renderPathFilter=function(){var e=T.props.path;return o.default.createElement("div",{className:"filter-item__row"},o.default.createElement("div",{className:"filter-item__column"},o.default.createElement("div",{className:"filter-item__desc"},s._("By folder")),o.default.createElement(u.PathFilterButton,{path:e,defaultText:s._("Any folder"),dropdownClasses:"filter-item__filter",onClick:T.showFolderFilterModal})))},T.handleDeletedFilesAll=function(){T.props.onFiltersChanged({deletedFiles:!1})},T.handleDeletedFilesDeleted=function(){T.props.onFiltersChanged({deletedFiles:!0})},T.handleFileTypeChanged=function(e,t,o){var s=o.target.name;T.props.onFiltersChanged({fileCategories:r.__assign({},T.props.fileCategories,(n={},n[s]=e,n))});var n},T.handleChangeFileTypeFiltersView=function(){T.setState({showAllFilters:!T.state.showAllFilters})},T.handleClearOrSelectAll=function(){h.allCategoriesChecked(T.props.fileCategories,T.props.isPaperEnabled)?T.props.onFiltersChanged({fileCategories:r.__assign({},v.FILE_CATEGORIES_UNCHECKED)}):(T.props.onFiltersChanged({fileCategories:r.__assign({},v.FILE_CATEGORIES_CHECKED)}),T.setState({showAllFilters:!0}))},T.renderDeletedFilter=function(){var e=T.props.deletedFiles;return o.default.createElement("div",{className:"filter-item__row"},o.default.createElement("div",{className:"filter-item__column"},o.default.createElement("div",{className:"filter-item__desc"},s._("By status")),o.default.createElement("div",null,o.default.createElement(a.Label,{htmlFor:"filter-type-all"},o.default.createElement(i.RadioButton,{"aria-checked":!0,checked:!e,id:"filter-type-all",value:"all",onChange:T.handleDeletedFilesAll}),s._("Available"))),o.default.createElement("div",null,o.default.createElement(a.Label,{htmlFor:"filter-type-deleted"},o.default.createElement(i.RadioButton,{"aria-checked":!0,checked:e,id:"filter-type-deleted",value:"deleted",onChange:T.handleDeletedFilesDeleted}),s._("Deleted")))))},T.renderFileTypeFilter=function(){var e=T.renderFileTypeFilterCheckboxes(),t=T.state.showAllFilters?"up":"down",r=T.state.showAllFilters?s._("Show Less"):s._("Show More"),a=h.allCategoriesChecked(T.props.fileCategories,T.props.isPaperEnabled),i=a?s._("Clear all"):s._("Select all");return o.default.createElement("div",{className:"filter-item__row"},o.default.createElement("div",{className:"filter-item__column"},o.default.createElement("div",{className:"filter-item__desc"},s._("By type"),o.default.createElement(n.TertiaryLink,{onClick:T.handleClearOrSelectAll,className:"filter-type-file-select-or-clear-all-button"},i)),e,o.default.createElement("button",{className:"show-more-filters",onClick:T.handleChangeFileTypeFiltersView},o.default.createElement("div",{className:"show-more-filters__arrow show-more-filters__arrow-"+t},o.default.createElement(m.IconArrow,{name:"right"})),r)))},T.renderFileTypeFilterCheckboxes=function(){var e=[],r=0;return Object.keys(t.FileCategoryData).forEach(function(t){(T.props.isPaperEnabled||t!==p.FileCategory.PAPER)&&(e.push(T.createCheckBox(t,r>=_.NUMBER_FILE_TYPE_CHECKBOXES_ALWAYS_SHOWN)),r++)}),e},T.createCheckBox=function(e,r){var s=t.FileCategoryData[e].label,n=t.FileCategoryData[e].icon,i=t.FileCategoryData[e].tooltip,c="filter-type-file-"+e,d=T.state.showAllFilters?"":S.default({"filter-type-file-checkbox__hidden":r}),u=o.default.createElement("div",{className:"filter-type-file-icon-wrapper"},o.default.createElement(E.Tooltip,{tooltipContent:i,positioning:"left"},o.default.createElement(g.IconContent,{className:"filter-type-file-icon",name:n})));return o.default.createElement("div",{key:c,className:"filter-type-file-checkbox-wrapper "+d},o.default.createElement(a.Label,{htmlFor:c,className:"filter-type-file-label filter-type-file-label__full-width"},o.default.createElement(l.Checkbox,{name:e,"aria-checked":!0,checked:T.props.fileCategories[e],id:c,onChange:T.handleFileTypeChanged,className:"filter-type-file-checkbox"}),s,u))},T.handleClick=function(e){e.stopPropagation()};var b=T.props.searchBarExperiments,y=h.fileCategoriesToString(T.props.fileCategories);return f.isInDeletedFilterRightRailExperiment(b)?T.state={showAllFilters:!!y}:T.state={showAllFilters:!0},T.props.fileTypeFilterEnabled&&h.isInFileTypeFilterExperiment(b)&&void 0===t.FileCategoryData&&(t.FileCategoryData=(C={},C[p.FileCategory.IMAGE]={label:s._("Images"),tooltip:s._("JPG, PNG, GIF, and more",{comment:"Intended to represent 3 of the most common file formats for images."}),icon:"image-small"},C[p.FileCategory.DOCUMENT]={label:s._("Documents"),tooltip:s._("DOC, DOCX, TXT, and more",{comment:"Intended to represent 3 of the most common file formats for documents."}),icon:"txt-small"},C[p.FileCategory.PDF]={label:s._("PDFs"),tooltip:s._("PDF"),icon:"pdf-small"},C[p.FileCategory.SPREADSHEET]={label:s._("Spreadsheets"),tooltip:s._("XLSX, XLS, CSV, and more",{comment:"Intended to represent 3 of the most common file formats for spreadsheets."}),icon:"numbers-small"},C[p.FileCategory.PRESENTATION]={label:s._("Presentations"),tooltip:s._("PPT, PPTX, KEY, and more",{comment:"Intended to represent 3 of the most common file formats for presentations."}),icon:"keynote-small"},C[p.FileCategory.AUDIO]={label:s._("Audio"),tooltip:s._("MP3, WAV, MID, and more",{comment:"Intended to represent 3 of the most common file formats for audio."}),icon:"audio-small"},C[p.FileCategory.VIDEO]={label:s._("Video"),tooltip:s._("MOV, WMV, MP4, and more",{comment:"Intended to represent 3 of the most common file formats for videos."}),icon:"video-small"},C[p.FileCategory.FOLDER]={label:s._("Folders"),tooltip:s._("Dropbox folders"),icon:"folder-small"},C[p.FileCategory.PAPER]={label:s._("Paper docs"),tooltip:s._("Dropbox Paper docs"),icon:"paper-small"},C[p.FileCategory.OTHER]={label:s._("Other"),tooltip:s._("Other filetypes"),icon:"unknown-small"},C)),T;var C}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.fileCategories;e.fileTypeFilterEnabled||h.allCategoriesUnchecked(t)||this.props.onFiltersChanged({fileCategories:r.__assign({},v.FILE_CATEGORIES_UNCHECKED)}),d.prewarmFolderDialog()},t.prototype.render=function(){var e=this.props.searchBarExperiments;return o.default.createElement("div",{onClick:this.handleClick},o.default.createElement("div",{className:"filter-header"},o.default.createElement("h3",null,s._("Filter")),this.shouldRenderResetButton()&&this.renderResetButton()),o.default.createElement("div",{className:"filter-item"},this.renderPathFilter()),o.default.createElement("div",{className:"filter-item"},this.props.fileTypeFilterEnabled&&h.isInFileTypeFilterExperiment(e)&&this.renderFileTypeFilter()),o.default.createElement("div",{className:"filter-item"},f.isInDeletedFilterRightRailExperiment(e)&&this.renderDeletedFilter()))},t})(o.default.Component);t.SearchFilters=F}),define("modules/clean/search/search_results/sidebar_view",["require","exports","tslib","react","modules/core/exception","modules/clean/react/browse/util","modules/core/i18n","modules/clean/search/search_results/search_filters","modules/clean/react/app_actions_view"],function(e,t,r,o,s,n,a,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var c=(function(t){function c(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(c,t),c.prototype.render=function(){var t=this.props,r=t.context,c=t.selectedFiles,d=t.arePostTTIModulesLoaded,u=t.user,p=t.path,h=t.actionHandlers,f=t.searchBarExperiments,m=t.shouldShowDeletedFiles,_=t.viewType,S=t.responsive,g=t.onSearchFiltersChanged,E=t.fileCategories,v=t.isNautilusEnabled,w=t.isPaperEnabled,F=t.fileExtensionsConfigs;if(c.size){var T=[];if(d){var b=f.expSearchSuccessBanner;T=e("modules/clean/react/browse/file_actions").getActionsForFileCollection({files:c,context:r,user:u,viewType:_,fileExtensionsConfigs:F,actionHandlers:h,isSearchMode:!0,responsive:S,useSearchSuccessBanner:!!b})}if(T.length){s.assert("function"!=typeof T[0],"The primary menu item for AppActionsView must be a BrowseAppActionLink");var y=T[0],C={displayName:y.label,handleClick:y.performAction,iconName:y.iconName,className:y.className,disabled:y.disabled},I=T.slice(1).map(function(e){return"function"==typeof e?e:{displayName:e.label,handleClick:e.performAction,iconName:e.iconName,className:e.className,disabled:e.disabled}}),R=n.getSelectedFilesText(c,r);return o.default.createElement(l.AppActionsView,{headerText:R,popoverTriggerLabel:a._("Actions"),primaryMenuItems:[C],secondaryMenuItems:I,responsive:S})}}return o.default.createElement(i.SearchFilters,{user:u,searchBarExperiments:f,path:p,onFiltersChanged:g,deletedFiles:m,fileCategories:E,fileTypeFilterEnabled:v,isPaperEnabled:w})},c})(o.default.PureComponent);t.SearchResultsSidebarView=c}),define("modules/clean/search/search_results/store",["require","exports","tslib","external/immutable","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/react/selection","modules/clean/search/constants","modules/clean/react/browse/models","modules/clean/search/store_helpers","modules/clean/react/files_view/types"],function(e,t,r,o,s,n,a,i,l,c,d){"use strict";function u(){return null===f&&(f=new h),f}function p(){return null!==f}
Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),i=r.__importStar(i),c=r.__importStar(c);var h=(function(e){function t(t){var r=e.call(this,t)||this;return r._resetSearchResults(),r}return r.__extends(t,e),t.prototype._resetSearchResults=function(){this._browseContext=void 0,this._rawQuery="",this._latestQuery="",this._loadingState=i.SearchLoadingState.LOADING_FIRST_PAGE,this._fullSearchResults=o.OrderedMap(),this._searchResults=o.List(),this._selection=void 0,this._hasMoreLiveResults=!0,this._numDeletedResults=0,this._hasMoreDeletedResults=!0,this._didLoadDeletedResults=!1,this._latestFileCategories=i.FILE_CATEGORIES_UNCHECKED},t.prototype.rawQuery=function(){return this._rawQuery},t.prototype.searchSessionId=function(){return this._searchSessionId},t.prototype.queryId=function(){return this._queryId},t.prototype.browseContext=function(){return this._browseContext||(this._browseContext=new l.BrowseContext)},t.prototype.latestQuery=function(){return this._latestQuery},t.prototype.loadingState=function(){return this._loadingState},t.prototype.searchResults=function(){return this._searchResults},t.prototype.fullSearchResults=function(){return this._fullSearchResults},t.prototype.hasMoreResults=function(e){return void 0===e&&(e=!1),this._hasMoreLiveResults||e&&this._hasMoreDeletedResults},t.prototype.numDeletedResults=function(){return this._numDeletedResults},t.prototype.didLoadDeletedResults=function(){return this._didLoadDeletedResults},t.prototype.selection=function(){return this._selection||(this._selection=a.createSelection())},t.prototype.selectedFiles=function(){var e=this,t=this._searchResults.filter(function(t){return t instanceof l.File&&e.selection().selected.has(t.fq_path)});return o.OrderedMap(t.map(function(e){return[e.fq_path,e]}))},t.prototype.latestFileCategories=function(){return this._latestFileCategories},t.prototype._setRawQuery=function(e,t){t?this._searchSessionId=t:c.shouldStartNewSearchSession(this._rawQuery,e)&&(this._searchSessionId=c.generateRandomId()),this._rawQuery=e},t.prototype._setSearchQuery=function(e){var t=e.query;this._setRawQuery(t),this.emit_change()},t.prototype._startSearch=function(e){var t=e.query,r=e.searchSessionId,o=e.queryId,s=e.fileCategories;this._setRawQuery(t,r),this._latestQuery=c.normalize(t),this._loadingState=i.SearchLoadingState.LOADING_FIRST_PAGE,this._hasMoreLiveResults=!0,this._numDeletedResults=0,this._hasMoreDeletedResults=!0,this._didLoadDeletedResults=!1,this._queryId=o,this._latestFileCategories=s?s:i.FILE_CATEGORIES_UNCHECKED,this.emit_change()},t.prototype._setSearchResults=function(e){var t=e.searchResults,r=e.context,o=e.deletedFiles;e.queryId===this.queryId()&&(this._setSearchResultsInternal(t,o),this._loadingState=i.SearchLoadingState.LOADED,r&&(this._browseContext=r),this._updateMoreResults(t),this.emit_change())},t.prototype._setFullSearchResults=function(e){var t=e.searchResults;if(e.queryId===this._queryId){for(var r=0,o=t;r<o.length;r++){var s=o[r];this._fullSearchResults=this._fullSearchResults.set(s.fq_path,s)}this._loadingState=i.SearchLoadingState.LOADED,this.emit_change()}},t.prototype._setSearchResultsInternal=function(e,t){this._searchResults=o.List(e),t&&(this._numDeletedResults=e.length)},t.prototype._continueSearch=function(e){e.didLoadDeletedResults&&(this._didLoadDeletedResults=!0),this._loadingState=i.SearchLoadingState.LOADING_ADDITIONAL_PAGE,this.emit_change()},t.prototype._appendSearchResults=function(e){var t=e.deleted,r=e.searchResults;t&&(this._numDeletedResults+=r.length),this._searchResults=this._searchResults.concat(r),this._loadingState=i.SearchLoadingState.LOADED,this._updateMoreResults(r),this.emit_change()},t.prototype._setFolderSize=function(){for(var e in this._searchResults.toArray())if(this._searchResults.toArray()[e]instanceof l.File){var t=this._searchResults.toArray()[e];t.is_dir&&(this._searchResults=this._searchResults.set(Number(e),t.updateSize(t.bytes,d.FetchFolderSizeState.COMPLETE)))}},t.prototype._clearSearch=function(){this._resetSearchResults(),this.emit_change()},t.prototype._updateMoreResults=function(e){var t=e.length===i.MaxResults.MAX_SEARCH_RESULTS;this._hasMoreLiveResults?this._hasMoreLiveResults=t:this._hasMoreDeletedResults&&(this._hasMoreDeletedResults=t)},t.prototype._setSearchSelection=function(e){var t=e.selection;this._selection=t,this.emit_change()},t.prototype._selectFirstFile=function(){var e=this._searchResults.find(function(e){return e instanceof l.File});e&&this._setSearchSelection({selection:a.createSelection([e.fq_path])})},t.prototype._applyFileDeltas=function(e){var t=e.fileDeltas;if(t){for(var r=function(e,t){var r=void 0;!e&&t?o._searchResults=o._searchResults.push(t):e&&!t?(r=o._searchResults.findIndex(function(t){return t instanceof l.File&&s.paths_are_equal(t.fq_path,e)}),o._searchResults=o._searchResults.delete(r)):e&&t&&(r=o._searchResults.findIndex(function(t){return t instanceof l.File&&s.paths_are_equal(t.fq_path,e)}),o._searchResults=r>-1?o._searchResults.set(r,t):o._searchResults.push(t))},o=this,n=0,a=t;n<a.length;n++){var i=a[n];r(i.before,i.after)}this.emit_change()}},t.prototype._new_payload=function(e){switch(e.action.type){case i.START_SEARCH_ACTION:this._startSearch(e.action.data);break;case i.SET_SEARCH_RESULTS_ACTION:this._setSearchResults(e.action.data);break;case i.CONTINUE_SEARCH_ACTION:this._continueSearch(e.action.data);break;case i.APPEND_SEARCH_RESULTS_ACTION:this._appendSearchResults(e.action.data);break;case i.SET_FULL_SEARCH_RESULTS_ACTION:this._setFullSearchResults(e.action.data);break;case i.SET_SEARCH_SELECTION_ACTION:this._setSearchSelection(e.action.data);break;case i.CHANGE_FILES_ACTION:this._applyFileDeltas(e.action.data);break;case i.CLEAR_SEARCH_ACTION:this._clearSearch();break;case i.SELECT_FIRST_FILE_ACTION:this._selectFirstFile();break;case i.SET_FOLDER_SIZE_ACTION:this._setFolderSize()}},t})(n.Store);t.SearchResultsStore=h;var f=null;t.getSearchResultsStore=u,t.searchResultsStoreInstantiated=p}),define("modules/clean/search/search_results/view",["require","exports","tslib","external/lodash","react","spectrum/table","spectrum/tip_card","modules/clean/analytics","modules/clean/em_string","modules/clean/filepath","modules/clean/history","modules/clean/static_urls","modules/clean/react_format","modules/clean/react/files_view/constants","modules/clean/react/files_view/controller","modules/clean/react/files_view/file_list_empty_folder_table","modules/clean/react/files_view/fixed_table_head","modules/clean/react/files_view/types","modules/clean/react/image","modules/clean/search/api_helpers","modules/clean/search/constants","modules/clean/search/search_bar/experiments","modules/clean/search/search_helpers","modules/core/i18n","modules/core/uri"],function(e,t,r,o,s,n,a,i,l,c,d,u,p,h,f,m,_,S,g,E,v,w,F,T,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importDefault(s),c=r.__importStar(c),d=r.__importDefault(d),v=r.__importStar(v),F=r.__importStar(F);var y=(function(e){function t(t){var o=e.call(this,t)||this;return o._handleScroll=function(){o.props.onScroll()},o._ensureFileViewerClosedIfNotPreviewing=function(){var e=d.default.deconstruct_url().qargs;o.props.ensureFileViewerClosedIfNotPreviewing(e)},o._handleFullSearchOnClick=function(e){e.preventDefault(),o.props.onSearch(o.props.latestQuery,"/")},o._handleEmptyFolderViewTTI=function(){o.props.handleComponentTTI("FilesViewController")},o._logHelpSearchClick=function(){var e=o.props,t=e.searchSessionId,r=e.user,s=e.viewType,n={search_type:"full_page",viewport:"full-view",search_session_id:t,view_type:s,timezone_offset:E.getCurrentTimezoneOffset()};i.SearchClientActivityLogger.log("help_center_link_clicked",r.id,n)},o._handleSearchAllFiles=function(e){e.preventDefault();var t=o.props.path;o.props.onSearchFiltersChanged({path:t,deletedFiles:!1})},o._handleSearchDeletedFiles=function(e){e.preventDefault();var t=o.props.path;o.props.onSearchFiltersChanged({path:t,deletedFiles:!0})},o._handleRemoveAllFilters=function(e){e.preventDefault();var t=o.props.shouldShowDeletedFiles;o.props.onSearchFiltersChanged({path:"/",deletedFiles:t,fileCategories:r.__assign({},v.FILE_CATEGORIES_UNCHECKED)})},o._getEmptyFolderViewUrl=function(e,t){var r=o.props,s=r.user,n=r.latestQuery,a=r.searchSessionId;return F.buildSearchURL({user:s,searchPath:e,normalizedQuery:n,searchSessionId:a,searchToken:F.getSearchCsrfToken(),qargs:{d:t?"1":void 0}}).toString()},o._getRemoveAllFiltersViewUrl=function(e){var t=o.props,r=t.user,s=t.latestQuery,n=t.searchSessionId;return F.buildSearchURL({user:r,searchPath:"/",normalizedQuery:s,searchSessionId:n,searchToken:F.getSearchCsrfToken(),qargs:{d:e?"1":void 0,file_categories:void 0}}).toString()},o._renderEmptyFolderSubtitle=function(){var e=o.props,t=e.path,r=e.shouldShowDeletedFiles,n=e.searchBarExperiments,a=e.fileCategories,i=e.latestQuery;return c.paths_are_equal(t,"/")&&!F.fileCategoriesSet(a,n)?r?p.reactFormat(T._("Try different keywords or <Link>search files that aren’t deleted</Link>"),{Link:s.default.createElement("a",{href:o._getEmptyFolderViewUrl(t,!1),onClick:o._handleSearchAllFiles})}):w.isInDeletedFilterRightRailExperiment(n)?p.reactFormat(T._("Try different keywords or <Link>search deleted files</Link>"),{Link:s.default.createElement("a",{href:o._getEmptyFolderViewUrl(t,!0),onClick:o._handleSearchDeletedFiles})}):w.isInHelpLinkExperiment(n)?s.default.createElement("ul",{className:"search-results__no-results-links"},s.default.createElement("li",null,T._("To try again, enter different search words")),s.default.createElement("li",null,p.reactFormat(T._("To get help, head to the <Link>Dropbox help center</Link>"),{Link:s.default.createElement("a",{href:"https://www.dropbox.com/help/search?q="+encodeURIComponent(i),target:"_blank",rel:"noopener",onClick:o._logHelpSearchClick})}))):T._("Try different keywords"):r?p.reactFormat(T._("<LinkScope>Search all folders</LinkScope> or <LinkDeleted>files that aren’t deleted</LinkDeleted>"),{LinkScope:s.default.createElement("a",{href:o._getEmptyFolderViewUrl("/",r),onClick:o._handleRemoveAllFilters}),LinkDeleted:s.default.createElement("a",{href:o._getEmptyFolderViewUrl(t,!1),onClick:o._handleSearchAllFiles})}):w.isInDeletedFilterRightRailExperiment(n)?p.reactFormat(T._("<LinkScope>Search all folders</LinkScope> or <LinkDeleted>deleted files</LinkDeleted>"),{LinkScope:s.default.createElement("a",{href:o._getEmptyFolderViewUrl("/",r),onClick:o._handleRemoveAllFilters}),LinkDeleted:s.default.createElement("a",{href:o._getEmptyFolderViewUrl(t,!0),onClick:o._handleSearchDeletedFiles})}):w.isInHelpLinkExperiment(n)?s.default.createElement("ul",{className:"search-results__no-results-links"},s.default.createElement("li",null,p.reactFormat(T._("To try again, enter different search words or <LinkScope>clear all filters</LinkScope>"),{LinkScope:s.default.createElement("a",{href:o._getRemoveAllFiltersViewUrl(),onClick:o._handleRemoveAllFilters})})),s.default.createElement("li",null,p.reactFormat(T._("To get help, head to the <Link>Dropbox help center</Link>"),{Link:s.default.createElement("a",{href:"https://www.dropbox.com/help/search?q="+encodeURIComponent(i),target:"_blank",rel:"noopener",onClick:o._logHelpSearchClick})}))):p.reactFormat(T._("Try <LinkScope>resetting all filters</LinkScope>"),{LinkScope:s.default.createElement("a",{href:o._getRemoveAllFiltersViewUrl(),onClick:o._handleRemoveAllFilters})})},o._renderEmptyFolderView=function(e){var t=o.props.path,r=c.paths_are_equal(t,"/"),a=T._("No results found");if(o.shouldRenderNewEmptyState()){o._handleEmptyFolderViewTTI();var i=s.default.createElement(n.Table,{columnFlex:[h.CHECKBOX_CELL_FLEX,1]},s.default.createElement(_.FixedTableHead,{offsetHeight:h.DEFAULT_COLUMN_HEADER_HEIGHT},s.default.createElement(n.TableHeadCell,{className:"brws-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:"columnheader",scope:"col"},s.default.createElement("div",{className:"brws-vertically-center"})),s.default.createElement(n.TableHeadCell,{role:"columnheader",scope:"col",className:"brws-column-header-table-cell"},s.default.createElement("div",{className:"normal brws-column-header-menu"},s.default.createElement("span",{className:"brws-column-header-menu-trigger-disabled"},o._searchResultsTitle(e))))),s.default.createElement("tbody",null,s.default.createElement("tr",null,s.default.createElement("td",null),s.default.createElement("td",null))));return s.default.createElement("div",null,!w.isInSortByDateExperiment(o.props.searchResultsExperiments)&&i,s.default.createElement("div",{className:"u-font-center u-pad-top-xl"},s.default.createElement(g.Image,{src:u.static_url("/static/images/empty_states/search-vflHMNVT9.png"),srcHiRes:u.static_url("/static/images/empty_states/search@2x-vfly2B3kk.png"),alt:""}),s.default.createElement("h2",{className:"u-font-strong empty-folder-table-title"},a),s.default.createElement("span",null,o._renderEmptyFolderSubtitle())))}var l=r?T._("Please update your search and try again"):T._("Search all of my Dropbox instead"),d=r?void 0:o._getFullSearchLink(),p=r?void 0:o._handleFullSearchOnClick;return s.default.createElement(m.EmptyFolderTable,{title:a,subtitle:l,subtitleLink:d,subtitleOnClick:p,onTTI:o._handleEmptyFolderViewTTI})},o._renderDeletedFilesTipcard=function(){return w.isInDeletedFilterRightRailExperiment(o.props.searchBarExperiments)&&o.props.shouldShowDeletedFiles&&o.props.loadingState===v.SearchLoadingState.LOADED&&o.props.searchResults.count()>0?s.default.createElement(a.TipCard,{className:"mc-tip-card--deleted-files"},p.reactFormat(T._("Can’t find what you’re looking for? <a>View all deleted files</a>"),{a:s.default.createElement("a",{href:"/deleted_files"})})):null},o._renderFixedHeader=function(e){return w.isInSortByDateExperiment(o.props.searchResultsExperiments)?s.default.createElement("div",{className:"search-results-header"},s.default.createElement("h1",{className:"search-results-title"},T._("Search results")),s.default.createElement("div",{className:"search-results-subtitle"},o._searchResultsTitle(e))):null},o.state={},o}return r.__extends(t,e),t.prototype.componentWillMount=function(){d.default.add_callback("/search",this._ensureFileViewerClosedIfNotPreviewing)},t.prototype.componentDidMount=function(){window.addEventListener("scroll",this._handleScroll)},t.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this._handleScroll),d.default.remove_callback("/search",this._ensureFileViewerClosedIfNotPreviewing)},t.prototype._getFullSearchLink=function(){var e=this.props,t=e.latestQuery,r=e.searchSessionId,o=e.user;return b.URI.parse("/search/"+o.role).setQuery({path:"/",query:t,searchSessionId:r}).toString()},t.prototype.shouldRenderNewEmptyState=function(){var e=this.props.searchBarExperiments;return F.isInFileTypeFilterExperiment(e)||w.isInDeletedFilterRightRailExperiment(e)||w.isInSinglePageSearchExperiment(e)||w.isInHelpLinkExperiment(e)},t.prototype._searchResultsTitle=function(e){var t=w.isInSinglePageSearchExperiment(this.props.searchBarExperiments)&&this.props.loadingState===v.SearchLoadingState.LOADING_FIRST_PAGE?this.props.queryForResultsTitle:this.props.latestQuery,r=this.props,o=r.searchResults,n=r.path,a=r.viewType,i=r.shouldShowDeletedFiles,d=o.size,u=c.paths_are_equal(n,"/");if(!this.shouldRenderNewEmptyState()&&0===d)return"";var h,f=e.isMatchedMedium?e.isMatchedLarge?30:20:10;a===S.ViewType.List&&(f/=2);var m=w.isInSortByDateExperiment(this.props.searchResultsExperiments);if(u){var _=l.Emstring.em_snippet(t,f,.6);h=i?m?p.reactFormat(T.ungettext("%(size)d deleted result for <strong>%(query)s</strong>","%(size)d deleted results for <strong>%(query)s</strong>",d).format({size:d,query:_}),{strong:s.default.createElement("strong",null)}):T.ungettext("%(size)d deleted result for “%(query)s”","%(size)d deleted results for “%(query)s”",d).format({size:d,query:_}):m?p.reactFormat(T.ungettext("%(size)d result for <strong>%(query)s</strong>","%(size)d results for <strong>%(query)s</strong>",d).format({size:d,query:_}),{strong:s.default.createElement("strong",null)}):T.ungettext("%(size)d result for “%(query)s”","%(size)d results for “%(query)s”",d).format({size:d,query:_})}else{var g=l.Emstring.em_snippet(c.filename(n),f/2,.6),_=l.Emstring.em_snippet(t,f/2,.6);h=i?m?p.reactFormat(T.ungettext("%(size)d deleted result for <strong>%(query)s</strong> in %(path)s","%(size)d deleted results for <strong>%(query)s</strong> in %(path)s",d).format({size:d,query:_,path:g}),{strong:s.default.createElement("strong",null)}):p.reactFormat(T.ungettext("%(size)d deleted result for “%(query)s” in <strong>%(path)s</strong>","%(size)d deleted results for “%(query)s” in <strong>%(path)s</strong>",d).format({size:d,query:_,path:g}),{strong:s.default.createElement("strong",null)}):m?p.reactFormat(T.ungettext("%(size)d result for <strong>%(query)s</strong> in %(path)s","%(size)d results for <strong>%(query)s</strong> in %(path)s",d).format({size:d,query:_,path:g}),{strong:s.default.createElement("strong",null)}):p.reactFormat(T.ungettext("%(size)d result for “%(query)s” in <strong>%(path)s</strong>","%(size)d results for “%(query)s” in <strong>%(path)s</strong>",d).format({size:d,query:_,path:g}),{strong:s.default.createElement("strong",null)})}return h},t.prototype._getLoadingState=function(){var e=this.props,t=e.searchResults,r=e.searchBarExperiments,o=e.loadingState;return w.isInSinglePageSearchExperiment(r)&&!t.isEmpty()?S.LoadingState.LOADED:o===v.SearchLoadingState.LOADING_FIRST_PAGE?S.LoadingState.LOADING_FIRST_PAGE:o===v.SearchLoadingState.LOADING_ADDITIONAL_PAGE?S.LoadingState.LOADING_REMAINING_PAGES:S.LoadingState.LOADED},t.prototype._renderSearchResultItems=function(e){var t=this.props,n=t.getOverflowMenuActions,a=t.onFocusSearchBar,i=t.onLocationLinkClick,l=t.onNavigateToFileOrFolder,c=t.onNavigateToParentFolder,d=t.onOpenPaper,u=t.context,p=t.fileRename,m=t.searchResults,_=t.getIsFileJumping,g=t.isFileViewerShown,E=t.arePostTTIModulesLoaded,v=t.handleComponentTTI,F=t.onSelectionChange,T=t.selectedFiles,b=t.selection,y=t.setFileUploaderPath,C=t.viewType,I=t.user,R=t.path,D=t.filesViewActionHandlers,N=t.renderSharedWithController,P=t.hrefForFile,A=t.starredState,O=t.pageHeaderHeight,L=t.onStarClick,x=t.fileExtensionsConfigs,M=t.searchResultsExperiments,U=this.props.searchBarExperiments.expSearchSuccessBanner;return s.default.createElement(f.FilesViewController,r.__assign({},D,{getOverflowMenuActions:n,onLocationLinkClick:i,onNavigateToFileOrFolder:l,onNavigateToParentFolder:c,onOpenPaper:d,context:u,customEmptyFolderView:this._renderEmptyFolderView,createNewFolderState:S.NewFolderCreationState.CREATE_FOLDER_INACTIVE,fileRename:p,items:m,getIsFileJumping:_,isFileViewerShown:g,isSearchMode:!0,arePostTTIModulesLoaded:E,isTextSelectable:!1,loadingState:this._getLoadingState(),onComponentTTI:v,onSelectionChange:F,onSortChange:o.noop,onFocusSearchBar:a,path:R,selectedFiles:T,selection:b,setFileUploaderPath:y,showFileUploaderModal:o.noop,user:I,viewType:C,totalNumFiles:m.size,responsive:e,columns:this._generateColumns(e),renderSharedWithController:N,hrefForFile:P,viewTypes:h.AllViewTypes,viewTypeLabels:h.ViewTypeLabels,starredState:A,pageHeaderHeight:O,fileExtensionsConfigs:x,onStarClick:L,useSearchSuccessBanner:!!U,isStickyColumnHeader:w.isInSortByDateExperiment(M)}))},t.prototype._generateColumns=function(e){var t=this;return(this.props.shouldShowDeletedFiles?h.SEARCH_LIST_VIEW_COLUMNS_DELETED:h.SEARCH_LIST_VIEW_COLUMNS).map(function(o,s){return r.__assign({},o,{label:0===s?t._searchResultsTitle(e):o.label})})},t.prototype.render=function(){var e=this.props.responsive;return s.default.createElement("div",{className:"search-results"},this._renderFixedHeader(e),this._renderSearchResultItems(e),this._renderDeletedFilesTipcard())},t})(s.default.Component);t.SearchResultsView=y}),define("modules/clean/sharing/shared_folder_invite/shared_folder_invite_async",["require","exports","tslib","modules/clean/react/async/loadable","modules/clean/web_timing_logger"],function(e,t,r,o,s){"use strict";var n=this;Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncSharedFolderInvite=o.Loadable({loader:function(){return r.__awaiter(n,void 0,void 0,function(){var t;return r.__generator(this,function(o){switch(o.label){case 0:return[4,s.waitForTTI()];case 1:return o.sent(),[4,new Promise(function(t,r){e(["modules/clean/sharing/shared_folder_invite/shared_folder_invite"],t,r)}).then(r.__importStar)];case 2:return t=o.sent().SharedFolderInvite,[2,t]}})})}})}),define("modules/clean/web_upload_action_logger",["require","exports","tslib","modules/clean/ajax"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.MAX_ERRORS=3;var s=(function(){function e(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}return e.prototype.log=function(e,r,s){var n=this;return this.shouldReport&&(this.errorCount<t.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise(function(a,i){o.SilentBackgroundRequest({url:"/log/web_upload_action",data:{_subject_uid:e,event_type:r,extra_params:JSON.stringify(s)},error:function(e){429===e.status?n.errorCount=t.MAX_ERRORS:n.errorCount++,n.lastError=Date.now(),i(e)},success:function(e){try{var t=JSON.parse(e);t&&!t.continue_sending&&(n.shouldReport=!1),n.errorCount=0,a(e)}catch(e){throw n.errorCount++,n.lastError=Date.now(),i(e),e}}})}):Promise.resolve({})},e})();t.WebUploadActionLog=new s,t.WebUploadActionLogClass=s}),define("retrieval-components/collapsable-section/collapsable-section",["require","exports","react","classnames","spectrum/button"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollapsableSection=function(e){var t=e.title,n=e.isOpen,a=e.onHeaderClick,i=e.children,l=e.top,c=e.strings;return r.createElement("div",{className:o({"rc-collapsable-section":!0,"rc-collapsable-section--closed":!n}),style:{top:l}},r.createElement("h2",{className:"rc-collapsable-section__header"},r.createElement("span",null,t),r.createElement(s.Button,{onClick:a,className:"rc-collapsable-section__toggle",variant:"styleless"},n?c.buttonClose:c.buttonOpen)),r.createElement("div",{style:{display:n?void 0:"none"}},i))}}),define("retrieval-components/collapsable-section",["require","exports","tslib","retrieval-components/collapsable-section/collapsable-section"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)}),define("retrieval-components/pinned-item",["require","exports","tslib","retrieval-components/pinned-item/pinned-item"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)}),define("retrieval-components/pinned-item/pinned-item",["require","exports","react","classnames","retrieval-components/thumbnail-icon","retrieval-components/truncated-string","spectrum/icon_action","spectrum/icon_content","spectrum/overflow_button","spectrum/popover"],function(e,t,r,o,s,n,a,i,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){return"menuOptions"in e},u=function(e){return!!e.isFolder};t.PinnedItem=function(e){var t=function(t){t.preventDefault(),e.onClick()};return r.createElement("div",{className:o(["rc-pinned-item__wrapper",e.className])},r.createElement("a",{className:"rc-pinned-item",href:e.url,onClick:t},r.createElement(a.IconAction,{name:"pin",className:"rc-pinned-item__pin-icon"}),r.createElement("div",{className:"rc-pinned-item__file-icon"},u(e)?r.createElement("span",null,r.createElement(i.IconContent,{name:e.folderIcon})):r.createElement(s.ThumbnailIcon,{path:e.filename,variant:"large",thumbnailUrl:e.thumbnailUrl})),r.createElement(n.TruncatedString,{text:e.filename,className:"rc-pinned-item__name",variant:u(e)?n.TruncatedStringVariant.TRUNCATED_STRING_LAST_WORD:n.TruncatedStringVariant.TRUNCATED_STRING_FILE_EXTENSION})),d(e)?r.createElement(c.Popover,{className:"rc-pinned-item__menu-button",onSelection:e.onMenuOptionClick},r.createElement(c.PopoverTrigger,null,r.createElement(l.OverflowButton,{tagName:"span","aria-label":e.menuLabel,size:"small"})),r.createElement(c.PopoverContent,{attachment:"right"},e.menuOptions.map(function(e){var t=e.key,o=e.label,s=e.isDisabled;return r.createElement(c.PopoverContentItem,{key:t,value:t,disabled:s},o)}))):null)}}),define("retrieval-components/thumbnail-icon",["require","exports","tslib","retrieval-components/thumbnail-icon/thumbnail-icon"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)}),define("retrieval-components/thumbnail-icon/thumbnail-icon",["require","exports","tslib","react","spectrum/file_icon"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(t){var r=e.call(this,t)||this;return r.addEventListeners=function(){r.thumbnail&&(r.removeEventListeners(),r.thumbnail.addEventListener("load",r.handleImageLoaded),r.thumbnail.addEventListener("error",r.handleImageError))},r.removeEventListeners=function(){r.thumbnail&&(r.thumbnail.removeEventListener("load",r.handleImageLoaded),r.thumbnail.removeEventListener("error",r.handleImageError))},r.handleImageLoaded=function(){r.setState({thumbnailLoadingState:"loaded"}),r.removeEventListeners()},r.handleImageError=function(){r.setState({thumbnailLoadingState:"error"})},r.setThumnailRef=function(e){r.thumbnail=e,r.addEventListeners()},r.className=function(){return["rc-thumbnail-icon","rc-thumbnail-icon--"+(r.props.variant||"small"),r.props.className].join(" ")},r.renderFileIcon=function(){return o.createElement(s.FileIcon,{key:"thumbnail",path:r.props.path,variant:r.props.variant,className:"rc-thumbnail-icon__file-icon"})},r.renderIcon=function(){return r.props.thumbnailUrl?"loaded"===r.state.thumbnailLoadingState?o.createElement("div",{className:"rc-thumbnail-icon__thumbnail"},o.createElement("img",{src:r.props.thumbnailUrl})):[o.createElement("img",{key:"loader",src:r.props.thumbnailUrl,ref:r.setThumnailRef,className:"rc-thumbnail-icon__loader","aria-hidden":!0}),r.renderFileIcon()]:r.renderFileIcon()},r.state={thumbnailLoadingState:r.props.thumbnailUrl?"loading":"loaded"},r}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){this.props.thumbnailUrl!==e.thumbnailUrl&&(this.removeEventListeners(),this.setState({thumbnailLoadingState:e.thumbnailUrl?"loading":"loaded"}),e.thumbnailUrl&&this.addEventListeners())},t.prototype.componentWillUnmount=function(){this.removeEventListeners()},t.prototype.render=function(){return o.createElement("div",{className:this.className()},this.renderIcon())},t})(o.PureComponent);t.ThumbnailIcon=n}),define("retrieval-components/truncated-string",["require","exports","tslib","retrieval-components/truncated-string/truncated-string"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)}),define("retrieval-components/truncated-string/truncated-string",["require","exports","tslib","react","classnames","spectrum/tooltip","spectrum/dimensions"],function(e,t,r,o,s,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e.TRUNCATED_STRING_END="TRUNCATED_STRING_END",e.TRUNCATED_STRING_START="TRUNCATED_STRING_START",e.TRUNCATED_STRING_MIDDLE="TRUNCATED_STRING_MIDDLE",e.TRUNCATED_STRING_LAST_WORD="TRUNCATED_STRING_LAST_WORD",e.TRUNCATED_STRING_FILE_EXTENSION="TRUNCATED_STRING_FILE_EXTENSION"})(i=t.TruncatedStringVariant||(t.TruncatedStringVariant={})),t.TruncatedStringVariantClass=(c={},c[i.TRUNCATED_STRING_END]="rc-truncated-string--end",c[i.TRUNCATED_STRING_START]="rc-truncated-string--start",c[i.TRUNCATED_STRING_MIDDLE]="rc-truncated-string--middle",c[i.TRUNCATED_STRING_LAST_WORD]="rc-truncated-string--last-word",c[i.TRUNCATED_STRING_FILE_EXTENSION]="rc-truncated-string--file-extension",c);var l=(function(e){function l(t){var r=e.call(this,t)||this;return r.setCalculator=function(e){r.calculator=e},r.setWrapper=function(e){r.wrapper=e},r.updateTooltip=function(){if(r.calculator&&r.wrapper){var e=r.calculator.getBoundingClientRect().width,t=r.wrapper.getBoundingClientRect().width;r.setState({showTooltip:e>t})}},r.debouncedUpdateTooltip=function(){clearTimeout(r.updateTooltipTimeout),r.updateTooltipTimeout=setTimeout(function(){return r.updateTooltip()},50)},r.calculatePiecesFromProps=function(e){void 0===e&&(e=r.props);var t=e.text;switch(e.variant){case i.TRUNCATED_STRING_END:case i.TRUNCATED_STRING_START:default:return[t];case i.TRUNCATED_STRING_MIDDLE:var o=Math.floor(2*t.length/3),s=t.indexOf(" ",o);return[t.substr(0,s),t.substr(s)];case i.TRUNCATED_STRING_LAST_WORD:var n=t.trim().split(" "),a=n.pop();return[n.join(" "),a];case i.TRUNCATED_STRING_FILE_EXTENSION:var n=t.trim().split(".");if(n.length<=1)return[t];var a=n.pop();return[n.join("."),"."+a]}},r.state={pieces:r.calculatePiecesFromProps(t),showTooltip:!1},r}return r.__extends(l,e),l.prototype.componentDidMount=function(){this.updateTooltip()},l.prototype.componentWillReceiveProps=function(e){this.setState({pieces:this.calculatePiecesFromProps(e),showTooltip:!1})},l.prototype.componentDidUpdate=function(){},l.prototype.render=function(){var e=this,r=this.props,i=r.className,l=r.variant,c=r.text,d=this.state,u=d.pieces,p=d.showTooltip;return o.createElement(n.Tooltip,{positioning:"below",tooltipContent:c,showOnMouseMove:p,wrapperClassName:"rc-truncated-string__tooltip"},o.createElement(a.Dimensions,null,function(r){r.width;return e.debouncedUpdateTooltip(),o.createElement("span",{className:s(["rc-truncated-string",i,t.TruncatedStringVariantClass[l]]),ref:e.setWrapper},o.createElement("span",{className:"rc-truncated-string__calculator","aria-hidden":!0,ref:e.setCalculator},c),u.map(function(e,t){return o.createElement("span",{key:t,className:"rc-truncated-string__piece"},e)}))}))},l})(o.PureComponent);t.TruncatedString=l;var c}),define("spectrum/icon_bundles/mode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS={grid:{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"},innerHtml:'<g fill="#637282" fill-rule="evenodd"><path d="M7 7h2v2H7zM11 7h2v2h-2zM15 7h2v2h-2zM7 11h2v2H7zM11 11h2v2h-2zM15 11h2v2h-2zM7 15h2v2H7zM11 15h2v2h-2zM15 15h2v2h-2z"></path></g>'},list:{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"},innerHtml:'<g fill="#637282" fill-rule="evenodd"><path d="M6 15h2v2H6zM10 15h8v2h-8zM6 11h2v2H6zM10 11h8v2h-8zM6 7h2v2H6zM10 7h8v2h-8z"></path></g>'},tiles:{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"},innerHtml:'<g fill="#637282" fill-rule="evenodd"><path d="M7 7h4v4H7zM13 7h4v4h-4zM13 13h4v4h-4zM7 13h4v4H7z"></path></g>'}}}),define("spectrum/icon_mode",["require","exports","tslib","tslib","react","spectrum/icon_templates/stateless","spectrum/icon_bundles/mode"],function(e,t,r,o,s,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),t.ICONS=a.ICONS,t.IconMode=function(e){var t=e.name,r=a.ICONS[t],i=r.attrs,l=r.innerHtml,c=s.createElement("svg",o.__assign({},i,{dangerouslySetInnerHTML:{__html:l}}));return s.createElement(n.Component,o.__assign({icon:c},e,{key:t}))},t.IconMode.displayName="IconMode"});
//# sourceMappingURL=pkg-browse.min.js-vflQcSk7q.map