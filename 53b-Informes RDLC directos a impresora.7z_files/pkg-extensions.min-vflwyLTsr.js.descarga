define("modules/clean/react/app_actions/category",["require","exports","modules/core/i18n"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={0:{displayName:n._("DEFAULT")},1:{displayName:n._("Send for signature"),developerDescription:n._("Send for signature")},2:{displayName:n._("Edit"),developerDescription:n._("PDF editing")},3:{displayName:n._("View or Edit"),developerDescription:n._("View or edit")},4:{displayName:n._("Edit"),developerDescription:n._("Image editing")},5:{displayName:n._("Video comment"),developerDescription:n._("Video comment")},6:{displayName:n._("Send fax"),developerDescription:n._("Send fax")}};(function(e){function t(e){return a[e]||null}function n(e){var n=t(e);return n&&n.displayName}function i(e){var n=t(e);return n&&n.developerDescription||null}e.DEFAULT=0,e.ESIGNATURE=1,e.PDF_EDITING=2,e.VIEW_OR_EDIT=3,e.IMAGE_EDITING=4,e.VIDEO_COMMENT=5,e.SEND_FAX=6,e.getDisplayName=n,e.getDeveloperDescription=i})(t.Category||(t.Category={}))}),define("modules/clean/react/app_actions/data/action_creators",["require","exports","tslib","modules/clean/react/extensions/client","modules/clean/react/app_actions/data/types"],function(e,t,n,a,i){"use strict";var s=this;Object.defineProperty(t,"__esModule",{value:!0}),t.updateExtensionConfigWithNewFiles=function(e){var r=e.files,o=e.user;return function(e,c){return n.__awaiter(s,void 0,void 0,function(){var s,c;return n.__generator(this,function(n){switch(n.label){case 0:return[4,a.getExtensionsClient().getActionsForFileBatch(r,o.id)];case 1:return s=n.sent(),e(t.setExtensionsFeatureFlags({featureFlags:a.getExtensionsClient().getFeatureFlags()})),c=a.getExtensionsClient().getAppIcons(),e({type:i.ActionTypes.REFRESH_ICONS,payload:{icons:c}}),e({type:i.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES,payload:{fileExtensionsConfigs:s}}),[2]}})})}},t.setExtensionsFeatureFlags=function(e){var t=e.featureFlags;return{type:i.ActionTypes.SET_EXTENSIONS_FEATURE_FLAGS,payload:{featureFlags:t}}},t.refreshAppIcons=function(e){var t=e.user;return function(e,r){return n.__awaiter(s,void 0,void 0,function(){var s;return n.__generator(this,function(n){switch(n.label){case 0:return[4,a.getExtensionsClient().refreshAppIcons(t.id)];case 1:return n.sent(),s=a.getExtensionsClient().getAppIcons(),e({type:i.ActionTypes.REFRESH_ICONS,payload:{icons:s}}),[2]}})})}}}),define("modules/clean/react/app_actions/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES="EXTENSIONS/UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES",e.SET_EXTENSIONS_FEATURE_FLAGS="EXTENSIONS/SET_EXTENSIONS_FEATURE_FLAGS",e.REFRESH_ICONS="EXTENSIONS/REFRESH_ICONS"})(t.ActionTypes||(t.ActionTypes={}))}),define("modules/clean/react/app_actions/feedback_modal",["require","exports","tslib","modules/clean/ajax","react","modules/clean/react/css","modules/clean/react/image","spectrum/button","modules/core/i18n","modules/clean/react/modal","spectrum/input","modules/clean/static_urls","modules/clean/filepath","modules/clean/file_store/utils","spectrum/dropdown_menu","dropins_sdk_refactor/dropins_sdk_internal","modules/constants/dropins"],function(e,t,n,a,i,s,r,o,c,u,l,d,p,f,_,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),i=n.__importDefault(i),t.bugReport=c._("Report a problem"),t.suggestSomething=c._("Suggest something");var g="extensions-feedback",E=[t.bugReport,t.suggestSomething],y=(function(e){function s(n){var s=e.call(this,n)||this;return s.submitFeedback=function(){var e=s.state.detailsText;if(s.state.screenshotLinks){e+=" (Screenshot links: "+s.state.screenshotLinks.join("; ")+")"}if(s.state.category===t.bugReport){var n="[Extensions]"+s.state.subjectText;a.SilentBackgroundRequest({url:"/support_ajax/support_form",data:{user_email:s.props.user.email,subject_posted:n,details_posted:e}})}else a.SilentBackgroundRequest({url:"/aa/app_choice_feedback",subject_user:s.props.user.id,data:{ext:s.getFileExt(),other_suggested_apps:s.state.subjectText,comments:e,surface:s.props.surface||"unknown",menu_contents:s.props.visibleMenuItems?s.props.visibleMenuItems.join(", "):""}});s.setState({showThankYouModal:!0})},s.handleSubjectChanged=function(e){s.setState({subjectText:e.currentTarget.value.trim()})},s.handleDetailsChanged=function(e){s.setState({detailsText:e.currentTarget.value.trim()})},s.handleChooseFromDropbox=function(){m.Dropbox.choose({linkType:"preview",multiselect:!0,success:function(e){var t=e.map(function(e){return e.link}),n=e.map(function(e){return e.name});s.setState({screenshotLinks:t,attachmentNames:n})},extensions:["images","video"]})},s.isAnyFeedbackInput=function(){return s.state.subjectText.length>0||s.state.detailsText.length>0},s.handleCategoryChange=function(e){s.setState({category:e})},s.renderFeedbackModel=function(){return i.default.createElement(u.Modal,{className:g+"-modal",ariaLabel:"Feedback Modal",acceptButtonText:null,style:"clean",autoFocusPrimaryInput:!1,width:"560"},i.default.createElement("div",{className:g+"-inputs"},i.default.createElement("div",{className:g+"-title"},i.default.createElement("h1",{className:g+"-modal-header"},c._("Send feedback"))),i.default.createElement("div",{className:g+"-container"},i.default.createElement(_.DropdownMenu,{id:"select--category",className:g+"-category-selector",onSelection:s.handleCategoryChange},i.default.createElement(_.DropdownMenuButton,{fullWidth:!0,className:"menu-button"},s.state.category),i.default.createElement(_.Menu,null,s.renderCategoryItems())),i.default.createElement("label",{htmlFor:g+"-subject-input",className:g+"-label"},c._("Subject")),i.default.createElement(l.Input,{id:"subject-input",className:g+"-subject-input",onChange:s.handleSubjectChanged,"aria-label":c._("subject input")}),i.default.createElement("label",{htmlFor:g+"-details-input",className:g+"-label"},c._("Details")),i.default.createElement("textarea",{id:"details-input",className:g+"-details-input",onChange:s.handleDetailsChanged,"aria-label":c._("details input"),rows:4}),i.default.createElement(o.Button,{variant:"secondary",className:g+"-screenshot-button",onClick:s.handleChooseFromDropbox},c._("Add a screenshot")),s.renderSelectedScreenshot())),i.default.createElement("div",{className:g+"-action-bar"},i.default.createElement(o.Button,{variant:"secondary",className:"action-bar-cancel-button",onClick:s.props.onBack},c._("Cancel")),i.default.createElement("div",{className:g+"-action-bar-space"}),i.default.createElement(o.Button,{variant:"primary",className:"action-bar-submit-button",disabled:!s.isAnyFeedbackInput(),onClick:s.submitFeedback},c._("Submit"))))},s.renderThankYouModal=function(){return i.default.createElement(u.Modal,{className:g+"-thank-you-modal",ariaLabel:"Feedback Modal",acceptButtonText:null,style:"clean"},i.default.createElement(r.Image,{className:g+"-thank-you-image",alt:c._("Thank you"),src:d.static_url("/static/images/app_actions/feedback_comments-vfluWMAvS.png"),srcHiRes:d.static_url("/static/images/app_actions/feedback_comments@2x-vflWa-9nT.png")}),i.default.createElement("h1",{className:g+"-thank-you-header"},c._("Thanks for letting us know!")),i.default.createElement("h2",{className:g+"-thank-you-subtext"},c._("Your feedback will help make Dropbox even better.")))},s.state={category:t.bugReport,subjectText:"",detailsText:"",screenshotLinks:[],attachmentNames:[],showThankYouModal:!1},m.Dropbox.init({appKey:h.CHOOSER_APP_KEY}),s}return n.__extends(s,e),s.prototype.getFileExt=function(){var e=this.props.file;return void 0===e?null:f.isSharedFile(e)&&e.filename?p.file_extension(e.filename):f.isBrowseFile(e)&&e.ext?e.ext:""},s.prototype.renderCategoryItems=function(){var e=this;return E.map(function(t){return i.default.createElement(_.MenuItem,{value:t,key:t,selected:e.state.category===t},t)})},s.prototype.renderSelectedScreenshot=function(){return this.state.attachmentNames.map(function(e){return i.default.createElement("p",null,e)})},s.prototype.render=function(){return this.state.showThankYouModal?this.renderThankYouModal():this.renderFeedbackModel()},s})(i.default.Component);t.FeedbackModal=s.requireCssWithComponent(y,["/static/css/app_actions/index-vflYCoeAH.css"])}),define("modules/clean/react/extensions/client",["require","exports","tslib","modules/clean/filepath","modules/clean/api_v2/user_client"],function(e,t,n,a,i){"use strict";function s(e){return void 0!==e.ext}function r(e){return void 0!==e.fq_path}function o(e){return void 0!==e.filename}function c(e){return s(e)?e.ext:r(e)?"."+a.file_extension(a.filename(e.fq_path)):o(e)?"."+a.file_extension(e.filename):void 0}function u(e){return"app_id"in e}function l(){return d("",[],!1,{},{})}function d(e,t,n,a,i){return void 0===a&&(a={}),void 0===i&&(i={}),{fileId:e,actionCategories:t,showMenu:n,bylines:a,featureFlags:i}}function p(){return _||(_=new f(new i.UserApiV2Client)),_}Object.defineProperty(t,"__esModule",{value:!0}),t.isExtensionIdAppId=u,t.emptyExtensionsConfig=l,t.newExtensionsConfig=d;var f=(function(){function e(e){this.actionIdToAppAction={},this.appActionAppIcons={},this.featureFlags={},this.bylines={},this.client=e}return e.prototype.getActionsForFile=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var a;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.getActionsForFileBatch([e],t)];case 1:return a=n.sent(),[2,a[e.file_id]||l()]}})})},e.prototype.getActionsForFileBatch=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this.loadActionsByUser(e,t)]})})},e.prototype.getAppIcons=function(){return n.__assign({},this.appActionAppIcons)},e.prototype.refreshAppIcons=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,a,i,s,r=this;return n.__generator(this,function(n){switch(n.label){case 0:t=void 0,a=this.iconRequest,n.label=1;case 1:return n.trys.push([1,6,,7]),a?[4,a]:[3,3];case 2:return t=n.sent(),[3,5];case 3:return i=Object.keys(this.appActionAppIcons),a=this.client.ns("app_actions").rpc("get_app_icons",{app_ids:i},{subjectUserId:e}),this.iconRequest=a,[4,a];case 4:t=n.sent(),n.label=5;case 5:return[3,7];case 6:return s=n.sent(),[3,7];case 7:return this.iconRequest=void 0,t&&t.icons.forEach(function(e){r.appActionAppIcons[e.app_id]=e.icon}),[2]}})})},e.prototype.loadActionsByUser=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var a,i,s,r,o=this;return n.__generator(this,function(n){switch(n.label){case 0:this.stateRequest||(this.stateRequest=this.loadActions(t)),a=this.stateRequest,i={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.stateRequest];case 2:return s=n.sent(),e.forEach(function(e){var t=void 0,n=c(e);n&&(t=s.extToCategories[n]),i[e.file_id]=d(e.file_id,t||[],s.appActionsEnabled&&!e.is_dir,o.bylines,o.featureFlags)}),[3,4];case 3:return r=n.sent(),a===this.stateRequest&&(this.stateRequest=void 0),[3,4];case 4:return[2,i]}})})},e.prototype.loadActions=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,a,i,s,r=this;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this.client.ns("app_actions").rpc("get_actions_for_user",{},{subjectUserId:e}),[4,Promise.all([t,this.loadFeatureFlags(e)])];case 1:return a=n.sent()[0],a.actions.forEach(function(e){r.actionIdToAppAction[e.id]||(r.actionIdToAppAction[e.id]=e,r.appActionAppIcons[e.app_id]=e.icon)}),i={},a.action_mapping.forEach(function(e){var t=e.matcher;if("extension"===t[".tag"]){var n=t.extension,a={},s=[];e.action_ids.forEach(function(e){var t=r.actionIdToAppAction[e],n=a[t.category];n?n.actions.push(t):(n={categoryId:t.category,actions:[t]},a[t.category]=n,s.push(n))}),s=s.map(function(e){return{categoryId:e.categoryId,actions:r.prioritizeActions(e.actions)}}),i[n]=s}}),a.bylines.forEach(function(e){var t=e.extension_id[".tag"];u(e.extension_id)&&(t=e.extension_id.app_id),r.bylines[t]=e.byline}),[2,{appActionsEnabled:!0,extToCategories:i}];case 2:if(s=n.sent(),s.error&&"feature_gated"===s.error[".tag"])return[2,{appActionsEnabled:!1,extToCategories:{}}];throw s;case 3:return[2]}})})},e.prototype.getFeatureFlags=function(){return this.featureFlags},e.prototype.loadFeatureFlags=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})},e.prototype.prioritizeActions=function(e){return e.sort(function(e,t){return e.priority&&t.priority?t.priority-e.priority:e.priority?-1:t.priority?1:e.description<t.description?-1:e.description>t.description?1:0})},e})();t.Client=f;var _;t.getExtensionsClient=p});
//# sourceMappingURL=pkg-extensions.min.js-vfljX60lm.map